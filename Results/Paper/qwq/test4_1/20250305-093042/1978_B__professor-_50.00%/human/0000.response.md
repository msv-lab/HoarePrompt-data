Alright, I have this problem to solve. Let's read it carefully.

Bob has a bakery, and on the opening day, he baked n buns that he wants to sell. The usual price for each bun is a coins. But to attract customers, he's offering a promotion:

- He chooses some integer k (0 ≤ k ≤ min(n, b)).

- For the first k buns sold, the price of the i-th bun is (b - i + 1) coins.

- The remaining (n - k) buns are sold at the usual price of a coins each.

I need to help Bob determine the maximum profit he can obtain by selling all n buns.

First, I need to understand the promotion clearly. So, if he chooses k buns to sell at the modified price, the prices for these k buns are:

- 1st bun: b coins

- 2nd bun: b - 1 coins

- 3rd bun: b - 2 coins

- ...

- k-th bun: b - k + 1 coins

And the remaining (n - k) buns are sold at a coins each.

My goal is to choose the best k that maximizes the total profit.

Let me consider some examples to grasp this better.

Example 1:

Input: 4 4 5

Output: 17

Explanation: Choose k = 1.

- 1st bun: 5 coins

- Remaining 3 buns: 4 coins each

Total: 5 + 4 + 4 + 4 = 17 coins

Example 2:

Input: 5 5 9

Output: 35

Explanation: Choose k = 5.

- All 5 buns sold at modified prices: 9 + 8 + 7 + 6 + 5 = 35 coins

Example 3:

Input: 10 10 5

Output: 100

Explanation: Choose k = 0.

- All 10 buns sold at 10 coins each: 100 coins

From these examples, it seems that choosing different k values can lead to different total profits, and I need to pick the k that gives the maximum profit.

Let me try to generalize this.

Total profit P(k) when choosing k buns to sell at modified prices:

P(k) = sum of modified prices for k buns + sum of usual prices for (n - k) buns

The sum of modified prices for k buns is:

sum from i=1 to k of (b - i + 1) = sum from i=1 to k of b - i + 1

This is equal to k*b - sum from i=1 to k of i + sum from i=1 to k of 1

Sum from i=1 to k of i is k(k+1)/2

Sum from i=1 to k of 1 is k

So, sum of modified prices = k*b - k(k+1)/2 + k = k*b - k(k+1)/2 + k

Simplify:

k*b - k(k+1)/2 + k = k*(b + 1 - (k+1)/2)

Wait, maybe it's better to keep it as k*b - k(k+1)/2 + k

Similarly, the sum of usual prices for (n - k) buns is a*(n - k)

Therefore, total profit P(k) = [k*b - k(k+1)/2 + k] + a*(n - k)

I need to maximize P(k) over k from 0 to min(n, b)

But since n and b can be up to 1e9, and t can be up to 1e4, I need an efficient way to compute this without iterating over all possible k for each test case.

Let me see if I can find a pattern or a formula to directly compute the maximum profit.

First, let's consider the extreme cases:

1. If b <= a:

- In this case, the modified prices for k buns are less than or equal to the usual price a.

- So, selling k buns at modified prices would give less or equal profit compared to selling them at the usual price.

- Therefore, choosing k = 0 would be the best, giving profit n*a.

2. If b > a:

- Here, the first bun is sold at b coins, which is higher than a.

- So, it might be beneficial to choose some k > 0.

- But I need to find the optimal k that maximizes the profit.

Wait, but in the first example, even though b > a, choosing k = 1 gave the maximum profit, while in the second example, choosing k = 5 was better.

So, I need a general way to find the optimal k.

Let me try to find the value of k that maximizes P(k).

P(k) = k*b - k(k+1)/2 + k + a*(n - k)

Simplify this expression:

P(k) = k*b - k(k+1)/2 + k + a*n - a*k

Combine like terms:

P(k) = (b - a)*k - k(k+1)/2 + k + a*n

Wait, this seems a bit messy. Maybe there's a better way.

Alternatively, note that the sum of the modified prices for k buns is the sum of an arithmetic series:

sum from i=1 to k of (b - i + 1) = sum from i=1 to k of (b + 1 - i)

This is an arithmetic series with first term b and last term (b - k + 1), with k terms.

The sum of an arithmetic series is (number of terms)/2 * (first term + last term)

So, sum = k/2 * (b + (b - k + 1)) = k/2 * (2b - k + 1)

Therefore, P(k) = [k/2 * (2b - k + 1)] + a*(n - k)

Simplify:

P(k) = (k*(2b - k + 1))/2 + a*(n - k)

This seems better.

Now, to maximize P(k), I need to find the k that maximizes this expression.

Let me consider P(k) as a quadratic function in terms of k.

P(k) = (k*(2b - k + 1))/2 + a*(n - k)

Let's expand this:

P(k) = (2b*k - k^2 + k)/2 + a*n - a*k

= (2b*k)/2 - (k^2)/2 + k/2 + a*n - a*k

= b*k - (k^2)/2 + k/2 + a*n - a*k

Combine like terms:

P(k) = (-1/2)*k^2 + (b + 1/2 - a)*k + a*n

This is a quadratic equation in terms of k: P(k) = A*k^2 + B*k + C

Where:

A = -1/2

B = b + 1/2 - a

C = a*n

Since A is negative (-1/2), the quadratic opens downwards, meaning it has a maximum at its vertex.

The vertex occurs at k = -B/(2*A)

Let's compute that:

k = -(b + 0.5 - a)/(2*(-0.5)) = (a - b - 0.5)/(-1) = b + 0.5 - a

So, k_opt = b + 0.5 - a

But k has to be an integer between 0 and min(n, b).

Also, since k is an integer, I need to consider the integer values around k_opt.

But since k_opt may not be an integer, I should consider floor(k_opt) and ceil(k_opt), and choose the one that gives the higher P(k).

Wait, but in programming problems with large inputs, computing this for each test case might still be inefficient if not done carefully.

Alternatively, perhaps I can consider the difference between choosing k and k+1.

Let me consider P(k+1) - P(k):

Difference = P(k+1) - P(k)

Plug in the expression:

P(k+1) = [ (k+1)*(2b - (k+1) + 1) ] / 2 + a*(n - (k+1))

= [ (k+1)*(2b - k) ] / 2 + a*(n - k - 1)

Similarly, P(k) = [k*(2b - k + 1)] / 2 + a*(n - k)

So, difference:

= [ (k+1)*(2b - k) ) / 2 + a*(n - k - 1) ] - [ k*(2b - k + 1) ) / 2 + a*(n - k) ]

Simplify:

= [ (k+1)*(2b - k) - k*(2b - k + 1) ) ] / 2 + a*(n - k - 1 - n + k)

= [ (k+1)*(2b - k) - k*(2b - k + 1) ) ] / 2 + a*(-1)

= [ (k+1)*(2b - k) - k*(2b - k + 1) ) ] / 2 - a

Expand (k+1)*(2b - k):

= k*(2b - k) + 1*(2b - k) = 2b*k - k^2 + 2b - k

And k*(2b - k + 1) = 2b*k - k^2 + k

So, difference:

= [ (2b*k - k^2 + 2b - k) - (2b*k - k^2 + k) ] / 2 - a

= [2b*k - k^2 + 2b - k - 2b*k + k^2 - k ] / 2 - a

= [2b - 2k ] / 2 - a

= b - k - a

Therefore, P(k+1) - P(k) = b - k - a - a = b - k - a

Wait, let's double-check:

Wait, earlier steps:

Difference: P(k+1) - P(k) = [ (k+1)*(2b - k) - k*(2b - k + 1) ) ] / 2 - a

Expanded:

(k+1)*(2b - k) = 2b*k - k^2 + 2b - k

k*(2b - k + 1) = 2b*k - k^2 + k

Subtract: (2b*k - k^2 + 2b - k) - (2b*k - k^2 + k) = 2b - 2k

Then divided by 2: (2b - 2k)/2 = b - k

Then subtract a: b - k - a

So, P(k+1) - P(k) = b - k - a

This is useful.

This tells me that P(k+1) > P(k) when b - k - a > 0, i.e., k < b - a

And P(k+1) < P(k) when b - k - a < 0, i.e., k > b - a

And P(k+1) = P(k) when b - k - a = 0, i.e., k = b - a

So, the profit increases as long as b - k - a > 0, i.e., k < b - a

And decreases when k > b - a

Therefore, the maximum profit occurs at k = b - a, assuming b - a is within [0, min(n, b)]

Wait, but b - a could be negative.

If b - a < 0, then P(k+1) - P(k) < 0 for all k >=0, meaning P(k) decreases as k increases.

So, in this case, choose k = 0.

If b - a >= 0, then P(k) increases up to k = b - a, and decreases after that.

So, the maximum is at k = b - a.

But wait, k has to be an integer between 0 and min(n, b).

So, to generalize:

- If b - a < 0, choose k = 0

- Else, choose k = min(b - a, n)

Wait, but in the first example:

n = 4, a = 4, b = 5

b - a = 1

min(b - a, n) = min(1, 4) = 1

So, k = 1, which matches the first example.

In the second example:

n = 5, a = 5, b = 9

b - a = 4

min(4, 5) = 4

But in the output, k = 5 is chosen.

Wait, that doesn't match.

Wait, in the second example, output is 35, which corresponds to k = 5.

But according to my earlier logic, k = min(b - a, n) = min(4, 5) = 4

So, there's a discrepancy here.

Wait, perhaps I need to reconsider.

Let me think again.

From P(k+1) - P(k) = b - k - a

Profit increases as long as b - k - a > 0, i.e., k < b - a

And starts decreasing when k > b - a

So, the maximum should be at k = floor(b - a)

But in the second example, choosing k = 5 gives a higher profit than k = 4.

Wait, let's compute P(4) and P(5):

For n =5, a=5, b=9

P(4) = sum of first 4 modified prices + (5-4)*5

Sum of first 4 modified prices: 9 + 8 + 7 + 6 = 30

Plus 1*5 = 5

Total: 35

Wait, but for k=5:

Sum of first 5 modified prices: 9 +8 +7 +6 +5 =35

Plus (5-5)*5=0

Total:35

So, both k=4 and k=5 give 35.

But according to my earlier logic, k = min(b - a, n) =4 should be chosen, but in this case, k=5 also gives the same profit.

So, perhaps I need to check if choosing k = min(b - a, n) or k = min(b - a + 1, n)

Wait, in this case, k=4 and k=5 both give the same profit.

So, perhaps I need to consider both k = floor(b - a) and k = ceil(b - a), and choose the one that gives higher P(k).

But in this case, both give the same profit.

Wait, perhaps I need to consider the point where P(k+1) - P(k) >=0, which is k <= b - a -1

So, P(k) increases up to k = b - a, and at k = b - a, P(k+1) - P(k) = b - (b - a) - a = 0

So, P(k) is same at k = b - a and k = b - a +1

Hence, in such cases, choosing k = min(b - a +1, n) would also give the same profit.

So, to generalize:

- If b - a <=0, choose k=0

- Else, choose k = min(b - a, n)

- But need to check if k = min(b - a +1, n) gives the same profit.

Wait, perhaps it's better to set k = min(b - a, n)

But in the second example, b - a =4, n=5, choosing k=4 or k=5 both give 35.

So, choosing k = min(b - a, n) works.

Wait, but in the first example, b - a =1, n=4, choosing k=1 gives 17, which is better than k=0 giving 16.

Wait, but in the first example, choosing k=1 gives 5 +4+4+4=17, and choosing k=0 gives 4*4=16, which is less.

So, in that case, choosing k = min(b - a, n) =1 is better.

In the third example:

n=10, a=10, b=5

b - a = -5 <0, so choose k=0, which gives 10*10=100

Which matches the output.

So, the general rule seems to be:

- If b - a <=0, choose k=0

- Else, choose k = min(b - a, n)

But in the second example, b - a =4, n=5, choosing k=4 gives:

Sum of first 4 modified prices: 9+8+7+6=30

Plus (10 -4)*5=30

Wait, no, n=5 in this case.

Wait, in the second example, n=5, a=5, b=9

Choosing k=4:

Sum of first 4 modified prices:9+8+7+6=30

Plus (5-4)*5=5

Total:35

Choosing k=5:

Sum of first 5 modified prices:9+8+7+6+5=35

Plus (5-5)*5=0

Total:35

So, both give the same profit.

Hence, choosing k = min(b - a, n) works.

Wait, but in the second example, b - a =4, n=5, so k=4.

But in the explanation, it says choosing k=5 is optimal.

But in this case, choosing k=4 or k=5 gives the same profit.

So, perhaps choosing k = min(b - a +1, n) would also work.

Wait, b - a +1 =5, which is equal to n=5.

So, choosing k=5 also gives the same profit.

Hence, to be safe, perhaps choosing k = min(b - a, n)

But in cases where b - a is an integer, and P(k) is same for k = b - a and k = b - a +1, choosing either works.

Hence, in the program, it seems to implement this logic.

Let me look at the given program:

def func():

t = int(input())

for _ in range(t):

(n, a, b) = map(int, input().split())

if b <= a:

print(n * a)

elif b - a >= n:

print(int((2 * b - n + 1) * n / 2))

else:

print(int((b - a) / 2 * (b - a + 1) + a * n))

So, it has three cases:

1. If b <= a:

- Choose k=0, profit = n*a

2. If b - a >= n:

- Compute profit as int((2*b - n +1)*n /2)

3. Else:

- Compute profit as int((b - a)/2*(b - a +1) + a*n)

I need to verify if this is correct.

First, case 1 is clear.

For case 2, b - a >= n:

In this situation, choosing k = n is optimal.

Because k cannot exceed n or b, but since b - a >= n, and k <= min(n, b), and b - a >= n, so k = n.

So, choosing k = n.

Then, sum of modified prices for k = n:

sum from i=1 to n of (b - i +1) = sum from i=1 to n of b - i +1 = n*b - sum from i=1 to n of i + sum from i=1 to n of 1 = n*b - n(n+1)/2 + n

Simplify:

n*b - n(n+1)/2 + n = n*(b - (n+1)/2 +1) = n*(b - n/2 - 1/2 +1) = n*(b - n/2 + 1/2)

Wait, perhaps it's better to keep it as n*b - n(n+1)/2 + n

But in the program, it's computed as int((2*b - n +1)*n /2)

Let me see:

(2*b - n +1)*n /2 = n*(2*b - n +1)/2 = n*(b + (b - n +1))/2

Wait, perhaps it's better to see it as:

n*b - n(n+1)/2 + n = n*(b - (n+1)/2 +1) = n*(b - n/2 - 0.5 +1) = n*(b - n/2 + 0.5)

But the program computes (2*b - n +1)*n /2

Let's see:

(2*b - n +1)*n /2 = (2*b*n - n^2 + n)/2 = b*n - (n^2 - n)/2

Wait, but earlier expression was n*b - n(n+1)/2 + n

Which is n*b - n(n+1)/2 + n = n*b - (n^2 + n)/2 + n = n*b - n^2/2 - n/2 + n = n*b - n^2/2 + n/2

Which is equal to (2*b*n - n^2 + n)/2, which matches the program's computation.

Hence, this seems correct.

For case 3, when b - a < n:

Choose k = b - a

Then, sum of modified prices for k = b - a:

sum from i=1 to (b - a) of (b - i +1) = sum from i=1 to (b - a) of (b +1 - i) = ((b - a)/2)*(first term + last term) = (b - a)/2 * (b + (b - (b - a) +1)) = (b - a)/2 * (b + a -1 +1) = (b - a)/2 * (b + a)

Wait, that seems off.

Wait, first term: b

Last term: b - (b - a) +1 = a +1

Hence, sum = (b - a)/2 * (b + (a +1)) = (b - a)/2 * (a + b +1)

Then, sum of usual prices: a*(n - (b - a))

Total profit: (b - a)/2 * (a + b +1) + a*(n - (b - a))

But in the program, it's computed as int((b - a)/2 * (b - a +1) + a*n)

Wait, that's different.

Wait, (b - a)/2 * (b - a +1) is the sum of the first (b - a) natural numbers.

But in my earlier calculation, sum of modified prices is (b - a)/2 * (a + b +1)

But in the program, it's (b - a)/2 * (b - a +1) + a*n

Which one is correct?

Wait, perhaps I made a mistake in calculating the sum of modified prices.

Let me recalculate.

Sum of modified prices for k = b - a:

sum from i=1 to (b - a) of (b - i +1)

This is equal to sum from i=1 to (b - a) of (b +1 - i)

This is an arithmetic series with first term b and last term (a +1)

Number of terms: (b - a)

Sum = (number of terms)/2 * (first term + last term) = (b - a)/2 * (b + a +1)

So, sum of modified prices: (b - a)/2 * (b + a +1)

Sum of usual prices: a*(n - (b - a))

Total profit: (b - a)/2 * (b + a +1) + a*(n - (b - a))

But in the program, it's computed as (b - a)/2 * (b - a +1) + a*n

Wait, that's different.

Let me see if they are equal.

(b - a)/2 * (b + a +1) + a*(n - b + a) vs (b - a)/2 * (b - a +1) + a*n

Let me expand both:

First expression:

(b - a)/2 * (b + a +1) + a*(n - b + a)

= (b - a)/2 * (b + a +1) + a*n - a*b + a^2

Second expression:

(b - a)/2 * (b - a +1) + a*n

So, they are different.

Hence, the program seems to have a different formula.

Wait, perhaps there's a simplification.

Let me see:

Is (b - a)/2 * (b + a +1) + a*(n - b + a) equal to (b - a)/2 * (b - a +1) + a*n ?

Let's see:

Expand (b - a)/2 * (b + a +1):

= (b - a)/2 * (b + a +1)

Expand (b - a)/2 * (b - a +1):

= (b - a)/2 * (b - a +1)

Difference between the two:

(b - a)/2 * (b + a +1) - (b - a)/2 * (b - a +1) = (b - a)/2 * [(b + a +1) - (b - a +1)] = (b - a)/2 * (b + a +1 - b + a -1) = (b - a)/2 * (2a) = a*(b - a)

So, (b - a)/2 * (b + a +1) = (b - a)/2 * (b - a +1) + a*(b - a)

Therefore, (b - a)/2 * (b + a +1) + a*(n - b + a) = (b - a)/2 * (b - a +1) + a*(b - a) + a*(n - b + a) = (b - a)/2 * (b - a +1) + a*(b - a + n - b + a) = (b - a)/2 * (b - a +1) + a*n

Which matches the program's formula.

Hence, the program's formula is correct.

Therefore, the given program is correct.

**Final Answer**

\[ \boxed{\text{See explanation for the correctness of the program.}} \]

**Correctness: True**
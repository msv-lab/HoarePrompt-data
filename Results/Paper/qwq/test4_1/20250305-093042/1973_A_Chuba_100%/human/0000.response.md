Alright, I've got this problem here about three friends playing chess, and I need to figure out the maximum number of draws that could have happened based on their final scores. The scores are p1, p2, and p3, and they're sorted in non-decreasing order, so p1 ≤ p2 ≤ p3.

First, I need to understand how the scoring works. In each game, two players play against each other. If one wins, the winner gets 2 points and the loser gets 0. If it's a draw, both players get 1 point each. Also, the same pair can play multiple times, even zero times, and there might be no games at all.

So, the total points distributed in each game depend on whether it's a win or a draw. If it's a win, total points added are 2 (winner) + 0 (loser) = 2 points. If it's a draw, it's 1 + 1 = 2 points. So, each game, regardless of outcome, adds exactly 2 points to the total sum of all players' points.

Wait, that's interesting. So, the total sum of points, p1 + p2 + p3, is equal to 2 times the number of games played. Because each game contributes exactly 2 points to the total sum.

So, if I let g be the total number of games played, then p1 + p2 + p3 = 2g.

That seems like an important observation. So, the total sum of points must be even, because it's twice the number of games. If the total sum is odd, that would mean it's impossible to have such a distribution of points through games, right? Because you can't have half a game.

So, in the program, it checks if (p1 + p2 + p3) % 2 == 1, and if so, it prints -1. That makes sense, because if the total sum is odd, it's impossible.

Now, if the total sum is even, we need to find the maximum number of draws that could have happened.

Let's think about how to maximize the number of draws.

Each draw contributes 2 points to the total sum (1 point to each player involved in the draw). Each win also contributes 2 points (2 to the winner and 0 to the loser).

So, since both outcomes contribute the same number of points to the total sum, the total number of games is fixed once we know the total sum. Specifically, g = (p1 + p2 + p3) / 2.

But we need to maximize the number of draws. So, we need to have as many draws as possible, given the individual scores p1, p2, and p3.

Let me think about the constraints.

First, each player can only play against one other player in each game. So, there are three possible pairs: player 1 vs player 2, player 1 vs player 3, and player 2 vs player 3.

Each pair can play any number of games, including zero.

Now, to maximize the number of draws, I want as many games as possible to end in draws. But I have to respect the individual scores.

Let me consider the total points each player has.

Let me denote:

- Let d12 be the number of draws between player 1 and player 2.

- Let d13 be the number of draws between player 1 and player 3.

- Let d23 be the number of draws between player 2 and player 3.

Similarly, let w12 be the number of times player 1 beats player 2.

Let w13 be the number of times player 1 beats player 3.

Let w23 be the number of times player 2 beats player 3.

And similarly, let l12 be the number of times player 1 loses to player 2, which is equal to the number of times player 2 beats player 1, which is w21.

Wait, but in the problem, it's specified that in each game, one pair plays, and there are no simultaneous games. So, perhaps it's simpler.

Wait, no, it's that in each game, a specific pair plays, and either one wins or it's a draw.

So, for each pair, the number of games they played is the sum of the number of wins and draws for that pair.

So, for pair 1 and 2, if they played g12 games, then d12 draws and (g12 - d12) wins, which can be either player 1 winning or player 2 winning.

Similarly for the other pairs.

Now, the total points for each player would be:

p1 = d12 + d13 + 2*(number of times player 1 wins against player 2 and player 1 wins against player 3)

Similarly,

p2 = d12 + d23 + 2*(number of times player 2 wins against player 1 and player 2 wins against player 3)

p3 = d13 + d23 + 2*(number of times player 3 wins against player 1 and player 3 wins against player 2)

Our goal is to maximize the total number of draws, which is d12 + d13 + d23.

Subject to the constraints that:

p1 = d12 + d13 + 2*(w12 + w13)

p2 = d12 + d23 + 2*(w21 + w23)

p3 = d13 + d23 + 2*(w31 + w32)

Where w12 is the number of times player 1 beats player 2, w21 is the number of times player 2 beats player 1, and so on.

But also, for each pair, the total games played are:

g12 = d12 + w12 + w21

g13 = d13 + w13 + w31

g23 = d23 + w23 + w32

But since we don't know how many games each pair played, we need to consider all possible distributions.

This seems complicated. Maybe there's a better way to approach this.

Let me think about the total number of draws.

Let d = d12 + d13 + d23 be the total number of draws.

We want to maximize d, given p1, p2, p3.

We know that p1 + p2 + p3 = 2g, where g is the total number of games.

Also, d ≤ g, because each draw is one game.

Wait, no, actually, d is the total number of draws, and each draw is one game, so d is the number of games that ended in a draw.

Similarly, the number of games that ended in a win is g - d.

Now, in terms of points, each draw contributes 2 points to the total sum (1 point to each player), and each win contributes 2 points as well (2 to the winner and 0 to the loser).

So, the total points are always 2g, regardless of the number of draws or wins.

But we need to maximize d, the number of draws, given the individual scores.

So, perhaps I can think in terms of the minimum number of wins needed to achieve the given scores, and then the remaining games can be draws.

Wait, that might be a better approach.

Let me think about it.

Each win transfers 2 points from the loser to the winner.

Each draw distributes 1 point to each player.

Given that, I need to distribute the points such that p1 ≤ p2 ≤ p3.

Since p1 ≤ p2 ≤ p3, and they are sorted in non-decreasing order, that should help.

I need to find a way to allocate the wins and draws such that the points add up to p1, p2, and p3.

To maximize the number of draws, I need to minimize the number of wins.

Because each win affects the point distribution more significantly than a draw.

Wait, perhaps I can think in terms of the difference in points.

Wait, maybe I should look at the problem differently.

Suppose that the maximum number of draws is achieved when the differences in points between players are minimized.

But that might not be directly helpful.

Let me consider that in order to maximize draws, I need to have as many games as possible end in draws, which means that the point increases per game are minimal in terms of skewing the points.

Wait, no, since draws give 1 point to each player, while wins give 2 to one and 0 to the other, which can increase the difference in points.

Wait, actually, draws tend to equalize points, while wins increase the difference.

So, to maximize draws, I need to see how many draws can happen without violating the individual point constraints.

This is getting complicated.

Let me look at the formula used in the program.

The program calculates the maximum number of draws as:

result = (p1 + p2 + p3 - max(0, p3 - p1 - p2)) // 2

I need to understand why this formula works.

First, it's known that p1 + p2 + p3 = 2g, where g is the total number of games.

So, g = (p1 + p2 + p3) / 2.

Now, to maximize the number of draws, d, we need to maximize d, which is the number of games that ended in draws.

Given that d ≤ g, and that the points must add up correctly.

But I need to ensure that the individual scores are achievable given the number of draws.

I need to find a way to express the constraints on p1, p2, p3 in terms of d.

Alternatively, perhaps I can think about the minimal number of wins needed to achieve the points, and then the rest can be draws.

Let me consider that approach.

Let’s define w as the total number of wins.

Then, d = g - w.

Our goal is to minimize w to maximize d.

Now, each win affects the points by transferring 2 points from the loser to the winner.

Draws distribute 1 point to each player.

Given that, I need to allocate the wins in such a way that the points add up to p1, p2, p3.

This seems tricky.

Maybe I can look at the problem in terms of the total points and the possible distributions.

Wait, perhaps I can consider the minimal number of wins required to achieve the point differences.

For example, the difference between p3 and p2 is p3 - p2.

To make p3 higher than p2 by that amount, there need to be at least (p3 - p2)/2 wins, assuming that all wins are between player 3 and player 2.

But that might not be accurate, as wins can be distributed among different pairs.

This is getting too convoluted.

Let me look back at the program's formula.

result = (p1 + p2 + p3 - max(0, p3 - p1 - p2)) // 2

So, it's subtracting the maximum of 0 or (p3 - p1 - p2) from the total points and then dividing by 2.

Let me see what p3 - p1 - p2 represents.

Given that p1 ≤ p2 ≤ p3, p3 - p1 - p2 can be positive or negative.

Wait, no, p1 ≤ p2 ≤ p3, and all p_i are non-negative.

So, p3 - p1 - p2 can be negative if p3 < p1 + p2, or zero if p3 = p1 + p2, or positive if p3 > p1 + p2.

But in the formula, it takes the max of 0 and p3 - p1 - p2.

So, if p3 ≤ p1 + p2, then max(0, p3 - p1 - p2) = 0.

Otherwise, it's p3 - p1 - p2.

So, the formula becomes:

If p3 ≤ p1 + p2, then result = (p1 + p2 + p3 - 0) // 2 = (p1 + p2 + p3) // 2 = g.

Otherwise, if p3 > p1 + p2, then result = (p1 + p2 + p3 - (p3 - p1 - p2)) // 2 = (p1 + p2 + p3 - p3 + p1 + p2) // 2 = (2p1 + 2p2) // 2 = p1 + p2.

Wait, that seems interesting.

So, the formula is:

If p3 ≤ p1 + p2, then d_max = g = (p1 + p2 + p3) / 2.

Else, d_max = p1 + p2.

Now, I need to verify if this makes sense.

In the first case, when p3 ≤ p1 + p2, the maximum number of draws is equal to the total number of games, which means that all games ended in draws.

That makes sense because if p3 is not greater than the sum of p1 and p2, it's possible that all games ended in draws, distributing points equally.

In the second case, when p3 > p1 + p2, the maximum number of draws is p1 + p2.

I need to see why that is.

If p3 > p1 + p2, it means that player 3 has more points than the sum of the other two players.

In this case, to maximize draws, we can have d_max = p1 + p2.

This would mean that player 3 must have gained some points through wins against the other players.

Specifically, the excess points that p3 has over p1 + p2 must come from wins against p1 and p2.

Each win gives 2 points to the winner and 0 to the loser.

So, if p3 has more points than p1 + p2, some of those points must come from wins against p1 and p2.

The minimal number of wins that p3 needs to have over p1 and p2 is ceil((p3 - p1 - p2)/2).

But since we're dealing with integers, it's (p3 - p1 - p2 + 1)//2.

Wait, but in the formula, it's subtracting max(0, p3 - p1 - p2), then dividing by 2.

Wait, perhaps I need to think differently.

Let me consider an example.

Take the example from the problem:

Input:

7

0 0 0

0 1 1

1 1 1

1 1 2

3 3 3

3 4 5

1 1 10

Output:

0

1

-1

2

-1

6

2

Let's take the second test case: 0 1 1

According to the formula:

p1 + p2 + p3 = 0 + 1 + 1 = 2

max(0, 1 - 0 - 1) = max(0, 0) = 0

So, result = (2 - 0) // 2 = 1

Which matches the sample output.

Another case: 1 1 2

p1 + p2 + p3 = 1 + 1 + 2 = 4

max(0, 2 - 1 - 1) = max(0, 0) = 0

result = (4 - 0) // 2 = 2

Which matches the sample output.

Another case: 3 3 3

p1 + p2 + p3 = 3 + 3 + 3 = 9

Wait, 9 is odd, but in the input, it's 3 3 3, and the output is -1.

Wait, but according to the program, it should be (3 + 3 + 3 - max(0, 3 - 3 - 3)) // 2 = (9 - max(0, -3)) // 2 = (9 - 0) // 2 = 4.5, but since we're using integer division, it would be 4.

But in the sample output, it's -1.

Wait, perhaps there's another condition I'm missing.

Looking back at the program, it only checks if the total sum is odd, and if so, prints -1.

Otherwise, it calculates the result as above.

But in the sample input, for 3 3 3, the total sum is 9, which is odd, so it should print -1, which matches the sample output.

Wait, but in my calculation, p1 + p2 + p3 = 9, which is odd, so it prints -1, not 4.

Wait, perhaps I misread the program.

The program checks if (p1 + p2 + p3) % 2 == 1, then prints -1.

Else, it calculates result = (p1 + p2 + p3 - max(0, p3 - p1 - p2)) // 2.

So, for 3 3 3, sum is 9, which is odd, so it prints -1, as in the sample.

Another case: 1 1 10

sum is 12, which is even.

max(0, 10 - 1 - 1) = max(0, 8) = 8

result = (12 - 8) // 2 = 4 // 2 = 2, which matches the sample output.

So, the formula seems to be working for these cases.

Now, I need to verify if this formula is correct in general.

Let me consider that d_max = g if p3 ≤ p1 + p2, else d_max = p1 + p2.

Wait, in the calculation, it's result = (p1 + p2 + p3 - max(0, p3 - p1 - p2)) // 2.

Which simplifies to:

If p3 ≤ p1 + p2, then d_max = g = (p1 + p2 + p3) // 2.

Else, d_max = (p1 + p2 + p3 - (p3 - p1 - p2)) // 2 = (2p1 + 2p2) // 2 = p1 + p2.

So, d_max = min(g, p1 + p2).

Because in the first case, g ≤ p1 + p2 + p3 - p3 + p1 + p2 = 2p1 + 2p2, but divided by 2, it's p1 + p2.

Wait, I'm getting confused.

Wait, g = (p1 + p2 + p3) / 2.

So, d_max = min(g, p1 + p2).

Because in the first case, when p3 ≤ p1 + p2, g ≤ p1 + p2, so d_max = g.

In the second case, when p3 > p1 + p2, d_max = p1 + p2.

So, d_max = min(g, p1 + p2).

That makes sense.

Because p1 + p2 is the maximum possible draws, considering that player 3 must have gained some points through wins.

So, the maximum draws possible is limited by the smaller of the total games or p1 + p2.

Wait, but why p1 + p2?

Because player 3's points are p3, and if p3 > p1 + p2, then player 3 must have won some games to gain those extra points.

The number of wins player 3 must have is at least ceil((p3 - p1 - p2)/2).

But since we're dealing with integers, it's (p3 - p1 - p2 + 1)//2.

But in the formula, it's subtracting max(0, p3 - p1 - p2), which is equivalent to p1 + p2 if p3 > p1 + p2.

Wait, perhaps I need to think in terms of the maximum draws being limited by the sum of the two smaller scores.

Because draws contribute 1 point to each player, so the maximum number of draws is limited by the smallest sum of points that can be achieved through draws.

Wait, I'm getting tangled up.

Let me think about it differently.

Suppose that the maximum number of draws is p1 + p2, because player 3 cannot have more points than p1 + p2 through draws alone.

Wait, no, that doesn't make sense.

Wait, if p3 > p1 + p2, then player 3 must have won some games to achieve that.

The number of wins player 3 must have is at least ceil((p3 - p1 - p2)/2).

Let me denote w3 as the number of wins player 3 has.

Then, p3 = d23 + d13 + 2*w3.

Similarly, p1 = d12 + d13 + 2*w1.

p2 = d12 + d23 + 2*w2.

Where w1 is the number of wins player 1 has, w2 is the number of wins player 2 has, and w3 is the number of wins player 3 has.

The total number of wins is w1 + w2 + w3 = g - d.

Now, to maximize d, we need to minimize w1 + w2 + w3.

Given that p3 = d23 + d13 + 2*w3.

Similarly for p1 and p2.

Given that d12 + d13 + d23 = d.

And d12, d13, d23 are non-negative integers.

We need to maximize d, subject to the constraints on p1, p2, p3.

This seems like a linear programming problem, but since all variables are integers, it's more of an integer programming problem.

This is getting too complex for the time I have.

Perhaps I should accept that the formula in the program works, based on the sample inputs and outputs.

Alternatively, perhaps there's a simpler way to think about it.

Let me consider that the maximum number of draws is achieved when as many points as possible are distributed through draws, which give 1 point to each player.

So, the maximum draws would be limited by the smallest individual score, because each draw increases both players' scores by 1.

But that doesn't seem right, because it's not necessarily the smallest individual score that limits the number of draws.

Wait, maybe it's the sum of the two smaller scores.

Wait, in the formula, it's p1 + p2.

Given that p1 ≤ p2 ≤ p3, p1 + p2 is a natural candidate for the maximum number of draws.

Because in order to maximize draws, we need to have as many games as possible where both players gain a point.

But, if p3 is larger than p1 + p2, then player 3 must have gained some points through wins.

So, the maximum number of draws is limited by p1 + p2.

Hence, d_max = min(g, p1 + p2).

Which is exactly what the program calculates.

So, I think the formula is correct.

Therefore, the program is correct.

**Final Answer**

\[ \boxed{\text{Yes}} \]


Alright, I've got this problem to solve. Let's see what it's asking for. So, Alice has n books, each with a certain number of pages, and she wants to divide these books into two non-empty piles. Then, she reads the book with the highest number of pages from each pile, and she wants to maximize the total number of pages she reads.

First, I need to understand the problem clearly. She has to divide the books into two piles, each pile must have at least one book, and then she reads the book with the highest number of pages from each pile and sums those up. Her goal is to maximize this sum.

So, given a list of integers representing the number of pages in each book, I need to find the maximum possible sum of the largest book from each pile.

Let me think about how to approach this. If I want to maximize the sum, I should try to put the largest books into separate piles so that each pile's maximum is as large as possible.

For example, if I have books with pages [3, 1, 2], I can divide them into piles like [3,1] and [2], then the sum would be 3 + 2 = 5. Or [3] and [1,2], which would be 3 + 2 = 5 again. Or [3,2] and [1], which is 3 + 1 = 4, which is worse. So, in this case, the maximum sum is 5.

Another example: [1,1], the only way is to have one book in each pile, so sum is 1 + 1 = 2.

In the second test case from the example: 4 books with pages [2,3,3,1]. From the note, it says dividing books 2 and 3 in one pile and books 1 and 4 in the other pile gives sum 3 + 1 = 4. But actually, if we put the two books with 3 pages in separate piles, we get 3 + 3 = 6, which is better. Wait, but in the note, it says something different. Hmm, maybe I need to check that.

Wait, in the note, it says: "put books with numbers 2 and 3 in the first pile, and books with numbers 1 and 4 in the second pile. Then she will read the book with the highest number 3 from the first pile, and the book with the highest number 2 from the second pile. Then she will read a_3 + a_2 = 3 + 1 = 4 pages."

Wait, that seems incorrect. Because if she puts books 2 and 3 (which are 3 and 3 pages) in one pile, and books 1 and 4 (2 and 1 pages) in another pile, then the highest in the first pile is 3, and in the second pile is 2, so sum is 5, not 4 as mentioned in the note. Maybe there's a mistake in the note.

Wait, looking back, in the second test case, the output is 4, but according to my calculation, it should be 6 if she puts the two 3's in separate piles: one pile with [3], and another with [3,2,1], then she reads 3 + 3 = 6. That seems better than 5.

But in the note, it says something different. Maybe there's a misunderstanding in the problem statement.

Let me read the problem statement again carefully.

"Alice divides all the books into two non-empty piles. Then, she reads one book with the highest number in each pile."

So, she divides the books into two non-empty piles, and from each pile, she reads the book with the highest number of pages.

Goal: maximize the sum of the pages of the two books she reads.

Given that, in the second test case, with books [2,3,3,1], the best division is to put one 3 in each pile, so she reads 3 + 3 = 6.

But in the example output, it's 4. Wait, maybe I misread the example output.

Looking back at the example:

Input:

5

2

1 1

4

2 3 3 1

5

2 2 3 2 2

2

10 3

3

1 2 3

Output:

2

4

5

13

5

Wait, in the second test case, with n=4 and books [2,3,3,1], the output is 4, but according to my earlier reasoning, it should be 6. Hmm, maybe I'm missing something.

Wait, perhaps there's a constraint that the piles must be contiguous in the original order or something? No, the problem says "divides all the books into two non-empty piles. Thus, each book ends up in exactly one of the two piles." There's no mention of contiguity.

So, perhaps the note is wrong, or maybe I'm misunderstanding the problem.

Wait, in the note for the second test case, it says:

"Alice can put books with numbers 2 and 3 in the first pile, and books with numbers 1 and 4 in the second pile. Then she will read the book with the highest number 3 from the first pile, and the book with the highest number 2 from the second pile. Then she will read a_3 + a_4 = 3 + 1 = 4 pages."

Wait, a_3 is 3 and a_4 is 1, so sum is 4. But why not choose a_2 (which is 3) and a_4 (1), or other combinations?

Wait, perhaps I need to look at the indices carefully.

Assuming that the books are indexed from 1 to n, so in the second test case:

n=4

books: a1=2, a2=3, a3=3, a4=1

In the note, it says putting books 2 and 3 (a2=3 and a3=3) in the first pile, and books 1 and 4 (a1=2 and a4=1) in the second pile. Then, from the first pile, the highest is 3, from the second pile, the highest is 2, so sum is 5, not 4 as mentioned in the note.

Wait, maybe it's a typo in the note.

In the output, it's 4, but according to this division, it should be 5. Hmm.

Alternatively, maybe there's a misunderstanding in the problem statement.

Wait, perhaps the problem is that Alice reads the book with the highest number, meaning the book with the highest index, not the highest number of pages.

Wait, no, the problem says: "reads one book with the highest number in each pile."

Wait, "highest number" could refer to either the index or the number of pages.

But looking back, it says: "reads one book with the highest number in each pile."

I think it's referring to the highest number of pages, not the highest index.

In the first test case, with n=2 and books [1,1], dividing into two piles: one with book1=1 and one with book2=1, sum is 1+1=2, which matches the output.

In the second test case, n=4 with books [2,3,3,1], output is 4, but according to my earlier reasoning, it should be 6.

Wait, perhaps there's a misunderstanding.

Wait, maybe "reads one book with the highest number in each pile" means that from each pile, she reads the book with the highest index, not necessarily the highest number of pages.

Wait, that would make more sense with the second test case.

In the second test case, if she puts books 2 and 3 (indices 2 and 3, which are 3 and 3) in one pile, and books 1 and 4 (indices 1 and 4, which are 2 and 1) in the other pile, then the highest index in the first pile is 3, which has 3 pages, and in the second pile, the highest index is 4, which has 1 page, so sum is 3 + 1 = 4.

That matches the output.

So, it seems that "the highest number" refers to the highest index, not the highest number of pages.

Wait, but in the problem statement, it says "the highest number in each pile."

Wait, maybe it's ambiguous.

Looking back at the problem statement:

"Alice does the following:

- She divides all the books into two non-empty piles. Thus, each book ends up in exactly one of the two piles.

- Alice reads one book with the highest number in each pile."

And in the note:

"put books with numbers 2 and 3 in the first pile, and books with numbers 1 and 4 in the second pile. Then she will read the book with the highest number 3 from the first pile, and the book with the highest number 2 from the second pile."

Wait, here, "the book with the highest number 3" and "the book with the highest number 2" seems to refer to the book with index 3 and index 2, respectively.

So, it seems that "the highest number" refers to the highest index.

Therefore, "the highest number in each pile" means the book with the highest index in each pile.

So, Alice reads the book with the highest index from each pile, and we need to maximize the sum of the pages of those two books.

Okay, that changes things.

So, in the second test case, with books [2,3,3,1], if she puts books 2 and 3 (indices 2 and 3) in one pile, and books 1 and 4 (indices 1 and 4) in the other pile, then she reads book 3 (highest in first pile) and book 4 (highest in second pile), which have 3 and 1 pages, sum is 4.

But if she puts books 1 and 2 in one pile and books 3 and 4 in the other pile, then she reads book 2 (highest in first pile) and book 4 (highest in second pile), which have 3 and 1 pages, sum is 4 again.

Alternatively, if she puts books 1 and 3 in one pile and book 2 and 4 in the other pile, then she reads book 3 and book 4, which have 3 and 1 pages, sum is 4.

Wait, in all these cases, she gets sum 4.

Is there a way to get a higher sum?

Wait, for example, put books 1 and 4 in one pile, and books 2 and 3 in the other pile.

Then, she reads book 4 (highest in first pile) and book 3 (highest in second pile), which have 1 and 3 pages, sum is 4.

Same as before.

Alternatively, put books 1 in one pile and books 2,3,4 in the other pile.

Then, she reads book 1 (from first pile, which has only book 1) and book 4 (from second pile, highest index), which have 2 and 1 pages, sum is 3.

Worse than 4.

Alternatively, put books 1 and 2 in one pile, and books 3 and 4 in the other pile.

Then, she reads book 2 (from first pile) and book 4 (from second pile), which have 3 and 1 pages, sum is 4.

Same as before.

Seems like 4 is the best possible.

Wait, but earlier I thought of putting books with highest indices in separate piles to maximize the sum, but in this case, book 3 and book 2 both have 3 pages, so sum is 6.

Wait, no, if I put book 3 in one pile and book 2 in another pile, then she reads book 3 (highest in its pile) and book 2 (highest in its pile), sum is 3 + 3 = 6.

Wait, is that allowed?

Wait, no, because if I put book 3 in one pile and book 2 in another pile, what about books 1 and 4? I need to assign all books to exactly one of the two piles.

So, for example, put book 3 in pile A, book 2 in pile B, and then decide where to put books 1 and 4.

If I put book 1 in pile A and book 4 in pile B, then pile A has books 1 and 3, pile B has books 2 and 4.

Then, she reads book 3 (highest in pile A) and book 4 (highest in pile B), which have 3 and 1 pages, sum is 4.

Alternatively, put book 1 in pile B and book 4 in pile A.

Then, pile A has books 3 and 4, pile B has books 1 and 2.

She reads book 4 (from pile A) and book 2 (from pile B), which have 1 and 3 pages, sum is 4.

Same result.

Alternatively, put book 1 in pile A and book 4 in pile B.

Then, pile A has books 1 and 3, pile B has books 2 and 4.

Again, she reads book 3 and book 4, sum is 3 + 1 = 4.

Seems like no matter how I divide, I can't get more than 4.

But earlier I thought of 6.

Wait, maybe I'm misunderstanding the problem.

Wait, perhaps "the highest number in each pile" refers to the book with the highest number of pages in each pile, not the highest index.

But the note suggests that "the highest number" refers to the highest index.

Wait, in the note, it says "the book with the highest number 3 from the first pile", meaning the book with index 3, which has 3 pages.

But perhaps the problem statement is ambiguous.

Wait, looking back, the problem says "reads one book with the highest number in each pile."

And in the note, it refers to the highest-indexed book in each pile.

So, it seems that "highest number" refers to the highest index.

Therefore, Alice reads the book with the highest index in each pile, and we need to maximize the sum of their pages.

Given that, in the second test case, the maximum sum is indeed 4, as shown in the example.

Okay, now I need to think about how to maximize the sum of the pages of the highest-indexed books in each pile.

So, in each pile, the book with the highest index in that pile is fixed once the pile is determined.

Therefore, to maximize the sum, I need to choose the division such that the highest-indexed books in the two piles have the maximum possible sum.

Given that, perhaps the best strategy is to put the two books with the highest page counts as the highest-indexed books in their respective piles.

But I need to ensure that they are in different piles.

So, find the two books with the highest page counts, and assign them to separate piles, and assign the remaining books to either pile as needed.

Then, the sum would be the sum of the pages of these two books.

Wait, but in the second test case, the two books with the highest pages are both 3, and their indices are 2 and 3. If I put them in separate piles, and assign the other books accordingly, then the sum would be 3 + 3 = 6, but the example output is 4. So, perhaps I'm still misunderstanding.

Wait, but according to the problem, "reads one book with the highest number in each pile", where "highest number" refers to the highest index in the pile.

Therefore, I need to maximize the sum of the pages of the books with the highest indices in each pile.

So, the highest-indexed book in pile A and the highest-indexed book in pile B should have their pages summed, and I need to maximize that sum.

Therefore, I need to choose the division such that the book with the highest index in pile A and the book with the highest index in pile B have the maximum possible sum of their pages.

Given that, perhaps the strategy is to choose the two books with the highest page counts and assign them such that they are the highest-indexed books in their respective piles.

Wait, but to make a book the highest-indexed in a pile, I need to ensure that no higher-indexed book is in the same pile.

So, to make a book the highest-indexed in a pile, that pile cannot contain any book with a higher index.

But in this problem, since the books are indexed from 1 to n, and n is up to 100, I need to consider the indices.

Wait, perhaps I should consider all possible ways to split the books into two non-empty piles, ensuring that each pile has at least one book, and for each such division, identify the highest-indexed book in each pile, sum their pages, and find the maximum such sum.

Given that n can be up to 100, and t can be up to 500, a brute-force approach would be too slow, as the number of ways to divide n books into two non-empty piles is 2^n - 1, which is not feasible for n=100.

Therefore, I need a smarter approach.

Let me think about this differently.

Suppose I fix which pile each book goes to, with two piles, say pile 0 and pile 1.

Each pile must have at least one book.

Then, in pile 0, the highest-indexed book is the one with the largest index in that pile.

Similarly, in pile 1, the highest-indexed book is the one with the largest index in that pile.

I need to maximize the sum of the pages of these two books.

So, to maximize this sum, I need to choose the assignment of books to piles such that the highest-indexed books in each pile have the maximum possible pages.

One way to think about this is to iterate through the books from the highest index to the lowest index, deciding which pile to assign each book to, in a way that maximizes the sum.

Wait, perhaps a greedy approach would work.

Let me consider the books in decreasing order of index.

For each book, decide whether to put it in pile 0 or pile 1, in a way that maximizes the sum.

But I need to ensure that both piles have at least one book.

Wait, maybe dynamic programming could be used here, but that might be too slow for n=100.

Alternatively, perhaps there is a way to select two books whose indices are not consecutive, and assign them to separate piles, and assign the remaining books appropriately.

Wait, but indices are from 1 to n, and the piles can be any subset, as long as both piles are non-empty.

Wait, perhaps considering the highest-indexed book in each pile, and ensuring they are not in the same pile.

Wait, maybe I'm overcomplicating this.

Let me consider that the highest-indexed book in pile A is book i, and in pile B is book j, with i < j or j < i, and I need to maximize a_i + a_j, under the condition that pile A and pile B are non-empty and their union is all books.

Wait, perhaps I can iterate over all possible pairs of books (i, j), where i != j, and try to assign them such that i is the highest-indexed book in pile A and j is the highest-indexed book in pile B.

Then, to make i the highest-indexed book in pile A, pile A cannot contain any book with index higher than i.

Similarly, to make j the highest-indexed book in pile B, pile B cannot contain any book with index higher than j.

Also, both piles must contain at least one book.

Wait, but since I'm choosing i and j, and assigning them to separate piles, I need to ensure that the piles can be formed accordingly.

So, for chosen i and j, with i < j, say, then pile A can contain any subset of books with index <= i, and pile B can contain any subset of books with index <= j, but greater than i.

Wait, this seems complicated.

Alternatively, perhaps the maximum sum can be achieved by selecting the two books with the highest page counts, provided that they are not forced to be in the same pile due to their indices.

But in the second test case, the two books with the highest page counts are a2=3 and a3=3, which have indices 2 and 3.

If I put a3 in pile A and a2 in pile B, then the highest-indexed book in pile A is a3=3, and in pile B is a2=3, sum is 6.

But according to the example, it's 4.

Wait, perhaps there's a constraint I'm missing.

Wait, no, in the second test case, output is 4, but according to this, it should be 6.

Wait, maybe I'm misunderstanding the problem.

Wait, perhaps "the highest number in each pile" refers to the highest page count in each pile.

But in the note, it refers to the highest index.

Wait, perhaps there's confusion in the note.

Looking back, the problem says "reads one book with the highest number in each pile."

I think it's ambiguous whether "highest number" refers to the highest index or the highest page count.

Given the note, it seems to refer to the highest index.

Therefore, I'll assume that "highest number" refers to the highest index in the pile.

Therefore, Alice reads the book with the highest index in each pile, and we need to maximize the sum of their pages.

Given that, in the second test case, with books [2,3,3,1], the highest-indexed books in the two piles could be book 3 and book 4, which have 3 and 1 pages, sum is 4.

Alternatively, book 2 and book 4, sum is 3 + 1 = 4.

Or book 3 and book 2, sum is 3 + 3 = 6.

Wait, but if I put book 3 in one pile and book 2 in another pile, and ensure that no higher-indexed books are in the same pile, then I can achieve sum 6.

Wait, let's see.

Suppose pile A contains books 1 and 3, pile B contains books 2 and 4.

Then, the highest-indexed book in pile A is book 3, with 3 pages.

The highest-indexed book in pile B is book 4, with 1 page.

Sum is 4.

Alternatively, pile A contains books 1 and 2, pile B contains books 3 and 4.

Highest-indexed in pile A is book 2 (3 pages), in pile B is book 4 (1 page), sum is 4.

Alternatively, pile A contains books 1, pile B contains books 2,3,4.

Highest-indexed in pile A is book 1 (2 pages), in pile B is book 4 (1 page), sum is 3.

Alternatively, pile A contains books 3, pile B contains books 1,2,4.

Highest-indexed in pile A is book 3 (3 pages), in pile B is book 4 (1 page), sum is 4.

Alternatively, pile A contains books 2 and 3, pile B contains books 1 and 4.

Highest-indexed in pile A is book 3 (3 pages), in pile B is book 4 (1 page), sum is 4.

Wait, but in this case, I can't put book 3 in one pile and book 2 in another pile without including books 1 and 4 in appropriate piles, but in all such divisions, the sum seems to be 4, not 6.

Wait, perhaps I made a mistake earlier.

Let me try again.

Suppose pile A contains only book 3, pile B contains books 1,2,4.

Then, highest-indexed in pile A is book 3 (3 pages), in pile B is book 4 (1 page), sum is 4.

Alternatively, pile A contains books 2 and 3, pile B contains books 1 and 4.

Highest-indexed in pile A is book 3 (3 pages), in pile B is book 4 (1 page), sum is 4.

Alternatively, pile A contains books 2 and 3, pile B contains book 1.

Then, highest-indexed in pile A is book 3 (3 pages), in pile B is book 1 (2 pages), sum is 5.

Wait, that's better.

So, in this division, pile A has books 2 and 3, pile B has book 1.

Then, highest-indexed in pile A is book 3 (3 pages), in pile B is book 1 (2 pages), sum is 5.

Similarly, pile A has books 2,3,4, pile B has book 1.

Highest-indexed in pile A is book 4 (1 page), in pile B is book 1 (2 pages), sum is 3.

Worse than 5.

Alternatively, pile A has books 3 and 4, pile B has books 1 and 2.

Highest-indexed in pile A is book 4 (1 page), in pile B is book 2 (3 pages), sum is 4.

Worse than 5.

Alternatively, pile A has books 3, pile B has books 1,2,4.

Highest-indexed in pile A is book 3 (3 pages), in pile B is book 4 (1 page), sum is 4.

Worse than 5.

So, the best sum is 5, but in the example output, it's 4.

Wait, maybe I made a mistake.

Looking back at the note, it says:

"Alice can put books with numbers 2 and 3 in the first pile, and books with numbers 1 and 4 in the second pile. Then she will read the book with the highest number 3 from the first pile, and the book with the highest number 2 from the second pile. Then she will read a_3 + a_2 = 3 + 1 = 4 pages."

Wait, that doesn't make sense because a3 is 3 and a2 is 3, so sum should be 6.

But perhaps there's a misunderstanding.

Wait, perhaps "the book with the highest number in each pile" refers to the book with the highest page count in each pile.

But the note says "the book with the highest number 3 from the first pile", meaning the book with 3 pages, and "the book with the highest number 2 from the second pile", meaning the book with 2 pages.

Wait, perhaps it's referring to the page counts
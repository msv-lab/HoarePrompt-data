Alright, I have this problem to solve. Let's read it carefully.

So, there are two firework installations that launch fireworks at regular intervals. The first one launches every 'a' minutes, and the second one every 'b' minutes. Each firework remains visible in the sky for 'm + 1' minutes after it's launched, meaning it's visible from time x to x + m inclusive.

I need to find the maximum number of fireworks that can be seen in the sky at the same time.

First, I need to understand how the fireworks are launched and when they are visible.

Let's consider the launch times:

- Installation 1 launches at times: a, 2a, 3a, ...

- Installation 2 launches at times: b, 2b, 3b, ...

And each firework is visible from its launch time to launch time + m.

I need to find a time when the most fireworks are visible.

Let me think about how to approach this.

One way is to consider all possible launch times and see how many fireworks are visible at any given time. But since a, b, and m can be up to 10^18, it's impossible to iterate through all possible times.

I need a smarter way to calculate the maximum number of visible fireworks without iterating through each minute.

Let me consider the visibility periods for each firework.

For installation 1:

- Firework launched at time a is visible from a to a + m

- Firework launched at time 2a is visible from 2a to 2a + m

- And so on.

Similarly for installation 2:

- Firework launched at time b is visible from b to b + m

- Firework launched at time 2b is visible from 2b to 2b + m

- And so on.

I need to find a time when the most of these intervals overlap.

This seems like a classic problem of finding maximum overlapping intervals, but with a twist because of the large numbers involved.

In general, to find the maximum number of overlapping intervals, I would list all intervals and sort their start and end times, then use a sweep line algorithm. But with a, b, and m up to 10^18, I can't generate all intervals.

I need to find a mathematical way to calculate the maximum number of overlapping fireworks without generating all intervals.

Let's think about how many fireworks from each installation are visible at a certain time.

For installation 1, the number of fireworks visible at time t is the number of k such that k*a <= t < k*a + m + 1.

Similarly for installation 2: the number of l such that l*b <= t < l*b + m + 1.

But I need to find the maximum of the sum of these two for any t.

This seems tricky. Maybe I can find the time when the most fireworks are visible by considering the launch times and their visibility periods.

Let me consider the possible overlaps.

Case 1: a and b are multiples of each other.

If a divides b or b divides a, then one installation's launch times are a subset of the other's.

For example, if a = 2 and b = 4, then every second launch of b coincides with a launch of a.

In this case, the visibility periods might overlap more frequently.

Case 2: a and b are co-prime.

If a and b have no common divisors, their launch times won't coincide except at time LCM(a, b), which could be very large.

In this case, overlaps might be less frequent.

But I need a general approach that works for any a, b, and m.

Let me think about how many fireworks from each installation are visible at any time t.

For installation 1:

The number of fireworks visible at time t is the number of k where k*a <= t < k*a + m + 1.

This can be rewritten as:

k <= t / a < k + (m + 1)/a

Since k must be an integer, the number of such k is floor(t / a) - floor((t - m - 1)/a)

Similarly for installation 2: floor(t / b) - floor((t - m - 1)/b)

So, at any time t, the total number of visible fireworks is:

(floor(t / a) - floor((t - m - 1)/a)) + (floor(t / b) - floor((t - m - 1)/b))

I need to maximize this sum over all t.

This seems complicated to maximize directly because of the floor functions.

Maybe there's a better way.

Let me consider the maximum possible number of overlapping fireworks.

In the best case, all fireworks from both installations are visible at the same time.

But that's unlikely unless a and b are very small and m is large.

But in general, the maximum number will be the sum of the maximum number of overlapping fireworks from each installation, plus any overlaps between the two installations.

Wait, perhaps I need to calculate the maximum number of fireworks from each installation that can be visible at the same time, and then sum them up, considering any possible overlaps.

For installation 1, the maximum number of visible fireworks is ceil(m + 1 / a).

Similarly for installation 2, ceil(m + 1 / b).

But since fireworks from different installations can overlap, the total maximum could be the sum of these two.

But in reality, it might be higher due to overlapping launch times.

Wait, no. If launches from both installations coincide at certain times, then the visible fireworks from both installations can be higher.

Wait, actually, I think the maximum number of visible fireworks is the sum of the maximum number of overlapping fireworks from each installation.

Because at any time, the number of visible fireworks from installation 1 is at most ceil(m / a) + 1, and similarly for installation 2.

But I need to think carefully.

Let me consider an example.

Take the first test case:

a = 6, b = 7, m = 4

So, m + 1 = 5

For installation 1:

Fireworks launched at 6, 12, 18, 24, 30, ...

Each visible from t to t + 4

Similarly, installation 2: 7, 14, 21, 28, 35, ...

Visible from t to t + 4

At t = 7:

Firework from installation 1 launched at t = 6 is visible from 6 to 10

Firework from installation 2 launched at t = 7 is visible from 7 to 11

So, at t = 7, both are visible.

Similarly, at t = 14:

Firework from installation 1 launched at t = 12 is visible from 12 to 16

Firework from installation 2 launched at t = 14 is visible from 14 to 18

So, both are visible at t = 14

But, is there a time when more than two fireworks are visible?

Let's check t = 112 from the third test case.

a = 7, b = 8, m = 56

m + 1 = 57

Number of fireworks from installation 1: floor(112 / 7) - floor((112 - 57)/7) = floor(16) - floor(7) = 16 - 7 = 9

Similarly, installation 2: floor(112 / 8) - floor((112 - 57)/8) = floor(14) - floor(6) = 14 - 6 = 8

Total: 9 + 8 = 17

So, in this case, 17 fireworks are visible at t = 112

This matches the sample output.

So, perhaps the general formula is:

For a given time t, the number of visible fireworks from installation 1 is floor(t / a) - floor((t - m - 1)/a)

Similarly for installation 2: floor(t / b) - floor((t - m - 1)/b)

And the maximum total is the maximum over t of these sums.

But finding the maximum over all t seems difficult.

Is there a way to find t that maximizes this sum?

Alternatively, perhaps I can find t such that t is as large as possible, to maximize the number of fireworks from each installation.

But m is finite, so there's a limit to how many fireworks can be visible.

Wait, perhaps I can consider t to be LCM(a, b) * k for some k, to maximize overlaps.

But LCM could be very large, up to 10^18, which is acceptable since we're dealing with big integers in Python.

But even then, calculating LCM might not be necessary.

Looking back at the sample input and output, perhaps the maximum number of visible fireworks is simply the sum of the maximum number of overlapping fireworks from each installation.

For installation 1: floor((m + 1)/a) + 1

Similarly for installation 2: floor((m + 1)/b) + 1

Then, sum them up.

Wait, in the first sample:

a = 6, b = 7, m = 4

floor(5/6) + 1 = 0 + 1 = 1

floor(5/7) + 1 = 0 + 1 = 1

Sum: 2, which matches the sample output.

In the third sample:

a = 7, b = 8, m = 56

floor(57/7) + 1 = 8 + 1 = 9

floor(57/8) + 1 = 7 + 1 = 8

Sum: 17, which matches the sample output.

Similarly, in the second sample:

a = 3, b = 4, m = 10

floor(11/3) + 1 = 3 + 1 = 4

floor(11/4) + 1 = 2 + 1 = 3

Sum: 7, which matches the sample output.

Wait, but in the fourth sample:

a = 5, b = 6, m = 78123459896

floor(78123459897/5) + 1 = 15624691979 + 1 = 15624691980

floor(78123459897/6) + 1 = 13020576649 + 1 = 13020576650

Sum: 15624691980 + 13020576650 = 28645268630, which matches the sample output.

Similarly, in the fifth sample:

a = 1, b = 1, m = 1

floor(2/1) + 1 = 2 + 1 = 3

floor(2/1) + 1 = 2 + 1 = 3

Sum: 6, but the sample output is 4.

Wait, that doesn't match.

Wait, perhaps I have a mistake in the formula.

Wait, if a = 1, b = 1, m = 1

Then m + 1 = 2

floor(2/1) + 1 = 2 + 1 = 3

floor(2/1) + 1 = 2 + 1 = 3

Sum: 6

But sample output is 4.

So, my formula is incorrect in this case.

Wait, perhaps I need to adjust the formula.

Let me think again.

The number of fireworks from installation 1 visible at time t is floor(t / a) - floor((t - m - 1)/a)

Similarly for installation 2.

But to find the maximum over all t, perhaps I need to find t such that both installations have as many fireworks visible as possible.

But in the case a = b = 1, m = 1

At t = 1:

Firework launched at t = 1 is visible from 1 to 2

At t = 2:

Firework launched at t = 1 is visible from 1 to 2

Firework launched at t = 2 is visible from 2 to 3

So, at t = 2, both fireworks from installation 1 are visible.

Similarly for installation 2.

But since a = b = 1, every firework is launched every minute and visible for m + 1 minutes.

Wait, but m = 1, so each firework is visible for 2 minutes.

So, at t = 2:

Fireworks from installation 1 launched at t = 1 and t = 2 are both visible.

Similarly, fireworks from installation 2 launched at t = 1 and t = 2 are both visible.

So, total fireworks visible: 4, which matches the sample output.

But according to my earlier formula:

floor(2/1) - floor((2 - 2)/1) = 2 - 0 = 2 for installation 1

Similarly for installation 2: 2 - 0 = 2

Sum: 4, which matches the sample output.

Wait, but earlier I thought it was floor(t / a) + 1, which gave me 3, but that's incorrect.

So, the correct formula is floor(t / a) - floor((t - m - 1)/a)

In this case:

floor(2 / 1) - floor((2 - 2)/1) = 2 - 0 = 2

Similarly for installation 2: 2 - 0 = 2

Sum: 4, which matches the sample output.

So, my earlier formula was wrong; it should be floor(t / a) - floor((t - m - 1)/a), not floor((m + 1)/a) + 1.

Wait, but in the earlier test cases, it seemed to work.

Wait, in the first test case:

a = 6, b = 7, m = 4

m + 1 = 5

floor(5 / 6) - floor((5 - 5)/6) = 0 - 0 = 0 for installation 1

floor(5 / 7) - floor((5 - 5)/7) = 0 - 0 = 0 for installation 2

Sum: 0, but sample output is 2.

Wait, that doesn't make sense.

Wait, perhaps I need to choose t appropriately to maximize the number of visible fireworks.

In the first test case, at t = 7:

For installation 1: floor(7 / 6) - floor((7 - 5)/6) = 1 - 0 = 1

For installation 2: floor(7 / 7) - floor((7 - 5)/7) = 1 - 0 = 1

Sum: 2, which matches the sample output.

Similarly, in the third test case, at t = 112:

For installation 1: floor(112 / 7) - floor((112 - 57)/7) = 16 - 7 = 9

For installation 2: floor(112 / 8) - floor((112 - 57)/8) = 14 - 6 = 8

Sum: 17, which matches the sample output.

So, the general approach is to choose t such that floor(t / a) - floor((t - m - 1)/a) is maximized for installation 1, and similarly for installation 2.

But I need to choose t to maximize the sum of these two.

Given that a and b can be different, and m can be large, I need to find a t that maximizes both expressions simultaneously.

Is there a way to choose t to maximize both terms?

I think that choosing t to be a multiple of a and b would help, but it's not necessarily the case.

Wait, perhaps choosing t to be LCM(a, b) would maximize the overlaps.

But in the first test case, LCM(6,7) = 42.

At t = 42:

Installation 1: floor(42 / 6) - floor((42 - 5)/6) = 7 - 6 = 1

Installation 2: floor(42 / 7) - floor((42 - 5)/7) = 6 - 5 = 1

Sum: 2, which is the same as at t = 7.

But in the third test case, t = 112 gives a higher sum.

So, LCM is not necessarily the optimal t.

Alternatively, perhaps choosing t to be m + 1 would maximize the number of visible fireworks.

In the first test case, t = 5:

Installation 1: floor(5 / 6) - floor((5 - 5)/6) = 0 - 0 = 0

Installation 2: floor(5 / 7) - floor((5 - 5)/7) = 0 - 0 = 0

Sum: 0, which is less than the sample output of 2.

So, t = m + 1 is not always optimal.

Wait, in the fifth test case, a = 1, b = 1, m = 1

At t = 2:

Installation 1: floor(2 / 1) - floor((2 - 2)/1) = 2 - 0 = 2

Installation 2: floor(2 / 1) - floor((2 - 2)/1) = 2 - 0 = 2

Sum: 4, which matches the sample output.

At t = 1:

Installation 1: floor(1 / 1) - floor((1 - 2)/1) = 1 - floor(-1) = 1 - (-1) = 1 - (-1) = 1 - (-1) = 1 - (-1) = 1 - (-1) = 1 - (-1)

Wait, floor of negative numbers: floor(-1) = -1

So, floor(1 / 1) - floor((1 - 2)/1) = 1 - (-1) = 2

Similarly for installation 2: 2

Sum: 4, same as at t = 2.

So, t = 1 also gives sum = 4.

Hence, the optimal t is either t = m + 1 or t = LCM(a, b), or something in between.

But calculating LCM for large a and b could be problematic if a and b are both large, but in Python, big integers are handled well.

But perhaps there is a mathematical formula to calculate the maximum without finding LCM.

Let me consider the general formula for the number of visible fireworks from installation 1:

floor(t / a) - floor((t - m - 1)/a)

Similarly for installation 2.

I need to maximize the sum over t.

Let me denote:

For installation 1: let k = floor(t / a)

Then floor((t - m - 1)/a) = floor((t / a) - (m + 1)/a) = floor(k + (t - k*a)/a - (m + 1)/a) = floor(k + (t - k*a - m - 1)/a)

But this seems complicated.

Alternatively, I can think of the number of visible fireworks from installation 1 as the number of launch times k*a such that t - m - 1 < k*a <= t

Which is equivalent to ceil((t - m - 1)/a) <= k <= floor(t / a)

So, the number is floor(t / a) - ceil((t - m - 1)/a) + 1

Similarly for installation 2.

Hence, the total number is:

[ floor(t / a) - ceil((t - m - 1)/a) + 1 ] + [ floor(t / b) - ceil((t - m - 1)/b) + 1 ]

I need to maximize this sum over t.

But dealing with ceil functions is a bit messy.

Alternatively, I can use the fact that ceil(x) = floor(x + 1e-9)

So, ceil((t - m - 1)/a) = floor((t - m - 1)/a + 1e-9)

But in programming, this might not be precise due to floating point precision issues, especially with large integers.

Alternatively, perhaps I can find t such that t modulo a is close to a - m - 1, and similarly for b.

Wait, maybe I need to consider the time when the visibility periods of multiple fireworks overlap.

But this seems too vague.

Let me consider that for installation 1, the number of visible fireworks is floor(t / a) - floor((t - m - 1)/a)

Similarly for installation 2.

I need to maximize the sum of these two.

Let me consider that for installation 1, the maximum value of floor(t / a) - floor((t - m - 1)/a) is floor(m + 1 / a) + 1

Wait, no.

Wait, floor(t / a) - floor((t - m - 1)/a) <= floor(t / a)

And floor(t / a) can be large if t is large.

But m + 1 is fixed, so perhaps there is a better way.

Wait, perhaps the maximum number of visible fireworks from installation 1 is floor(m + 1 / a)

Similarly for installation 2.

Wait, in the first test case:

floor(5 / 6) = 0, but earlier at t = 7, we have floor(7 / 6) - floor((7 - 5)/6) = 1 - 0 = 1

At t = 11, floor(11 / 6) - floor((11 - 5)/6) = 1 - 1 = 0

Wait, at t = 6, floor(6 / 6) - floor((6 - 5)/6) = 1 - 0 = 1

At t = 7, 1 - 0 = 1

At t = 8, floor(8 / 6) - floor((8 - 5)/6) = 1 - 0 = 1

At t = 9, floor(9 / 6) - floor((9 - 5)/6) = 1 - 0 = 1

At t = 10, floor(10 / 6) - floor((10 - 5)/6) = 1 - 0 = 1

At t = 11, floor(11 / 6) - floor((11 - 5)/6) = 1 - 1 = 0

So, for installation 1, the maximum is 1.

Similarly for installation 2, floor(t / 7) - floor((t - 5)/7), which is also 1.

Hence, sum is 2, which matches the sample.

But in the third test case, floor(t / 7) - floor((t - 57)/7) = floor(t / 7) - floor((t - 57)/7)

At t = 112:

floor(112 / 7) - floor((112 - 57)/7) = 16 - 7 = 9

Similarly for installation 2: floor(112 / 8) - floor((112 - 57)/8) = 14 - 6 = 8

Sum: 17

But according to my earlier assumption, floor(m + 1 / a) + 1 = floor(57 / 7) + 1 = 8 + 1 = 9

Similarly for installation 2: 8 + 1 = 9

Sum: 18, but sample output is 17

Wait, perhaps it's floor(m / a) + 1

floor(56 / 7) + 1 = 8 + 1 = 9, which matches.

But in this case, sum would be 18, but sample output is 17.

So, perhaps sometimes the sum is less than the individual maximums added together.

This suggests that there might be overlaps in the visibility periods that cause the total to be less than the sum of the individual maximums.

Hence, perhaps the formula is not simply the sum of floor(m / a) + 1 and floor(m / b) + 1.

Wait, in the fifth test case, a = 1, b = 1, m = 1

floor(1 / 1) + 1 = 1 + 1 = 2

Sum: 4, which matches.

But in the third test case, floor(56 / 7) + 1 = 8 + 1 = 9

floor(56 / 8) + 1 = 7 + 1 = 8

Sum: 17, which matches the sample.

Wait, but earlier I thought it should be 18, but sample output is 17.

Wait, perhaps in some cases, the sum is less due to overlapping launch times.

But in this case, a = 7 and b = 8, which are co-prime,
Alright, I've got this problem to solve. Let's see what it's asking for. There are three friends playing chess together, and in each game, two of them play against each other. The winner gets 2 points, the loser gets 0, and in case of a draw, both get 1 point each. After all the games, their scores are p1, p2, and p3, with p1 ≤ p2 ≤ p3. I need to find the maximum number of draws that could have happened, or determine if the scores are invalid.

First, I need to understand the constraints and what constitutes a valid set of scores. Since p1 ≤ p2 ≤ p3, the scores are sorted in non-decreasing order, which might help in simplifying the problem.

Let me think about how the points are distributed in each game:

- If there's a winner and a loser, the winner gets 2 points, and the loser gets 0.

- If it's a draw, both players get 1 point each.

Also, note that the same pair of players can play multiple times, and it's possible that no games were played at all.

Given the scores p1, p2, p3, I need to determine if there's a way to achieve these scores through a series of games, and if so, find the maximum number of draws that could have occurred.

First, I should check if the total sum of points is even or odd. In each game, regardless of outcome, the total points awarded are either 2 (in case of a winner and a loser) or 2 (in case of a draw, since both get 1 point each). So, in every game, 2 points are awarded in total. Therefore, the total sum of points should be even. If it's odd, it's impossible to achieve those scores, and I should output -1.

Let's formalize that:

If (p1 + p2 + p3) is odd, output -1.

Otherwise, proceed.

Now, I need to maximize the number of draws. Each draw contributes 2 points to the total sum (1 point to each player involved in the draw). Each game with a winner contributes 2 points to the total sum (2 to the winner and 0 to the loser).

So, to maximize the number of draws, I should maximize the number of games that end in a draw, given the constraints of the individual scores.

Let me denote:

- Let d be the number of draws.

- Let w be the number of games with a winner.

Then, the total number of games is d + w.

The total points would be:

Total points = 2d + 2w = 2(d + w)

But we also have:

p1 + p2 + p3 = 2(d + w)

So, as I thought earlier, the total sum must be even.

Now, I need to distribute the points such that p1, p2, p3 are achieved, with p1 ≤ p2 ≤ p3.

In each draw, two players each get 1 point, so a draw increases the points of two players by 1 each.

In each game with a winner, one player gets 2 points, and the other gets 0.

Given that, I need to find the maximum d such that the points can be distributed accordingly.

Let me consider the maximum possible d.

If all games were draws, then each draw would contribute 1 point to two players. So, with d draws, the sum of points would be 2d.

But since p1 + p2 + p3 = 2(d + w), and if d is maximized, w is minimized.

The minimum w is 0, but it might not be possible to have w = 0.

Wait, but in some cases, w must be greater than 0 to achieve certain score distributions.

I need to find the maximum d such that the points can be distributed to achieve p1, p2, p3.

Let me think differently.

Let me consider the minimal number of wins (w) needed to achieve the scores, and then the remaining games can be draws.

But I need to maximize draws, so I need to minimize wins.

Wait, but I need to maximize draws, which would minimize wins.

But I need to ensure that the points can be achieved.

Let me consider the difference in points.

Since p1 ≤ p2 ≤ p3, the highest score is p3.

I need to see how p3 can achieve their score, considering that they can only gain points from games they play.

Let me consider that each player plays against each other any number of times.

So, possible pairs are:

- Player 1 vs Player 2

- Player 1 vs Player 3

- Player 2 vs Player 3

Each pair can play multiple games.

I need to distribute the wins and draws among these pairs to achieve the scores.

This seems a bit complicated. Maybe there's a better way.

Let me look at the example inputs and outputs to get some intuition.

First example:

Input: 0 0 0

Output: 0

Explanation: No games were played, so no draws.

Second example:

Input: 0 1 1

Output: 1

Explanation: One draw between player 2 and 3.

Third example:

Input: 1 1 1

Output: -1

Explanation: It's impossible to achieve these scores.

Fourth example:

Input: 1 1 2

Output: 2

Explanation: Not clear yet.

Fifth example:

Input: 3 3 3

Output: -1

Sixth example:

Input: 3 4 5

Output: 6

Seventh example:

Input: 1 1 10

Output: 2

Wait, the seventh example has p1=1, p2=1, p3=10. That seems interesting.

Let me try to understand the fourth example:

Input: 1 1 2

Possible games:

- Suppose player 1 and player 2 play a draw: both get 1 point each.

- Then, player 1 and player 3 play a game: if player 3 wins, player 3 gets 2 points, player 1 gets 0.

So, after these two games:

- Player 1: 1 (from draw) + 0 = 1

- Player 2: 1 (from draw) + 0 = 1

- Player 3: 2 (from win)

Which matches the input: 1,1,2

Number of draws: 1

But the output is 2. So maybe there's another way.

Wait, maybe there were two draws involving player 3.

- Player 1 and player 3 draw: player 1 gets 1, player 3 gets 1

- Player 2 and player 3 draw: player 2 gets 1, player 3 gets 1

Total points:

- Player 1: 1

- Player 2: 1

- Player 3: 1 + 1 = 2

So, two draws achieve the same result.

Hence, the maximum number of draws is 2.

That makes sense.

Now, looking back at the third example:

Input: 1 1 1

Total points: 3, which is odd. So, impossible. Output: -1

Wait, but in the first example, 0 0 0, total points is 0, which is even, and number of draws is 0.

Second example: 0 1 1, total points 2, which is even, and number of draws is 1.

Third example: 1 1 1, total points 3, which is odd, so -1.

Fourth example: 1 1 2, total points 4, which is even, and number of draws is 2.

Fifth example: 3 3 3, total points 9, which is odd, so -1.

Sixth example: 3 4 5, total points 12, which is even, and number of draws is 6.

Seventh example: 1 1 10, total points 12, which is even, and number of draws is 2.

So, it seems that if the total points are odd, it's impossible, and we output -1.

If the total points are even, then we need to compute the maximum number of draws.

Now, I need to find a formula to compute the maximum number of draws given the scores p1, p2, p3.

Let me denote:

- Let s = p1 + p2 + p3

- Since s must be even, we can proceed.

Now, in each draw, two players each get 1 point, so each draw contributes 2 points to the total sum.

In each game with a winner, one player gets 2 points, and the other gets 0, so it also contributes 2 points to the total sum.

Therefore, the total number of games is s / 2.

Now, to maximize the number of draws, we need to maximize d such that the points can be distributed accordingly.

But there are constraints on how the points are distributed based on the games played.

Let me think about the minimal number of wins required to achieve the scores.

The minimal number of wins would be determined by the maximal score minus what can be achieved through draws.

Wait, perhaps it's better to think in terms of the maximal score.

Player 3 has the highest score, p3.

To maximize draws, we need to minimize the number of wins.

The number of wins is minimized when player 3 gets their points mostly from wins.

Wait, but to maximize draws, perhaps player 3 should get their points from draws as much as possible.

Wait, no. If player 3 gets points from draws, that allows other players to get points as well.

But to maximize draws, we need to have as many games as possible end in draws.

But we need to satisfy the individual scores.

Let me consider that the sum of points is s = p1 + p2 + p3, which is even.

The total number of games is s / 2.

Now, in each draw, two players each get 1 point, so it's like distributing 1 point to each of the two players involved.

In each win, one player gets 2 points, and the other gets 0.

To maximize draws, we need to maximize the number of games where points are distributed equally among the players involved.

But I need to ensure that the individual scores are met.

Let me consider the minimal number of wins needed to achieve the maximal score.

Specifically, player 3 has the highest score, p3.

The maximal score p3 can be achieved through a combination of wins and draws.

Each win gives player 3 2 points, and each draw gives player 3 1 point.

To maximize draws, I need to minimize the number of wins for player 3.

So, the minimal number of wins for player 3 is ceil(p3 / 2).

Wait, no. If player 3 has p3 points, and each win gives 2 points, and draws give 1 point, then to minimize wins, player 3 should have as many points as possible from draws.

Wait, but to minimize wins, player 3 should have their points from as many draws as possible.

Each draw involving player 3 gives player 3 one point.

So, to achieve p3 points, if all p3 points come from draws, then player 3 would have p3 points from p3 draws.

But in reality, player 3 can also get points from wins.

Wait, to minimize wins, we maximize draws.

So, the minimal number of wins for player 3 is floor(p3 / 2), and the remaining points come from draws.

Wait, no.

Let me think again.

If player 3 has p3 points, and each win gives 2 points, and each draw gives 1 point, then to minimize wins, we maximize the points from draws.

So, the minimal number of wins for player 3 is ceil((p3 - d3) / 2), where d3 is the number of draws involving player 3.

But this seems complicated.

Maybe there's a better way.

Let me look at the formula provided in the program:

result = (v[0] + v[1] + v[2] - max(0, v[2] - v[0] - v[1])) // 2

I need to understand why this formula works.

First, s = v[0] + v[1] + v[2]

If s is odd, output -1

Else, compute result as (s - max(0, v[2] - v[0] - v[1])) // 2

Let me see what max(0, v[2] - v[0] - v[1]) represents.

Given that v[0] ≤ v[1] ≤ v[2], v[2] - v[0] - v[1] could be positive or negative.

But since v[0] ≤ v[1] ≤ v[2], v[2] - v[0] - v[1] could be positive if v[2] > v[0] + v[1], or zero otherwise.

Wait, no. Since v[0] ≤ v[1] ≤ v[2], v[2] - v[0] - v[1] could be positive or negative.

For example:

In the fourth example: 1 1 2

v[2] - v[0] - v[1] = 2 - 1 - 1 = 0

So, max(0, 0) = 0

Then, result = (1 + 1 + 2 - 0) // 2 = 4 // 2 = 2, which matches the output.

In the third example: 1 1 1

v[2] - v[0] - v[1] = 1 - 1 - 1 = -1

max(0, -1) = 0

result = (1 + 1 + 1 - 0) // 2 = 3 // 2 = 1

But the output should be -1, which contradicts this formula.

Wait, perhaps there's more to it.

Looking back at the program, it seems that when s is odd, it outputs -1, otherwise it computes the result as above.

But in the third example, s = 3, which is odd, so it should output -1, which matches.

Wait, but according to the formula, if s is odd, output -1, else compute result as above.

In the fourth example, s = 4, which is even, and result = 2, which matches.

In the fifth example: 3 3 3

s = 9, which is odd, so output -1, which matches.

Sixth example: 3 4 5

s = 12, which is even

v[2] - v[0] - v[1] = 5 - 3 - 4 = -2

max(0, -2) = 0

result = (3 + 4 + 5 - 0) // 2 = 12 // 2 = 6, which matches the output.

Seventh example: 1 1 10

s = 12, which is even

v[2] - v[0] - v[1] = 10 - 1 - 1 = 8

max(0, 8) = 8

result = (1 + 1 + 10 - 8) // 2 = (12 - 8) // 2 = 4 // 2 = 2, which matches the output.

So, the formula seems to work for these cases.

Now, I need to understand why this formula gives the maximum number of draws.

Let me try to interpret the formula.

result = (s - max(0, v[2] - v[0] - v[1])) // 2

First, s is the total sum of points, which is even.

Now, max(0, v[2] - v[0] - v[1]) seems to represent some kind of excess in player 3's score that cannot be achieved through draws alone.

Let me think about it.

If v[2] ≤ v[0] + v[1], then max(0, v[2] - v[0] - v[1]) = 0

So, result = s // 2

But if v[2] > v[0] + v[1], then max(0, v[2] - v[0] - v[1]) = v[2] - v[0] - v[1]

So, result = (s - (v[2] - v[0] - v[1})) // 2 = (v[0] + v[1] + v[2] - v[2] + v[0] + v[1}) // 2 = (2v[0] + 2v[1]) // 2 = v[0] + v[1]

Wait, that seems off.

Wait, let's compute it properly:

result = (v[0] + v[1] + v[2] - (v[2] - v[0] - v[1})) // 2 = (v[0] + v[1] + v[2] - v[2] + v[0] + v[1}) // 2 = (2v[0] + 2v[1}) // 2 = v[0] + v[1]

But in the seventh example, v[0]=1, v[1]=1, v[2]=10

So, v[2] - v[0] - v[1] = 10 - 1 -1 = 8

max(0,8)=8

result = (1+1+10 -8)//2 = (12-8)//2 =4//2=2, which matches the output.

But why does this represent the maximum number of draws?

Let me think about it differently.

In the seventh example, p1=1, p2=1, p3=10

Total points s=12, which is even.

To maximize draws, we need to have as many draws as possible.

Each draw contributes 2 points to the total sum (1 point to each player involved).

So, the maximum number of draws is s // 2 = 6.

But in this case, the output is 2, which is less than 6.

So, my previous assumption is incorrect.

Wait, perhaps there are constraints on individual scores that limit the number of draws.

Specifically, in the seventh example, p3=10, which is higher than p1 and p2.

To achieve p3=10, player 3 must have won some games.

Let me think about how player 3 can achieve 10 points.

Player 3 can achieve points through wins and draws.

Each win gives 2 points, each draw gives 1 point.

Let me denote:

Let w3 be the number of wins for player 3.

Let d3 be the number of draws involving player 3.

Then, points for player 3: p3 = 2*w3 + d3

Similarly, points for other players involved in these games.

Wait, but player 3 plays against player 1 and player 2.

Let me denote:

- Let d13 be the number of draws between player 1 and player 3.

- Let d23 be the number of draws between player 2 and player 3.

- Let d12 be the number of draws between player 1 and player 2.

- Let w13 be the number of wins for player 3 against player 1.

- Let w23 be the number of wins for player 3 against player 2.

- Let w12 be the number of wins for player 2 against player 1.

Wait, but in the problem, any pair can play multiple games, and in each game, it's either a win for one player or a draw.

So, total points:

p1 = d12 + d13 + 2*w13

p2 = d12 + d23 + 2*w23

p3 = d13 + d23 + 2*(w3_total)

where w3_total = w13 + w23

This seems complicated to solve directly.

Maybe there's a better way to approach this.

Let me consider that the maximum number of draws is achieved when as many points as possible are distributed through draws.

But, some points must come from wins, especially for the highest scorer.

In particular, for player 3, if p3 > p1 + p2, then some wins must have occurred for player 3.

Wait, in the seventh example, p3=10, p1=1, p2=1.

So, p3 = 10 > p1 + p2 = 2.

This suggests that player 3 must have won some games.

Specifically, p3 = 2*w3 + d3

Given that p3 = 10, and d3 ≤ p1 + p2 = 2 (since draws involve two players, and p1 and p2 have only 1 point each).

Wait, but p1 and p2 have only 1 point each, which could come from draws or losses.

Wait, p1 = d12 + d13 + 2*w13 =1

Similarly for p2: p2 = d12 + d23 + 2*w23 =1

p3 = d13 + d23 + 2*(w13 + w23)=10

Let me denote:

Let d13 be the number of draws between 1 and 3.

Let d23 be the number of draws between 2 and 3.

Let w13 be the number of wins of 3 against 1.

Let w23 be the number of wins of 3 against 2.

Then:

p1 = d12 + d13 + 2*w13 =1

p2 = d12 + d23 + 2*w23 =1

p3 = d13 + d23 + 2*(w13 + w23)=10

Let me try to solve these equations.

From p1: d12 + d13 + 2*w13 =1

From p2: d12 + d23 + 2*w23 =1

From p3: d13 + d23 + 2*(w13 + w23)=10

Let me denote s = d12 + d13 + d23 + w13 + w23

Total points: 2*s = p1 + p2 + p3 =12, so s=6

But s is also the total number of games: draws + wins.

So, s = d + w, where d is the number of draws (each draw is one game), and w is the number of wins (each win is one game).

So, d + w =6

Total points: 2*d + 2*w =12, which checks out.

Now, I need to maximize d, which means minimizing w.

But, given the constraints on p1, p2, p3.

Looking back at the equations:

From p1: d12 + d13 + 2*w13 =1

From p2: d12 + d23 + 2*w23 =1

From p3: d13 + d23 + 2*(w13 + w23)=10

Let me try to express variables in terms of others.

From p1: d12 =1 - d13 - 2*w13

From p2: d12 =1 - d23 - 2*w23

So, 1 - d13 - 2*w13 =1 - d23 - 2*w23

Simplify: -d13 -2*w13 = -d23 -2*w23

Which implies: d23 - d13 = 2*(w13 - w23)

Now, from p3: d13 + d23 + 2*(w13 + w23)=10

Let me denote x = w13 + w23

Then, d13 + d23 + 2*x =10

Also, d23 - d13 = 2*(w13 - w23)

Let me denote y = w13 - w23

Then, d23 - d13 = 2*y

So, d23 = d13 + 2*y

Substitute into p3 equation:

d13 + (d13 + 2*y) + 2*x =10

2*d13 + 2*y + 2*x =10

Divide by 2:

d13 + y + x =5

But x = w13 + w23

And y = w13 - w23

So, w13 = y + w23

Substitute into x:

x = (y + w23) + w23 = y + 2*w23

Now, d13 + y + x =5

Substitute x:

d13 + y + y + 2*w23 =5

d13 + 2*y + 2*w23 =5

But d23 = d13 + 2*y

So, d23 + 2*w23 =5

Now, from p1: d12 =1 - d13 - 2*w13

But w13 = y + w23

So, d12 =1 - d13 - 2*(y + w23)

Similarly, from p2: d12 =1 - d23 - 2*w23

Set them equal:

1 - d13 - 2*(y + w23) =1 - d23 - 2*w23

Simplify:

- d13 -2*y -2*w23 = - d23 -2*w23

Add d23 and 2*w23 to both sides:

d23 - d13 -2*y =0

But d23 = d13 + 2*y

So, (d13 + 2*y) - d13 -2*y =0

Which checks out.

Now, from d23 + 2*w23 =5

And d23 = d13 + 2*y

Also, d13 + y + x =5

Wait, but x = y + 2*w23

So, d13 + y + y + 2*w23 =5

d13 + 2*y + 2*w23 =5

But d23 = d13 + 2*y

And d23 + 2*w23 =5

So, d23 + 2*w23 =5

Which matches.

Now, to maximize d, which is the number of draws.

Each draw is a game where two players each get 1 point.

Each win is a game where one player gets 2 points and the other gets 0.

Total games: d + w =6

Total points: 2*d + 2*w =12

We need to maximize d, which is equivalent to minimizing w.

So, what's the minimal number of wins w needed to achieve the scores.

Looking at p3=10, and p1=1, p2=1

Player 3 has 10 points.

Each win for player 3 gives 2 points, and each draw involving player 3 gives 1 point.

So, p3 = 2*w3 + d3

Where w3 = w13 + w23

And d3 = d13 + d23

Given that p3=10, we have:

2*w3 + d3 =10

Also, from p1 and p2:

p1 = d12 + d13 + 2*w13 =1

p2 = d12 + d23 + 2*w23 =1

And from earlier, d3 = d13 + d23

So, 2*w3 + d3 =10

Also, d12 + d13 + d23 + w13 + w23 =6

Wait, total games is d + w =6

Where d = number of draws, which is d12 + d13 + d23

And w = number of wins, which is w13 + w23

So, d12 + d13 + d23 + w13 + w23 =6

Now, to minimize w, which is w13 + w23, we need to maximize d12 + d13 + d23

But we have constraints from p1 and p2.

From p1: d12 + d13 + 2*w13 =1

From p2: d12 + d23 + 2*w23 =1

We need to maximize d12 + d13 + d23, given these constraints.

Let me try to set w13 and w23 to their minimal possible values.

Since p1 = d12 + d13 + 2*w13 =1, and all variables are non-negative integers.

So, 2*w13 ≤1, hence w13 ≤0.5, but w13 is integer, so w13=0.

Similarly, from p2: d12 + d23 + 2*w23 =1, so w23=0.

Then, from p3: d13 + d23 + 2*(0 + 0)=10, so d13 + d23=10

But from p1: d12 + d13 =1

From p2: d12 + d23 =1

So, d12 + d13 =1

And d12 + d23 =1

And d13 + d23=10

But adding the first two equations:

(d12 + d13) + (d12 + d23) =1 +1 ⇒ 2*d12 + d13 + d23 =2

But d13 + d23=10, so 2*d12 +10=2 ⇒ 2*d12= -8 ⇒ d12= -4

Which is impossible, since d12 cannot be negative.

Therefore, w13 and w23 cannot both be zero.

So, I need to set w13 and/or w23 to at least one.

Let me try w13=1, w23=0.

Then, from p1: d12 + d13 + 2*1=1 ⇒ d12 + d13= -1

Which is impossible.

So, w13 cannot be 1 if w23=0.

Next, try w13=0, w23=1.

From p2: d12 + d23 + 2*1=1 ⇒ d12 + d23= -1

Again, impossible.

So, both w13 and w23 need to be at least 1.

Wait, no. Maybe one of them can be 0, but not both.

Let me try w13=1, w23=0.

From p1: d12 + d13 + 2*1=1 ⇒ d12 + d13= -1 → impossible.

w13=0, w23=1:

From p2: d12 + d23 + 2*1=1 ⇒ d12 + d23= -1 → impossible.

So, both w13 and w23 must be at least 1.

Try w13=1, w23=1.

From p1: d12 + d13 + 2*1=1 ⇒ d12 + d13= -1 → still impossible.

Wait, this can't work.

So, perhaps w13 and w23 need to be higher.

Try w13=0, w23=0.5, but w23 must be integer, so not possible.

Wait, w13 and w23 must be integers.

So, w13=0 or at least 1.

Wait, but w13=0 leads to impossibility.

Similarly, w23=0 leads to impossibility.

So, perhaps the minimal w13 + w23 is 4.

Let me assume w13 + w23=4.

Then, p3=2*4 + d3=8 + d3=10 ⇒ d3=2

So, d13 + d23=2

From p1: d12 + d13 + 2*w13=1

From p2: d12 + d23 + 2*w23=1

Let me set w13 + w23=4

Assume w13=a, w23=4-a

Then, from p1: d12 + d13 + 2*a=1 ⇒ d12 + d13=1 - 2*a

From p2: d12 + d23 + 2*(4 - a)=1 ⇒ d12 + d23=1 - 8 + 2*a ⇒ d12 + d23=2*a -7

Also, d13 + d23=2

Now, add the first two equations:

(d12 + d13) + (d12 + d23)= (1 - 2*a) + (2*a -7)=1 -7= -6

So, 2*d12 + d13 + d23= -6

But d13 + d23=2

So, 2*d12 +2= -6 ⇒ 2*d12= -8 ⇒ d12= -4

Again, impossible.

So, perhaps w13 + w23=5

Then, p3=2*5 + d3=10 + d3=10 ⇒ d3=0

So, d13 + d23=0 ⇒ d13=0, d23=0

From p1: d12 + 0 + 2*w13=1 ⇒ d12 + 2*w13=1

From p2: d12 + 0 + 2*w23=1 ⇒ d12 + 2*w23=1

From w13 + w23=5

Let me set w13=a, w23=5-a

Then, d12 + 2*a=1 ⇒ d12=1 - 2*a

Also, d12 + 2*(5 - a)=1 ⇒ d12 +10 - 2*a=1 ⇒ d12=1 -10 + 2*a=2*a -9

So, 1 - 2*a = 2*a -9 ⇒ 1 +9=2*a +2*a ⇒ 10=4*a ⇒ a=2.5

But a must be integer, so impossible.

So, perhaps w13 + w23=6

Then, p3=2*6 + d3=12 + d3=10 ⇒ d3= -2

Impossible.

So, no solution with integer values.

But according to the problem, it's possible to achieve p1=1, p2=1, p3=10 with d=2.

Wait, but according to my calculations, it's impossible.

Wait, perhaps I made a mistake.

Let me try to find a feasible solution.

Suppose w13=4, w23=1

Then, p3=2*(4+1)=8 + d3=10 ⇒ d3=2

So, d13 + d23=2

From p1: d12 + d13 + 2*4=1 ⇒ d12 + d13=1 -8= -7 → impossible.

Wait, again impossible.

Alternatively, w13=3, w23=2

Then, p3=2*(3+2)=10 + d3=10 ⇒ d3=0

So, d13 + d23=0 ⇒ d13=0, d23=0

From p1: d12 + 0 + 2*3=1 ⇒ d12 +0 +6=1 ⇒ d12= -5 → impossible.

Wait, still impossible.

Alternatively, w13=2, w23=3

Then, p3=2*(2+3)=10 + d3=10 ⇒ d3=0 ⇒ d13=0, d23=0

From p1: d12 +0 +4=1 ⇒ d12= -3 → impossible.

Wait, still impossible.

Alternatively, w13=1, w23=4

Then, p3=2*(1+4)=10 + d3=10 ⇒ d3=0 ⇒ d13=0, d23=0

From p1: d12 +0 +2=1 ⇒ d12= -1 → impossible.

Still impossible.

Alternatively, w13=0, w23=5

Then, p3=2*(0+5)=10 + d3=10 ⇒ d3=0 ⇒ d13=0, d23=0

From p1: d12 +0 +0=1 ⇒ d12=1

From p2: d12 +0 +10=1 ⇒1 +10=11≠1 → impossible.

Wait, p2: d12 + d23 + 2*w23=1 ⇒1 +0 +10=11≠1 → impossible.

So, no integer solution exists.

But according to the problem, the output is 2.

So, perhaps I'm missing something.

Wait, maybe some games were played multiple times between the same pair.

Wait, but in that case, points can accumulate.

Wait, perhaps p1 and p2 have their points coming from draws with player 3.

Let me try another approach.

Suppose player 1 and player 3 have one draw: p1=1, p3=1

Similarly, player 2 and player 3 have one draw: p2=1, p3=1

Then, player 3 has p3=2 from these two draws.

But player 3 needs p3=10, so player 3 needs additional 8 points.

These can come from wins against player 1 and player 2.

Each win gives 2 points.

So, player 3 needs 4 wins to get 8 points.

But in each win, player 3 gets 2 points, and the other player gets 0.

So, if player 3 has 4 wins, and 2 draws, total points: 2*4 + 2*1 =8 +2=10

Player 1: from one draw with player 3 (1 point), and 4 losses to player 3 (0 points each), and possibly some games with player 2.

Wait, but player 1 has p1=1.

From the draw with player 3, p1=1.

If player 1 has 4 losses to player 3, that's fine, p1 remains 1.

Similarly, player 2: from one draw with player 3 (1 point), and 4 losses to player 3 (0 points each).

So, p2=1.

This seems to satisfy all conditions.

Total draws: 2 (one between 1 and 3, one between 2 and 3)

Total wins: 4 (all by player 3)

Total games: 6, which matches s=6.

So, the maximum number of draws is 2.

This matches the output.

So, in this scenario, d=2, which is less than s//2=6.

Hence, the formula in the program seems correct.

Now, generalizing this, the formula is:

result = (v[0] + v[1] + v[2] - max(0, v[2] - v[0] - v[1])) // 2

In this case:

v[0]=1, v[1]=1, v[2]=10

max(0,10-1-1)=8

result=(1+1+10 -8)//2=(12-8)//2=4//2=2, which matches.

In the fourth example:

v[0]=1, v[1]=1, v[2]=2

max(0,2-1-1)=0

result=(1+1+2 -0)//2=4//2=2, which matches.

In the second example:

v[0]=0, v[1]=1, v[2]=1

max(0,1-0-1)=0

result=(0+1+1 -0)//2=2//2=1, which matches the output of 1.

Wait, but in the problem description, the second example has output 1, but according to the program, it's 1, but in the explanation, it's one draw between player 2 and 3.

Yes, that matches.

So, the formula seems consistent.

Now, to understand why this formula works.

Let me consider that the maximum number of draws is achieved when as many points as possible are distributed through draws.

But, the highest scorer, player 3, might need some wins to achieve their score, especially if p3 > p1 + p2.

In such cases, the excess points in p3 beyond p1 + p2 must come from wins.

So, the minimal number of wins is ceil((p3 - v[0] - v[1]) / 2)

But in the formula, it's max(0, v[2] - v[0] - v[1])

Then, the total points minus this excess gives the points that can come from draws.

Then, the number of draws is (s - excess) // 2

Wait, but in the seventh example, s=12, excess=8, result=(12-8)//2=2

Which matches.

In the fourth example, excess=0, result=2

Which matches.

In the second example, excess=0, result=1

Which matches.

So, it seems that the formula is:

result = (s - max(0, p3 - p1 - p2)) // 2

This ensures that the excess points in p3 that cannot come from draws are accounted for, and the remaining points are distributed through draws.

Hence, the program is correct.

**Final Solution**
To solve this problem, we need to determine the maximum number of draws that could have happened in a series of chess games among three friends, given their final scores. If the scores are inconsistent with any valid set of games, we should return -1.

## Approach

1. **Input Parsing**: Read the number of test cases and the scores for each test case.
2. **Validation**: Check if the sum of the scores is even. If it's odd, it's impossible to achieve those scores, so return -1.
3. **Calculate Maximum Draws**:
    - Compute the excess score of the highest scorer beyond the sum of the other two players' scores.
    - Subtract this excess from the total sum of scores to find the points that could be from draws.
    - Divide this result by 2 to get the maximum number of draws.

## Solution Code

```python
def main():
    import sys
    input = sys.stdin.read
    data = input().split()
    idx = 0
    t = int(data[idx])
    idx += 1
    for _ in range(t):
        v = [int(data[idx + i]) for i in range(3)]
        idx += 3
        if (v[0] + v[1] + v[2]) % 2 == 1:
            print('-1')
        else:
            excess = max(0, v[2] - v[0] - v[1])
            result = (v[0] + v[1] + v[2] - excess) // 2
            print(result)

if __name__ == "__main__":
    main()
```

## Explanation

- **Step-by-step breakdown**:
  1. Read the input data for the number of test cases.
  2. For each test case, read the three scores.
  3. Check if the sum of the scores is odd. If so, print -1 because it's impossible.
  4. If the sum is even, calculate the excess score of the highest player beyond the sum of the other two.
  5. Subtract this excess from the total sum and divide by 2 to get the maximum number of draws.
  
- **Key Insight**:
  - Each draw contributes 2 points to the total sum (1 point to each player).
  - Each win contributes 2 points to the total sum (2 to the winner and 0 to the loser).
  - The maximum number of draws is achieved by minimizing the number of wins needed to account for
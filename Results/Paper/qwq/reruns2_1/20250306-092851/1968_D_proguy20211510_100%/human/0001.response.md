Alright, I've got this problem to solve. Let's see what it's about. So, there's this game called "Permutation game" played by Bodya and Sasha. They have a permutation p of length n and an array a of length n. They play the game for k turns, and each has their starting positions in the permutation: Bodya starts at position p_b and Sasha at p_s.

In each turn, both players simultaneously:

1. Add the value of a[x] to their score, where x is their current position.

2. Choose to either stay at their current position or move to p[x].

The goal is to determine who wins the game after exactly k turns, assuming both players play optimally to maximize their scores.

Okay, so I need to process multiple test cases, each with different n, k, p_b, p_s, permutation p, and array a.

First, I need to understand the game mechanics thoroughly.

Each player starts at a specific position and in each turn, they can choose to stay or move to p[x]. They also add a[x] to their score based on their current position.

Since both make decisions simultaneously and independently, I need to model their decisions separately.

The challenge is that they play for k turns, and k can be up to 10^9, which suggests that I need an efficient way to compute their maximum possible scores without simulating each turn.

Given that p is a permutation, it forms cycles. This is important because if a player keeps moving according to p, they will eventually cycle.

I need to model the paths that each player can take.

Wait, but they can choose to stay or move each turn, so it's not just following the permutation path.

Hmm.

Let me think differently.

Each player has a choice each turn: stay or move.

If they stay, their position remains the same, and they add a[x] to their score.

If they move, they go to p[x] and add a[p[x]] to their score.

Wait, no.

No, the addition is always based on the current position before deciding to stay or move.

Wait, let's read the problem again carefully.

"In each turn, two things happen to each player:

- If the current position of the player is x, his score increases by a_x.

- Then the player either stays at his current position x or moves from x to p_x."

So, first, they add a_x to their score based on their current position, and then they choose to stay or move.

Okay, so in each turn, they add a_x and then decide to stay or move.

Given that, I need to model the sequence of positions each player can be in over k turns.

But since they make decisions simultaneously and independently, I can treat their paths separately.

So, for each player, I need to find the maximum possible score they can achieve in k turns.

Then, compare the two scores to determine the winner.

Now, the problem is to compute the maximum score for each player.

Given that n can be up to 2*10^5 and k up to 10^9, I need an efficient algorithm, probably O(n) per test case or better.

First, I need to model the game for one player.

Let's consider one player starting at position x.

In each turn:

1. Add a[x] to the score.

2. Choose to stay at x or move to p[x].

The goal is to maximize the score after k turns.

I need to find the sequence of positions that maximizes the sum of a[x] over k turns.

Now, since p is a permutation, it forms cycles.

If the player keeps moving, they will cycle through the permutation.

So, I need to consider the cycle structure.

But the player can choose to stay in a position in any turn.

This adds flexibility because they can choose to stay and repeat adding a[x] multiple times.

So, for each player, I need to consider all possible sequences of staying and moving.

This seems complex, but maybe there's a pattern or a way to optimize this.

Let me think about the possible paths.

If a player starts at x, in the first turn:

- Option 1: Stay at x, add a[x], and in the next turn, still at x.

- Option 2: Move to p[x], add a[p[x]], and in the next turn, can stay or move again.

So, it's like a tree where each node has two options: stay or move.

But with k up to 10^9, simulating this is impossible.

I need a smarter approach.

Let me consider that if a player chooses to stay at a position, they can accumulate a[x] multiple times.

If they choose to move, they follow the permutation path.

So, perhaps the optimal strategy is to stay at the position with the highest a[x] as much as possible.

But it's not that simple because moving to another position might allow access to higher a[p[x]].

Wait, but since they can choose to stay or move each turn independently, the best strategy is to stay at the position with the maximum a[x] possible in their cycle.

Wait, perhaps I need to find the cycle for each player and then decide where to stay.

Let me try to model this.

First, for a single player:

- Start at position x.

- Follow the permutation path until a cycle is detected.

- Once a cycle is detected, the path repeats.

So, I can find the path until a cycle is detected.

Then, within that cycle, the player can choose to stay at any position in the cycle or outside.

Wait, perhaps I need to consider the entire path, including the non-cycle part.

Let me try to formalize this.

For a player starting at x:

- Simulate moves until a position repeats, indicating a cycle.

- Letâ€™s say the path is x -> p[x] -> p[p[x]] -> ... -> y -> ... -> y -> ...

where y is the first repeated position.

So, the path consists of a non-cycle part x -> ... -> y, and then the cycle y -> ... -> y.

Now, in the non-cycle part, the player must pass through each position exactly once.

In the cycle, the player can choose to stay at any position in the cycle.

Wait, but actually, the player can choose to stay at any position in any turn.

So, it's not that they are forced to follow the cycle; they can choose to stay and repeat adding a[x].

So, perhaps I need to consider all possible positions they can be in, which are the positions in their path.

Wait, maybe I should consider that the player can choose to stay at any position in their path, and in each turn, they can decide to stay or move to the next position.

This seems similar to choosing points along a path, where the player can choose to stay and accumulate a[x], or move to the next position.

But with k turns, and potentially large k, I need a way to compute the maximum score efficiently.

Let me consider that for each player, their path is x -> p[x] -> p[p[x]] -> ... until a cycle is detected.

Then, in the cycle, the scores repeat periodically.

So, perhaps I can model the path as:

- A non-cycle prefix: x1, x2, ..., x_m

- A cycle of length c: y1, y2, ..., y_c

Then, the player can choose to stay at any position in the path for any number of turns.

This seems complicated.

Wait, perhaps I can think of it differently.

In each turn, the player can choose to stay at their current position and add a[x] again, or move to p[x] and add a[p[x]].

So, for each position, the player can choose to accumulate a[x] multiple times.

So, perhaps the optimal strategy is to find the position with the maximum a[x] in their accessible path and stay there for as many turns as possible.

But there's a catch: moving to another position might allow access to higher a[p[x]].

Wait, but since they can choose to stay or move each turn independently, perhaps the best strategy is to stay at the position with the highest a[x] in their entire path.

Wait, but they can only stay at their current position or move to p[x] in each turn.

So, they can't arbitrarily jump to any position; they need to reach it through moves.

This is getting confusing.

Let me think about an example.

Take the first example from the input:

n=4, k=2, p_b=3, p_s=2

p = [4,1,2,3]

a = [7,2,5,6]

Let's simulate for Bodya starting at 3:

Turn 1:

- Position: 3, add a[3]=5

- Choose to stay at 3 or move to p[3]=2

Option 1: Stay at 3

- Score: 5 + 5 = 10

- Position: 3

Option 2: Move to 2

- Position: 2, add a[2]=2

- Turn 2:

- Option 1: Stay at 2, add a[2]=2

- Total score: 5 + 2 + 2 = 9

- Option 2: Move to p[2]=1, add a[1]=7

- Total score: 5 + 2 + 7 = 14

Wait, but in the explanation, Bodya stays at 3 and gets 10, and Sasha moves to 1 and stays, getting 9.

So, Bodya wins with 10 vs 9.

But according to my simulation above, if Bodya moves to 2 and then to 1, they can get 14, which is higher.

Wait, maybe I misunderstood the moves.

Let me read the problem again.

"Then the player either stays at his current position x or moves to p_x."

So, in each turn, they add a[x], then choose to stay or move.

In the first turn:

- Bodya at 3, add a[3]=5, then choose to stay at 3 or move to p[3]=2.

- If stays at 3, next position is 3, add a[3]=5 again.

- If moves to 2, next position is 2, add a[2]=2.

In the second turn:

- If Bodya stayed at 3 in the first turn, position is 3, add a[3]=5.

- If Bodya moved to 2 in the first turn, position is 2, add a[2]=2.

So, the possible scores:

- Stay at 3 both turns: 5 + 5 = 10

- Move to 2 in first turn, stay at 2 in second turn: 5 + 2 + 2 = 9

- Move to 2 in first turn, move to 1 in second turn: 5 + 2 + 7 = 14

So, the maximum Bodya can achieve is 14.

But in the explanation, it says Bodya stays at 3 and gets 10, and Sasha moves to 1 and stays, getting 9.

Wait, perhaps in the explanation, Bodya chooses to stay at 3, getting 10, and Sasha moves to 1 and stays, getting 9, so Bodya wins with 10 vs 9.

But according to my simulation, Bodya can get 14 by moving to 2 and then to 1.

So, maybe the explanation is not showing the optimal strategy.

Wait, perhaps there's a constraint that they have to perform exactly k turns, and in each turn, they add a[x] and then choose to stay or move.

So, in the first turn:

- Add a[x], then choose to stay or move.

In the second turn:

- Add a[x], then choose to stay or move.

And so on.

So, in the first turn, Bodya at 3, add 5, then choose to stay at 3 or move to 2.

If Bodya chooses to stay at 3, then in the second turn, add a[3]=5 again.

If Bodya chooses to move to 2, then in the second turn, at position 2, add a[2]=2.

Alternatively, if Bodya moves to 2 in the first turn, and then moves to 1 in the second turn, total score is a[3] + a[2] + a[1] = 5 + 2 + 7 = 14.

So, the maximum Bodya can achieve is 14.

But in the explanation, it shows Bodya staying at 3 and getting 10, and Sasha moving to 1 and staying, getting 9.

So, perhaps in the explanation, they are not showing the optimal strategies.

Wait, maybe I'm misunderstanding the rules.

Wait, no. Let's see.

"In each turn, two things happen to each player:

- If the current position of the player is x, his score increases by a_x.

- Then the player either stays at his current position x or moves from x to p_x."

So, in each turn:

1. Add a_x to score.

2. Choose to stay or move.

So, in the first turn:

- Bodya at 3, add a[3]=5, then choose to stay at 3 or move to p[3]=2.

- If stays at 3, in the second turn, add a[3]=5 again.

- If moves to 2, in the second turn, at position 2, add a[2]=2.

So, possible scores:

- Stay at 3 both turns: 5 + 5 = 10

- Move to 2 in first turn, stay at 2 in second turn: 5 (first turn) + 2 (second turn) = 7

Wait, that's different from what I thought earlier.

Wait, no. Wait, when Bodya moves to 2 in the first turn, he adds a[3]=5 in the first turn, then moves to 2.

In the second turn, he is at 2, adds a[2]=2, then chooses to stay or move.

If he stays at 2, adds a[2]=2 again.

If he moves to p[2]=1, adds a[1]=7.

So, total scores:

- Stay at 3 both turns: 5 + 5 = 10

- Move to 2 in first turn, stay at 2 in second turn: 5 + 2 + 2 = 9

- Move to 2 in first turn, move to 1 in second turn: 5 + 2 + 7 = 14

Wait, so in the second turn, after moving to 2 in the first turn, he adds a[2]=2, then chooses to stay or move.

So, total score is a[3] + a[2] + a[2] = 5 + 2 + 2 = 9 if he stays at 2 in the second turn.

Or a[3] + a[2] + a[1] = 5 + 2 + 7 = 14 if he moves to 1 in the second turn.

So, the maximum is 14.

But in the explanation, it shows Bodya staying at 3 and getting 10, and Sasha moving to 1 and staying, getting 9.

So, perhaps in the explanation, they are not choosing the optimal strategies.

Wait, maybe I'm misunderstanding something.

Wait, perhaps the "then choose to stay or move" part is confusing.

Let me read the problem again.

"In each turn, two things happen to each player:

- If the current position of the player is x, his score increases by a_x.

- Then the player either stays at his current position x or moves from x to p_x."

So, in each turn:

1. Add a_x to the score.

2. Then choose to stay at x or move to p_x.

So, in the next turn, the player will be at their current position (if they stayed) or at p[x] (if they moved).

Wait, in my earlier simulation, I think I miscounted the scores.

Let's try again.

For Bodya starting at 3:

Turn 1:

- Position: 3

- Add a[3]=5

- Choose to stay at 3 or move to p[3]=2

Option 1: Stay at 3

- Position in turn 2: 3

- Add a[3]=5

- Total score: 5 + 5 = 10

Option 2: Move to 2

- Position in turn 2: 2

- Add a[2]=2

- Then, in turn 2:

- Option 1: Stay at 2

- Add a[2]=2

- Total score: 5 + 2 + 2 = 9

- Option 2: Move to p[2]=1

- Position in turn 2: 1

- Add a[1]=7

- Total score: 5 + 2 + 7 = 14

So, the maximum Bodya can achieve is 14.

But in the explanation, it shows Bodya staying at 3 and getting 10, and Sasha moving to 1 and staying, getting 9.

So, perhaps in the explanation, they are not choosing the optimal strategies.

Wait, maybe I'm missing something.

Wait, perhaps the problem is that they have to perform exactly k turns, and in each turn, they add a[x] and then choose to stay or move.

So, in k turns, they add a[x] k times, where x is their position at the beginning of each turn.

Wait, but in the simulation above, Bodya can get 14 by moving to 2 and then to 1.

But in the explanation, it shows Bodya staying at 3 and getting 10, and Sasha moving to 1 and staying, getting 9.

So, perhaps in the explanation, they are not choosing the optimal strategies.

Wait, maybe I need to see the constraints again.

Given that k can be up to 10^9, I need an efficient way to compute the maximum possible score for each player.

I need to find, for each player, the maximum possible sum of a[x] over k turns, where in each turn they can choose to stay or move.

Let me try to model this for one player.

For a single player starting at x:

Define dp[i][stay] as the maximum score after i turns, where stay is 1 if the player stays at the current position, 0 if moves.

But with k up to 10^9, this is not feasible.

I need a better approach.

Let me consider that the player can choose to stay at any position in their accessible path for any number of turns.

So, for each position in the path, the player can choose to stay there for some number of turns.

Given that, the total number of stays at each position must sum to k.

This seems like maximizing the sum of a[x] over k turns, choosing which positions to stay at.

But this is still too vague.

Let me consider that the player can choose to cycle through the positions or stay at any position.

Given that p is a permutation, it forms cycles.

So, the player will eventually enter a cycle.

Once in the cycle, they can choose to stay at any position in the cycle for any number of turns.

So, perhaps I need to find the maximum possible sum of a[x] over k turns, where x can be any position in the cycle or in the path to the cycle.

Wait, perhaps I need to consider the path to the cycle and then the cycle itself.

Letâ€™s formalize this.

For a player starting at x:

- Follow the permutation path until a cycle is detected.

- Letâ€™s say the path is x -> p[x] -> p[p[x]] -> ... -> y -> ... -> y -> ...

where y is the first repeated position.

So, the path consists of a non-cycle prefix: x1, x2, ..., x_m

And a cycle of length c: y1, y2, ..., y_c

Then, in k turns, the player can:

- Choose to stay at any position in the path for any number of turns.

- Once in the cycle, they can loop around the cycle as many times as they want.

So, to maximize the score, the player should:

- Choose to stay at the position with the highest a[x] as much as possible.

- If there are multiple positions with the same highest a[x], choose to stay at one of them.

So, the optimal strategy is:

- Find the position with the maximum a[x] in the entire path (including the cycle and the non-cycle part).

- Stay at that position for as many turns as possible.

- If k is less than or equal to the length of the path before entering the cycle, just sum a[x] along the path up to k turns.

- If k is larger, enter the cycle and stay at the position with the maximum a[x] in the cycle.

Wait, but the player can choose to stay at any position in any turn, not just in the cycle.

So, perhaps the best strategy is to go to the position with the maximum a[x] in the entire path and stay there for the remaining turns.

Let me test this idea with the first example.

n=4, k=2, p_b=3, p_s=2

p = [4,1,2,3]

a = [7,2,5,6]

For Bodya starting at 3:

Path: 3 -> 2 -> 1 -> 4 -> 3 -> ...

So, the cycle is 3 -> 2 -> 1 -> 4 -> 3

The a values along the path are:

Position: 3, a=5

Position: 2, a=2

Position: 1, a=7

Position: 4, a=6

So, the maximum a[x] in the cycle is 7 at position 1.

So, the optimal strategy is to go to position 1 and stay there for as many turns as possible.

In k=2 turns:

Turn 1:

- Start at 3, add a[3]=5

- Move to 2

Turn 2:

- At 2, add a[2]=2

- Move to 1

- Stay at 1, add a[1]=7

Total score: 5 + 2 + 7 = 14

Wait, but in the explanation, it shows Bodya staying at 3 and getting 10, and Sasha moving to 1 and staying, getting 9.

So, according to this, Bodya can get 14, which is higher than Sasha's 9.

But in the explanation, it says Bodya gets 10 and Sasha gets 9.

So, perhaps in the explanation, they are not choosing the optimal strategies.

Wait, maybe I need to see the exact rules again.

"In each turn, two things happen to each player:

- If the current position of the player is x, his score increases by a_x.

- Then the player either stays at his current position x or moves from x to p_x."

So, in each turn:

1. Add a_x to the score.

2. Choose to stay or move.

If stay, in the next turn, the position remains x.

If move, in the next turn, the position becomes p[x].

So, in k turns, the player can choose to stay or move at each turn, but the position for the next turn is determined by the choice in the current turn.

So, in the first turn:

- Bodya at 3, add a[3]=5, choose to stay at 3 or move to 2.

- If stays at 3, in the second turn, add a[3]=5 again.

- If moves to 2, in the second turn, at position 2, add a[2]=2.

- Then, choose to stay at 2 or move to p[2]=1.

So, in the second turn:

- If stayed at 2, add a[2]=2 again.

- If moved to 1, add a[1]=7.

So, total scores:

- Stay at 3 both turns: 5 + 5 = 10

- Move to 2 in first turn, stay at 2 in second turn: 5 + 2 + 2 = 9

- Move to 2 in first turn, move to 1 in second turn: 5 + 2 + 7 = 14

So, the maximum Bodya can achieve is 14.

But in the explanation, it shows Bodya staying at 3 and getting 10, and Sasha moving to 1 and staying, getting 9.

So, perhaps in the explanation, Bodya chose not to move to 1, which would have given a higher score.

Therefore, Bodya can indeed get 14, while Sasha can get 9, so Bodya wins.

But in the explanation, it says Bodya stays at 3 and gets 10, and Sasha moves to 1 and stays, getting 9.

So, perhaps in the explanation, they are not showing the optimal strategies.

Wait, maybe I need to consider that in the first turn, when Bodya moves to 2, he adds a[3]=5, then moves to 2.

In the second turn, at position 2, adds a[2]=2.

Then, chooses to stay at 2 or move to 1.

If he chooses to stay at 2, adds a[2]=2 again.

If he chooses to move to 1, adds a[1]=7.

So, total score:

- Stay at 2: 5 + 2 + 2 = 9

- Move to 1: 5 + 2 + 7 = 14

So, indeed, the maximum Bodya can achieve is 14.

But in the explanation, it shows Bodya staying at 3 and getting 10, which is suboptimal.

So, perhaps the explanation is incorrect, or I'm misunderstanding something.

Wait, maybe the problem is that once a player chooses to stay at a position, they remain there for all subsequent turns.

Wait, no, the problem says, in each turn, they can choose independently to stay or move.

So, they can choose differently in each turn.

Hence, Bodya can choose to move to 2 in the first turn, then move to 1 in the second turn, achieving 5 + 2 + 7 = 14.

Similarly, Sasha can choose to move to 1 in the first turn and stay at 1 in the second turn, achieving 2 + 7 + 7 = 16.

Wait, let's simulate Sasha's moves.

Sasha starts at 2.

Turn 1:

- Position: 2, add a[2]=2

- Choose to stay at 2 or move to p[2]=1

Option 1: Stay at 2

- Position in turn 2: 2

- Add a[2]=2

- Total score: 2 + 2 = 4

Option 2: Move to 1

- Position in turn 2: 1

- Add a[1]=7

- Then, choose to stay at 1 or move to p[1]=4

Option 1: Stay at 1

- Add a[1]=7

- Total score: 2 + 7 + 7 = 16

Option 2: Move to 4

- Position in turn 2: 4

- Add a[4]=6

- Then, choose to stay at 4 or move to p[4]=3

Option 1: Stay at 4

- Add a[4]=6

- Total score: 2 + 7 + 6 = 15

Option 2: Move to 3

- Position in turn 2: 3

- Add a[3]=5

- Total score: 2 + 7 + 5 = 14

So, Sasha's maximum possible score is 16.

But in the explanation, it shows Sasha moving to 1 and staying, getting 2 + 7 = 9.

Wait, that doesn't add up.

Wait, perhaps in the explanation, they are considering that in the first turn, Sasha moves to 1 and adds a[1]=7, then in the second turn, stays at 1 and adds a[1]=7 again, totaling 0 + 7 + 7 = 14.

Wait, but according to the rules, in the first turn:

- At position 2, add a[2]=2

- Choose to stay at 2 or move to p[2]=1

So, if Sasha chooses to move to 1 in the first turn, in the second turn:

- At position 1, add a[1]=7

- Choose to stay at 1 or move to p[1]=4

So, if Sasha chooses to stay at 1, total score: 2 (first turn) + 7 (second turn) = 9

Wait, why is that? Wait, no.

Wait, in the first turn:

- At position 2, add a[2]=2

- Choose to move to 1

In the second turn:

- At position 1, add a[1]=7

- Choose to stay at 1 or move to 4

Option 1: Stay at 1, add a[1]=7

- Total score: 2 + 7 + 7 = 16

Option 2: Move to 4, add a[4]=6

- Total score: 2 + 7 + 6 = 15

So, the maximum Sasha can achieve is 16.

But in the explanation, it shows Sasha moving to 1 and staying, getting 2 + 7 = 9.

Wait, that doesn't make sense.

Unless there's a mistake in the explanation.

Wait, perhaps the problem is that in each turn, the score increases by a[x] before choosing to stay or move.

So, in the first turn:

- At position 2, add a[2]=2

- Choose to stay at 2 or move to 1

In the second turn:

- If stayed at 2, add a[2]=2 again

- If moved to 1, add a[1]=7

So, total scores:

- Stay at 2 both turns: 2 + 2 + 2 = 6

- Move to 1 in first turn, stay at 1 in second turn: 2 + 7 + 7 = 16

- Move to 1 in first turn, move to 4 in second turn: 2 + 7 + 6 = 15

So, Sasha's maximum is 16.

But in the explanation, it shows Sasha moving to 1 and staying, getting 2 + 7 = 9.

Wait, that doesn't add up.

Unless in the explanation, they are considering that in the first turn, Sasha moves to 1 and adds a[1]=7, then in the second turn, stays at 1 and adds a[1]=7 again, totaling 7 + 7 = 14.

Wait, but according to the problem, in each turn:

- Add a[x], then choose to stay or move.

So, in the first turn:

- At position 2, add a[2]=2, then choose to stay at 2 or move to 1.

- If moves to 1, in the second turn:

- At position 1, add a[1]=7, then choose to stay at 1 or move to 4.

So, total scores:

- Stay at 2 both turns: 2 (first turn) + 2 (second turn) = 4

- Move to 1 in first turn, stay at 1 in second turn: 2 (first turn) + 7 (second turn) = 9

- Move to 1 in first turn, move to 4 in second turn: 2 (first turn) + 7 (second turn) = 9

Wait, now I'm getting different totals.

Wait, perhaps I'm miscounting.

Let's see:

- In the first turn:

- At position 2, add a[2]=2

- Choose to stay at 2 or move to 1

- If stay at 2:

- In second turn: at 2, add a[2]=2

- Total: 2 + 2 = 4

- If move to 1:

- In second turn: at 1, add a[1]=7

- Then, choose to stay at 1 or move to 4

- Option 1: Stay at 1, add a[1]=7

- Total: 2 + 7 + 7 = 16

- Option 2: Move to 4, add a[4]=6

- Total: 2 + 7 + 6 = 15

So, Sasha's maximum is 16.

But in the explanation, it shows Sasha moving to 1 and staying, getting 2 + 7 = 9.

Wait, that doesn't make sense.

Unless there's a mistake in the explanation.

Wait, perhaps the problem is that the initial position is considered as turn 0, and turns start from 1.

Wait, no, the problem says the game lasts k turns, and in each turn, add a[x], then choose to stay or move.

So, for k=2, there are two turns.

In the first turn:

- Add a[x], then choose to stay or move.

In the second turn:

- Add a[x], then choose to stay or move.

So, in k=2 turns, there are two additions of a[x].

But in the explanation, it shows Bodya adding a[3] twice, totaling 10, and Sasha adding a[1] and a[1], totaling 9.

Wait, perhaps in the explanation, they are considering that the first addition is in turn 1, and the second addition is in turn 2.

So, for Bodya:

- Turn 1: at 3, add a[3]=5, stay at 3

- Turn 2: at 3, add a[3]=5, stay at 3

- Total: 5 + 5 = 10

For Sasha:

- Turn 1: at 2, add a[2]=2, move to 1

- Turn 2: at 1, add a[1]=7, stay at 1

- Total: 2 + 7 = 9

But according to my earlier simulation, Sasha can do better by moving to 1 in the first turn and staying at 1 in the second turn, getting 2 + 7 + 7 = 16.

Wait, but according to the problem, in each turn, they add a[x], then choose to stay or move.

So, in Sasha's case:

- Turn 1: at 2, add a[2]=2, choose to move to 1

- Turn 2: at 1, add a[1]=7, choose to stay at 1

- Turn 3: at 1, add a[1]=7, choose to stay at 1

- ...

- After k=2 turns, total score is 2 + 7 + 7 = 16

Wait, but the problem says "the game lasts k turns", and in each turn, they add a[x] and choose to stay or move.

So, in k=2 turns, they add a[x] twice.

Wait, perhaps I'm miscounting the additions.

Wait, in each turn:

- Add a[x]

- Then choose to stay or move.

So, in k turns, they add a[x] k times.

So, in k=2, they add a[x] two times.

In the explanation, Bodya stays at 3 both turns, adding 5 + 5 = 10.

Sasha moves to 1 in the first turn and stays at 1 in the second turn, adding 2 + 7 = 9.

So, Bodya wins with 10 vs 9.

But according to my simulation, Sasha can add 2 + 7 = 9 or 2 + 7 + 7 = 16.

Wait, that would be k=3 turns, but k=2.

Wait, perhaps I'm misunderstanding the scoring.

Let me read the problem again.

"In each turn, two things happen to each player:

- If the current position of the player is x, his score increases by a_x.

- Then the player either stays at his current position x or moves from x to p_x."

So, in each turn:

1. Add a[x] to the score.

2. Choose to stay or move.

So, in k turns, each player adds a[x] exactly k times, where x is their position at the beginning of each turn.

So, for Sasha:

- Turn 1: at 2, add a[2]=2, choose to move to 1

- Turn 2: at 1, add a[1]=7, choose to stay at 1

- Total score: 2 + 7 = 9

Alternatively:

- Turn 1: at 2, add a[2]=2, choose to stay at 2

- Turn 2: at 2, add a[2]=2, choose to stay at 2

- Total score: 2 + 2 = 4

Alternatively:

- Turn 1: at 2, add a[2]=2, choose to move to 1

- Turn 2: at 1, add a[1]=7, choose to move to 4

- Total score: 2 + 7 + 6 = 15

Wait, but in k=2 turns, they only add a[x] twice.

Wait, no.

Wait, in k=2 turns:

- Turn 1: add a[x], then choose to stay or move.

- Turn 2: add a[x], then choose to stay or move.

So, total additions: k times.

So, in k=2, total additions: twice.

Hence, Sasha's maximum is 2 + 7 = 9.

But earlier I thought that if Sasha moves to 1 and stays, it's 2 (first turn) + 7 (second turn) = 9.

If Sasha moves to 1 and then moves to 4, it's 2 + 7 + 6, but that's three additions, which is k=3, but k=2.

Wait, no, in k=2 turns:

- Turn 1: add a[2]=2, move to 1

- Turn 2: add a[1]=7, stay at 1

- Total: 2 + 7 = 9

Alternatively:

- Turn 1: add a[2]=2, move to 1

- Turn 2: add a[1]=7, move to 4

- Total: 2 + 7 = 9

Alternatively:

- Turn 1: add a[2]=2, stay at 2

- Turn 2: add a[2]=2, stay at 2

- Total: 2 + 2 = 4

So, Sasha's maximum is 9.

Similarly, Bodya can:

- Stay at 3 both turns: 5 + 5 = 10

- Move to 2 in first turn, stay at 2 in second turn: 5 + 2 + 2 = 9

- Move to 2 in first turn, move to 1 in second turn: 5 + 2 + 7 = 14

Wait, but in k=2 turns, they add a[x] k times.

So, in k=2, Bodya can add a[3] + a[2] + a[1] = 5 + 2 + 7 = 14

Wait, but that would be k=3 turns.

Wait, no, in k=2 turns:

- Turn 1: add a[3]=5, move to 2

- Turn 2: add a[2]=2, move to 1

- Total: 5 + 2 = 7

Wait, but according to my earlier simulation, I thought it was 5 + 2 + 7 = 14.

Wait, perhaps I'm miscounting.

Let me simulate step by step.

Bodya starts at 3.

Turn 1:

- At 3, add a[3]=5

- Choose to stay at 3 or move to p[3]=2

Option 1: Stay at 3

- Position in turn 2: 3

- Add a[3]=5

- Total: 5 + 5 = 10

Option 2: Move to 2

- Position in turn 2: 2

- Add a[2]=2

- Then, choose to stay at 2 or move to p[2]=1

Option 2a: Stay at 2

- Add a[2]=2

- Total: 5 + 2 + 2 = 9

Option 2b: Move to 1

- Position in turn 2: 1

- Add a[1]=7

- Total: 5 + 2 + 7 = 14

Wait, but in k=2 turns, they only add a[x] twice.

So, in option 2b, it's only two turns:

- Turn 1: add a[3]=5, move to 2

- Turn 2: add a[2]=2, move to 1

- Total: 5 + 2 = 7

Wait, so the addition is only twice: a[3] and a[2].

Wait, no, in k turns, they add a[x] k times, but in each turn, they choose to stay or move after adding a[x].

So, in k=2 turns:

- Turn 1: add a[x], then choose to stay or move.

- Turn 2: add a[x], then choose to stay or move.

So, total additions: a[x] k times.

In the simulation above, Bodya adds a[3] in turn 1 and a[2] in turn 2, totaling 5 + 2 = 7.

If Bodya stays at 3 both turns: a[3] + a[3] = 5 + 5 = 10

If Bodya moves to 2 in first turn and stays at 2 in second turn: a[3] + a[2] = 5 + 2 = 7

If Bodya moves to 2 in first turn and moves to 1 in second turn: a[3] + a[2] = 5 + 2 = 7

Wait, so the maximum Bodya can achieve is 10, by staying at 3 both turns.

Wait, but earlier I thought that moving to 1 would give 14, but that would require k=3 turns.

Wait, perhaps I miscounted.

Let me try again.

In k=2 turns:

Option 1: Stay at 3 both turns.

- Turn 1: add a[3]=5, stay at 3

- Turn 2: add a[3]=5, stay at 3

- Total: 5 + 5 = 10

Option 2
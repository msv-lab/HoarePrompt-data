Alright, I have this problem to solve. Let's see what it's about.

So, there's this thing called a "progressive square" which is an n x n matrix. The way it's constructed is based on three integers: a_{1,1}, c, and d. The rules for constructing this square are:

- The first element a_{1,1} is given.

- Each subsequent element in the first row is obtained by adding c to the previous element.

- Each element in the first column is obtained by adding d to the element above it.

- The rest of the elements are determined by the sum of the element to the left and the element above it, minus the element diagonally above and to the left.

Wait, actually, the problem doesn't specify the exact rules for filling the matrix, but from the example, it seems like the first row is generated by starting with a_{1,1} and adding c repeatedly, and the first column is generated by starting with a_{1,1} and adding d repeatedly. Then, the rest of the elements are filled based on some relationship, but it's not clearly defined in the problem statement provided here.

Looking back at the problem, it says: "the progressive square according to the following rules:", but no rules are provided in the prompt. Hmm, that's confusing. Maybe I need to infer the rules from the example given.

Given n=3, a_{1,1}=1, c=2, d=3, the square looks like this:

Let's assume the square is:

Row 1: 1, 3, 5

Row 2: 4, 6, 8

Row 3: 7, 9, 11

Wait, but in the problem, for n=3, a_{1,1}=1, c=2, d=3, the array is: 3,9,6,5,7,1,10,4,8

Wait, that doesn't match my assumption. Let me check again.

Wait, perhaps I need to understand how the progressive square is constructed.

Looking back, it says: "Maxim chooses three integers a_{1,1}, c, and d and constructs a progressive square according to the following rules:"

Since the rules aren't provided, perhaps I need to infer them from the example.

Given n=3, a_{1,1}=1, c=2, d=3, and the array is 3,9,6,5,7,1,10,4,8.

Wait, perhaps the square is filled in row-major order or column-major order.

Let me try to see.

If a_{1,1}=1, and c=2, then the first row could be 1, 1+2=3, 3+2=5.

Then, the first column could be 1, 1+3=4, 4+3=7.

Then, the rest of the elements are determined by some rule.

So, position (1,1)=1, (1,2)=3, (1,3)=5

Position (2,1)=4, (2,2)= ?, (2,3)= ?

Position (3,1)=7, (3,2)= ?, (3,3)= ?

Perhaps the rule is that each element is the sum of the element above and the element to the left, minus the element diagonally above and to the left.

So, for (2,2): 3 (left) + 4 (above) - 1 (diagonal above-left) = 6

Similarly, (2,3): 5 (left) + 6 (above) - 3 (diagonal) = 8

(3,2): 4 (left) + 7 (above) - 1 (diagonal) = 10

(3,3): 5 (left) + 10 (above) - 3 (diagonal) = 12

But in the example array, it's 3,9,6,5,7,1,10,4,8.

Wait, perhaps my assumption is wrong.

Wait, maybe the first row is a_{1,1}, a_{1,1}+c, a_{1,1}+2c, ..., up to n elements.

First column is a_{1,1}, a_{1,1}+d, a_{1,1}+2d, ..., up to n elements.

And the rest are determined by some formula.

But according to the example, for n=3, a_{1,1}=1, c=2, d=3, the array is 3,9,6,5,7,1,10,4,8.

Wait, perhaps the first row is a_{1,1}+c, a_{1,1}+2c, a_{1,1}+3c, etc.

Wait, in the example, the first row is 3,9,6.

Wait, that doesn't seem to fit.

Wait, maybe the first row is a_{1,1}, a_{1,1}+c, a_{1,1}+c+d, ..., but it's not clear.

This is confusing. Maybe I need to look at the problem differently.

The problem says: "It can be shown that for any values of n, a_{1,1}, c, and d, there exists exactly one progressive square that satisfies all the rules."

So, for given n, a_{1,1}, c, and d, there is exactly one possible square.

But in the input, we are given n, c, d, and an array of n^2 elements, and we need to check if this array contains the elements of the progressive square for the given n, c, and d.

Wait, but in the input, a_{1,1} is not provided. Only n, c, d, and the array.

Wait, in the problem statement, it says: "Maxim chooses three integers a_{1,1}, c, and d and constructs a progressive square according to the following rules:"

But in the input, only n, c, d, and the array are provided.

Wait, actually, looking back, in the problem statement, it says: "Recently, he found an array b of n^2 integers in random order and wants to make sure that these elements are the elements of that specific square."

Wait, but which specific square? It mentions that he remembered n, c, and d, but not a_{1,1}.

Wait, in the first line of the problem, it says: "Maxim chooses three integers a_{1,1}, c, and d and constructs a progressive square according to the following rules:"

But in the input, only n, c, d, and the array are provided.

Wait, perhaps a_{1,1} is not provided explicitly, but it can be derived from the array and the values of c and d.

Wait, but in the example, for n=3, c=2, d=3, and the array is 3,9,6,5,7,1,10,4,8, and the output is "NO".

In another test case, with the same n, c, d, and array 3,9,6,5,7,1,11,4,8, the output is "YES".

Wait, so there must be a specific way to arrange the elements based on a_{1,1}, c, and d.

I think the approach should be:

1. Given n, c, d, and the array, we need to determine if the array contains the elements of the progressive square for some a_{1,1}.

2. Since a_{1,1} is not provided, we need to find if there exists an a_{1,1} such that the progressive square constructed with that a_{1,1}, c, and d contains exactly the elements in the array.

3. The progressive square is uniquely determined by a_{1,1}, c, and d.

4. So, we need to find a_{1,1} such that the sorted elements of the progressive square match the sorted array.

Wait, but the array is in random order, so sorting both the array and the progressive square and comparing them should suffice.

Wait, but in the example, for n=3, c=2, d=3, and array 3,9,6,5,7,1,10,4,8, the output is "NO", whereas for the same n, c, d, and array 3,9,6,5,7,1,11,4,8, the output is "YES".

So, perhaps there's a mistake in my assumption.

Wait, maybe I need to understand how the progressive square is constructed.

Let's try to reconstruct the progressive square for n=3, c=2, d=3, and see what elements it should contain.

Assume a_{1,1} is some value, say x.

Then, the first row would be:

x, x+c, x+2c -> x, x+2, x+4

The first column would be:

x, x+d, x+2d -> x, x+3, x+6

Then, the rest of the elements are determined by the sum of the element above and the element to the left minus the element diagonally above and to the left.

So, for position (2,2):

element above: x+3

element to the left: x+2

element diagonally above and to the left: x

So, (x+3) + (x+2) - x = x+5

Similarly, (2,3):

element above: x+5

element to the left: x+4

element diagonally above and to the left: x+2

So, (x+5) + (x+4) - (x+2) = x+7

(3,2):

element above: x+6

element to the left: x+2

element diagonally above and to the left: x

So, (x+6) + (x+2) - x = x+8

(3,3):

element above: x+8

element to the left: x+4

element diagonally above and to the left: x+2

So, (x+8) + (x+4) - (x+2) = x+10

So, the entire square is:

x, x+2, x+4

x+3, x+5, x+7

x+6, x+8, x+10

So, the elements are: x, x+2, x+3, x+4, x+5, x+6, x+7, x+8, x+10

Now, looking at the first test case: n=3, c=2, d=3, array=3,9,6,5,7,1,10,4,8

If we sort the array: 1,3,4,5,6,7,8,9,10

And the elements of the square are: x, x+2, x+3, x+4, x+5, x+6, x+7, x+8, x+10

So, if we set x=1, then the elements would be:1,3,4,5,6,7,8,9,10

Which matches the sorted array.

But the output is "NO", which contradicts my assumption.

Wait, perhaps I made a mistake in constructing the square.

Wait, in my earlier calculation, for n=3, c=2, d=3, and a_{1,1}=x, the square is:

Row 1: x, x+2, x+4

Row 2: x+3, x+5, x+7

Row 3: x+6, x+8, x+10

So, elements: x, x+2, x+3, x+4, x+5, x+6, x+7, x+8, x+10

If x=1, elements are:1,3,4,5,6,7,8,9,10

And the sorted array is:1,3,4,5,6,7,8,9,10

They match, but the output is "NO".

Wait, perhaps there's a mistake in my understanding.

Looking back at the problem, in the first test case, the array is 3,9,6,5,7,1,10,4,8, which sorts to 1,3,4,5,6,7,8,9,10.

With x=1, the elements are 1,3,4,5,6,7,8,9,10, which matches.

But the output is "NO", so maybe there's another condition I'm missing.

Wait, perhaps the elements must be unique, or maybe there's a constraint on c and d.

Wait, in the second test case, n=3, c=2, d=3, array=3,9,6,5,7,1,11,4,8, which sorts to1,3,4,5,6,7,8,9,11

According to my earlier calculation, with x=1, elements are1,3,4,5,6,7,8,9,10

But in this test case, it's1,3,4,5,6,7,8,9,11, which differs in the last element: 11 instead of 10.

But the output is "YES", which suggests that x could be different.

Wait, if x=1, then the elements should be1,3,4,5,6,7,8,9,10

But in the array, it's1,3,4,5,6,7,8,9,11, which has 11 instead of 10.

So, unless x is different.

Let me solve for x.

The elements are:x, x+2, x+3, x+4, x+5, x+6, x+7, x+8, x+10

In the sorted array:1,3,4,5,6,7,8,9,11

So, x=1, x+2=3, x+3=4, x+4=5, x+5=6, x+6=7, x+7=8, x+8=9, x+10=11

So, x+10=11 => x=1, which matches the earlier elements.

But according to the problem, the output is "YES", but according to my earlier logic, it should be "NO" because x+10=11 implies x=1, but x+6=7, which matches, but x+10 should be 11, which it is.

Wait, maybe I need to think differently.

Wait, perhaps the elements are not uniquely determined by x, c, and d, but perhaps there's a different way to construct the square.

Alternatively, maybe the progressive square is constructed differently.

Let me see the third test case: n=2, c=100, d=100, array=400,300,400,500

Sorted array:300,400,400,500

Construct the square with x,a_{1,1}=x, c=100, d=100.

First row: x, x+100

First column: x, x+100

Then, (2,2): x+100 + x+100 - x = x+100

So, the square is:

x, x+100

x+100, x+100

Elements: x, x+100, x+100, x+100

So, sorted elements: x, x+100, x+100, x+100

Compare to the sorted array:300,400,400,500

So, if x=300, then elements are300,400,400,400

Which matches the array300,400,400,500 only if x=300, but 500 doesn't match 400.

Wait, but the output is "YES", which suggests that it should match.

Wait, perhaps my construction of the square is wrong.

Wait, in the earlier assumption, I had (2,2) = x+100, but maybe it's different.

Wait, according to the earlier rule: (2,2) = (element above) + (element to the left) - (element diagonally above and to the left)

So, (2,2) = (x+100) + (x+100) - x = x+100

So, the square is:

x, x+100

x+100, x+100

So, elements: x, x+100, x+100, x+100

Sorted: x, x+100, x+100, x+100

But the array is300,400,400,500

If x=300, then elements are300,400,400,400

But the array has300,400,400,500

Which doesn't match, but the output is "YES". So, perhaps my construction is wrong.

Wait, maybe the construction is different.

Alternatively, perhaps the progressive square is constructed by filling the first row with a_{1,1}, a_{1,1}+c, a_{1,1}+2c, ..., up to n elements.

First column with a_{1,1}, a_{1,1}+d, a_{1,1}+2d, ..., up to n elements.

And the rest of the elements are determined by adding c to the left element and d to the above element, but subtracting a_{1,1}.

Wait, perhaps I need to find a different way to construct the square.

Alternatively, perhaps the elements are generated by a formula a_{i,j} = a_{1,1} + (i-1)*d + (j-1)*c

Wait, that seems plausible.

Let me check with n=3, c=2, d=3, a_{1,1}=1

a_{1,1}=1

a_{1,2}=1+1*2=3

a_{1,3}=1+2*2=5

a_{2,1}=1+1*3=4

a_{2,2}=1+1*3+1*2=6

a_{2,3}=1+1*3+2*2=7

a_{3,1}=1+2*3=7

a_{3,2}=1+2*3+1*2=9

a_{3,3}=1+2*3+2*2=11

So, the square is:

1,3,5

4,6,7

7,9,11

Elements:1,3,4,5,6,7,7,9,11

Wait, but in the second test case, the array is3,9,6,5,7,1,11,4,8, which sorts to1,3,4,5,6,7,8,9,11

Comparing to the elements1,3,4,5,6,7,7,9,11, there's an extra 7 in the square, but the array has an 8 instead.

But according to the problem, the output is "YES", which contradicts this.

Wait, perhaps my formula is wrong.

Wait, in the earlier calculation, a_{2,3}=1+1*3+2*2=7, but according to the initial assumption, it should be x+7, but x=1, so 8.

Wait, perhaps I miscalculated.

Wait, no, 1 + 3 + 4 = 8, but earlier I thought it was 7.

Wait, perhaps I need to re-examine the construction.

If a_{i,j} = a_{1,1} + (i-1)*d + (j-1)*c

Then for n=3, c=2, d=3, a_{1,1}=1:

a_{1,1}=1

a_{1,2}=1+1*2=3

a_{1,3}=1+2*2=5

a_{2,1}=1+1*3=4

a_{2,2}=1+1*3+1*2=5+3=8

a_{2,3}=1+1*3+2*2=7

Wait, that's inconsistent with earlier calculation.

Wait, 1 + 3 + 4 = 8 for a_{2,3}, but earlier I thought it was 7.

Wait, perhaps I need to clarify.

If a_{i,j} = a_{1,1} + (i-1)*d + (j-1)*c

Then for i=2, j=3:

a_{2,3} = 1 + 1*3 + 2*2 = 1 + 3 + 4 = 8

Similarly, a_{3,3} = 1 + 2*3 + 2*2 = 1 + 6 + 4 = 11

So, the square is:

1,3,5

4,7,8

7,10,11

Wait, but earlier I thought a_{2,2}=7, a_{2,3}=8, a_{3,2}=10, a_{3,3}=11

So, elements are:1,3,4,5,7,7,8,10,11

But in the second test case, the array is1,3,4,5,6,7,8,9,11

Which doesn't match, but the output is "YES".

Wait, perhaps my formula is incorrect.

Alternatively, maybe the progressive square is constructed differently.

Wait, perhaps a_{i,j} = a_{1,1} + (i-1)*d + (j-1)*c + some other term.

Alternatively, perhaps there's a mistake in the problem understanding.

Wait, maybe the progressive square is constructed by filling the first row with a_{1,1}, a_{1,1} + c, a_{1,1} + c + d, and so on.

Wait, but that doesn't align with the example.

This is getting too confusing. Maybe I should look at the provided program and see how it approaches the problem.

Looking at the provided program:

t = int(input())

for _ in range(t):

(n, c, d) = map(int, input().split())

l = list(map(int, input().split()))

print(func_1(n, c, d, l))

def func_1(n, c, d, l):

a = min(l)

li = []

for k in range(0, n):

for h in range(0, n):

li.append(a + k * c + d * h)

li.sort()

l.sort()

if l == li:

return 'yes'

return 'no'

So, the function func_1 does the following:

1. Finds the minimum value in the array l and assigns it to a (which seems to correspond to a_{1,1}).

2. Creates a list li by computing a + k*c + d*h for k from 0 to n-1 and h from 0 to n-1.

3. Sorts both li and l.

4. Checks if the sorted lists are equal and returns 'yes' or 'no' accordingly.

Now, comparing this with my earlier thoughts:

- Assuming a_{1,1} is the minimum value in the array.

- Generating the progressive square elements as a + k*c + d*h for row k and column h.

- Sorting both the generated list and the input array and comparing them.

But in my earlier calculation, for n=3, c=2, d=3, a_{1,1}=1, the elements would be:

For k=0, h=0: 1 + 0*2 + 0*3 = 1

k=0, h=1: 1 + 0*2 + 1*3 = 4

k=0, h=2: 1 + 0*2 + 2*3 = 7

k=1, h=0: 1 + 1*2 + 0*3 = 3

k=1, h=1: 1 + 1*2 + 1*3 = 6

k=1, h=2: 1 + 1*2 + 2*3 = 9

k=2, h=0: 1 + 2*2 + 0*3 = 5

k=
Alright, I have this problem to solve. Let's see what it's asking for. So, there are two firework installations, each launching fireworks at regular intervals: the first every 'a' minutes and the second every 'b' minutes. Each firework remains visible in the sky for 'm + 1' minutes after launch, meaning it's visible from time x to x + m inclusive, where x is the launch time.

The task is to find the maximum number of fireworks that can be seen in the sky at the same time.

First, I need to understand how the fireworks from both installations interact over time. Since both installations start at the same time, their launch times will be multiples of 'a' and 'b' respectively.

For the first installation, the launch times are a, 2a, 3a, and so on.

For the second installation, the launch times are b, 2b, 3b, and so on.

Each firework is visible for m + 1 minutes, from its launch time x to x + m inclusive.

I need to find a time when the maximum number of fireworks are visible simultaneously.

Let me think about how to approach this.

One way is to consider the visibility periods of all fireworks and find the time when the most of these periods overlap.

But with potentially large values of a, b, and m (up to 10^18), I need an efficient way to calculate this without simulating every possible time.

I should look for a mathematical way to find the maximum overlap.

Let's consider the visibility periods for each installation separately first.

For the first installation, a firework launched at time ka (where k is a positive integer) is visible from ka to ka + m.

Similarly, for the second installation, a firework launched at time lb (where l is a positive integer) is visible from lb to lb + m.

I need to find a time t where the number of intervals [ka, ka + m] and [lb, lb + m] that contain t is maximized.

This seems like a classic problem of finding maximum overlaps of intervals.

But given the potentially huge values of a, b, and m, I need a smart way to compute this without iterating through all possible times.

Maybe I can think in terms of events: for each launch time, there's an event when a firework becomes visible and another when it becomes invisible.

Then, I can sort these events and keep a running count of visible fireworks.

But again, with large a, b, and m, generating all events is not feasible.

I need a smarter approach.

Let's consider the possible number of visible fireworks from each installation at any time.

For the first installation, the number of visible fireworks at time t is the number of k such that ka ≤ t ≤ ka + m, which is equivalent to t - m ≤ ka ≤ t.

Similarly, for the second installation, it's the number of l such that lb ≤ t ≤ lb + m, or t - m ≤ lb ≤ t.

So, for each installation, the number of visible fireworks at time t is the number of multiples of a and b, respectively, in the interval [t - m, t].

Therefore, the total number of visible fireworks at time t is the sum of these two counts.

I need to maximize this sum over all possible t.

But since t can be any real number, I need to think in terms of integer minutes, assuming that time is measured in whole minutes.

So t takes integer values starting from 0.

Wait, but launches happen at integer multiples of a and b, so t should be considered at integer points.

Wait, actually, t can be any real number, but for simplicity, we can consider t at integer minutes.

But given that a and b are integers, and m is an integer, it's likely that the maximum overlap occurs at integer times.

So, I'll consider t as integer minutes.

Now, for each installation, the number of visible fireworks at time t is floor((t)/a) - floor((t - m - 1)/a), which gives the count of multiples of a in [t - m, t].

Similarly for b.

Wait, actually, floor(t/a) gives the largest k such that ka ≤ t.

Floor((t - m)/a) gives the largest k such that ka ≤ t - m.

So, the number of visible fireworks from the first installation at time t is floor(t/a) - floor((t - m - 1)/a).

Similarly for the second installation.

Wait, but I need to be careful with the boundaries.

Alternatively, since m can be up to 10^18, and a and b can be up to 10^18, I need an efficient way to compute this.

But considering that t can be very large, I need a better approach.

Wait, perhaps I can find the time t that maximizes the sum of visible fireworks from both installations.

To maximize the sum, I need to maximize the number of visible fireworks from each installation.

But since the visibility periods are [ka, ka + m] and [lb, lb + m], I need to find t where these intervals overlap the most.

One way to maximize the sum is to find t where the number of intervals from both installations that contain t is maximized.

This seems tricky with large a, b, and m.

Maybe I can consider the least common multiple (LCM) of a and b to find when both installations launch fireworks at the same time.

But I'm not sure.

Let me consider some examples to get an intuition.

Take the first example from the problem:

a = 6, b = 7, m = 4

So, fireworks from the first installation are visible every 6 minutes for 5 minutes (since m + 1 = 5).

Similarly, second installation every 7 minutes for 5 minutes.

At t = 7:

- First installation: firework launched at t = 6 is visible from 6 to 10.

- Second installation: firework launched at t = 7 is visible from 7 to 11.

At t = 7, both fireworks are visible.

Before t = 6, no fireworks are visible.

At t = 6, first firework becomes visible.

At t = 7, second firework becomes visible.

So, at t = 7, two fireworks are visible.

The problem states that the maximum is 2.

Another example:

a = 3, b = 4, m = 10

At t = 12:

- First installation: firework at t = 3 (visible 3-13), t = 6 (6-16), t = 9 (9-19), t = 12 (12-22)

- Second installation: firework at t = 4 (4-14), t = 8 (8-18), t = 12 (12-22)

At t = 12:

- From first: t = 3,6,9,12 are visible at t=12

- From second: t=4,8,12 are visible at t=12

So, total visible fireworks at t=12: 4 (from first) + 3 (from second) = 7 fireworks.

But according to the problem's output, it's 7.

Another example:

a = 7, b = 8, m = 56

At t = 112:

- First installation: firework at t = 56 (56-112), t = 63 (63-119), ..., t = 112 (112-168)

- Second installation: firework at t = 56 (56-112), t = 64 (64-120), ..., t = 112 (112-168)

Need to count how many of these intervals contain t = 112.

For first installation: firework launched at t = k*7, where k*7 ≤ t ≤ k*7 + 56.

So, k*7 ≤ 112 ≤ k*7 + 56 ⇒ k*7 ≤ 112 and 112 ≤ k*7 + 56

From k*7 ≤ 112 ⇒ k ≤ 112/7 = 16

From 112 ≤ k*7 + 56 ⇒ 112 - 56 ≤ k*7 ⇒ 56 ≤ k*7 ⇒ k ≥ 56/7 = 8

So, k from 8 to 16 inclusive: 16 - 8 + 1 = 9 fireworks from first installation visible at t=112.

Similarly for second installation: k*8 ≤ 112 ≤ k*8 + 56

k*8 ≤ 112 ⇒ k ≤ 14

112 ≤ k*8 + 56 ⇒ 112 - 56 ≤ k*8 ⇒ 56 ≤ k*8 ⇒ k ≥ 7

So, k from 7 to 14 inclusive: 14 - 7 + 1 = 8 fireworks from second installation visible at t=112.

Total: 9 + 8 = 17, which matches the sample output.

So, in general, for any t, the number of visible fireworks from first installation is floor(t/a) - floor((t - m - 1)/a)

Similarly for second installation: floor(t/b) - floor((t - m - 1)/b)

Then, the total visible fireworks at t is sum of these two.

To maximize this sum, I need to find t where this sum is maximum.

But with large a, b, and m, I need an efficient way to compute this.

Let me see if there's a mathematical formula to compute this without iterating over t.

Looking back at the calculations for t=112:

For first installation: number of k such that k*a ≤ t ≤ k*a + m

Which is equivalent to (t - m)/a ≤ k < t/a

Since k is integer, the number of k is floor(t/a) - ceil((t - m - 1)/a)

But in programming, floor division can be used carefully.

Similarly for second installation.

But with large numbers, I need to compute this efficiently.

Wait, perhaps I can compute the number of visible fireworks from each installation separately and just sum them up.

Since the installations operate independently, the maximum sum would be when t is such that both installations have their maximum visible fireworks.

But I need to confirm if this is always the case.

In the first example, a=6, b=7, m=4.

For first installation:

Number of visible fireworks at t is floor(t/6) - floor((t - 5)/6)

Similarly for second installation: floor(t/7) - floor((t - 5)/7)

At t=7:

First: floor(7/6)=1, floor(2/6)=0 → 1

Second: floor(7/7)=1, floor(2/7)=0 → 1

Total: 2, which matches the sample.

In the second example, a=3, b=4, m=10.

At t=12:

First: floor(12/3)=4, floor((12-11)/3)=floor(1/3)=0 → 4

Second: floor(12/4)=3, floor((12-11)/4)=floor(1/4)=0 → 3

Total: 7, which matches the sample.

In the third example, a=7, b=8, m=56.

At t=112:

First: floor(112/7)=16, floor((112-57)/7)=floor(55/7)=7 → 16 - 7 = 9

Second: floor(112/8)=14, floor((112-57)/8)=floor(55/8)=6 → 14 - 6 = 8

Total: 17, which matches the sample.

So, it seems that the formula is:

number_of_fireworks = (floor(t/a) - floor((t - m - 1)/a)) + (floor(t/b) - floor((t - m - 1)/b))

And to maximize this, I need to choose t such that this sum is maximized.

But with a, b, and m up to 10^18, I need to find a way to compute this efficiently.

Looking at the formula, it seems that the maximum occurs when t is a multiple of the least common multiple (LCM) of a and b, or perhaps at some specific t related to a and b.

But given that a and b can be up to 10^18, and t can be up to something like a*b, which is too large, I need a smarter way.

Wait, perhaps I can consider t = LCM(a, b).

But I'm not sure.

Alternatively, maybe t = m.

Wait, let's try t = m.

For first installation: floor(m/a) - floor((m - m - 1)/a) = floor(m/a) - floor((m - m - 1)/a) = floor(m/a) - floor((-1)/a) = floor(m/a) - (-1 if a > 1 else 0)

But floor(-1/a) is 0 if a > 1, and -1 if a = 1.

So, it's floor(m/a) - (-1 if a=1 else 0) = floor(m/a) + 1 if a=1, else floor(m/a)

Similarly for b.

But this seems complicated.

Wait, perhaps it's easier to think in terms of the number of multiples of a in [t - m, t].

Which is floor(t/a) - floor((t - m -1)/a)

This is a standard formula to count the number of multiples of a in an interval.

Similarly for b.

So, the total is sum of these two.

Now, to maximize this sum, I need to maximize floor(t/a) - floor((t - m -1)/a) + floor(t/b) - floor((t - m -1)/b)

Given that a and b can be up to 10^18, and m can be up to 10^18, I need a way to compute this without iterating over t.

Perhaps I can find a t that maximizes each term individually and sum them up.

Since the installations operate independently, the maximum sum would be the sum of their individual maxima.

But I need to confirm if this is always the case.

In the first example, a=6, b=7, m=4.

Maximum for first installation: floor(t/6) - floor((t -5)/6)

At t=7: 1 - 0 =1

At t=6:1 -0=1

At t=11:1 -1=0

So, maximum is 1.

Similarly for second installation: floor(t/7) - floor((t-5)/7)

At t=7:1 -0=1

At t=11:1 -1=0

So, maximum is 1.

Sum is 2, which matches the sample.

In the second example, a=3, b=4, m=10.

At t=12: floor(12/3)=4, floor((12-11)/3)=0 →4 -0=4

floor(12/4)=3, floor((12-11)/4)=0 →3 -0=3

Sum:7

So, the sum of individual maxima seems to hold.

Hence, perhaps the maximum number of visible fireworks is the sum of the maximum visible from each installation.

So, I need to find the maximum number of visible fireworks from the first installation and from the second installation, and sum them up.

Now, for each installation, the maximum number of visible fireworks is ceil(m/a) +1 if a divides m, else ceil(m/a).

Wait, no.

Let me think again.

The number of visible fireworks from the first installation is floor(t/a) - floor((t - m -1)/a)

Similarly for b.

To maximize this, I need to choose t such that floor(t/a) is maximized and floor((t - m -1)/a) is minimized.

But t is constrained by the problem.

Wait, perhaps choosing t such that t is a multiple of a and b.

Wait, perhaps choosing t such that t is the least common multiple (LCM) of a and b.

But in the first example, LCM(6,7)=42, but at t=42, the number of visible fireworks from first installation is floor(42/6)=7, floor((42-5)/6)=floor(37/6)=6 →7-6=1

Similarly for second installation: floor(42/7)=6, floor((42-5)/7)=floor(37/7)=5 →6-5=1

Total:2, which is the same as at t=7.

But at t=7, it's also 2.

So, in this case, it's not higher.

In the second example, LCM(3,4)=12

At t=12: first installation:4 -0=4, second:3 -0=3, total=7

Which is higher than at t=LCM.

But in the third example, a=7, b=8, m=56

LCM(7,8)=56

At t=56: first: floor(56/7)=8, floor((56-57)/7)=floor(-1/7)=0 →8 -0=8

second: floor(56/8)=7, floor((56-57)/8)=floor(-1/8)=0 →7 -0=7

Total:15

But in the sample, at t=112:9 +8=17, which is higher.

So, choosing t=LCM(a,b) gives 15, but choosing t=2*LCM=112 gives 17.

So, t=LCM is not always the best choice.

Hence, I need a better way to find the optimal t.

Looking at the formula:

number_of_fireworks = (floor(t/a) - floor((t - m -1)/a)) + (floor(t/b) - floor((t - m -1)/b))

I need to maximize this sum.

Given that a, b, and m can be up to 10^18, I need an efficient way to compute this.

Perhaps I can consider that the maximum number of visible fireworks from one installation is floor(m/a) +1.

Wait, no.

Wait, the number of visible fireworks from one installation is floor(t/a) - floor((t - m -1)/a)

What's the maximum value this can take?

Well, it's maximized when floor(t/a) is maximized and floor((t - m -1)/a) is minimized.

Given that t can be as large as desired, floor(t/a) can be made arbitrarily large, but floor((t - m -1)/a) will also increase.

But since m is fixed, the difference floor(t/a) - floor((t - m -1)/a) is bounded.

In fact, it's equal to floor(t/a) - floor((t - m -1)/a)

This expression is maximized when t is such that t is just below a multiple of a, but I need to think carefully.

Wait, actually, the maximum value of floor(t/a) - floor((t - m -1)/a) is floor(m/a) +1

Wait, no.

Let me consider t such that t is a multiple of a, say t = k*a.

Then, floor(t/a) = k

(t - m -1)/a = (k*a - m -1)/a = k - ceil(m/a)

So, floor((t - m -1)/a) = floor(k - ceil(m/a)) = k - ceil(m/a)

Therefore, floor(t/a) - floor((t - m -1)/a) = k - (k - ceil(m/a)) = ceil(m/a)

Similarly, if t is not a multiple of a, it could be less.

Wait, but I think I made a mistake here.

Actually, (t - m -1)/a = (k*a - m -1)/a = k - (m +1)/a

Then floor((t - m -1)/a) = floor(k - (m +1)/a) = k - ceil((m +1)/a)

Therefore, floor(t/a) - floor((t - m -1)/a) = k - (k - ceil((m +1)/a)) = ceil((m +1)/a)

Hence, the maximum number of visible fireworks from the first installation is ceil((m +1)/a)

Similarly, from the second installation, it's ceil((m +1)/b)

Therefore, the maximum total is ceil((m +1)/a) + ceil((m +1)/b)

So, the answer should be ceil((m +1)/a) + ceil((m +1)/b)

Is this always true?

Let's check with the sample inputs.

First sample: a=6, b=7, m=4

ceil(5/6) + ceil(5/7) = 1 + 1 = 2, which matches the sample.

Second sample: a=3, b=4, m=10

ceil(11/3) + ceil(11/4) = 4 + 3 = 7, which matches the sample.

Third sample: a=7, b=8, m=56

ceil(57/7) + ceil(57/8) = ceil(8.142...) + ceil(7.125) = 9 + 8 = 17, which matches the sample.

Fourth sample: a=5, b=6, m=78123459896

ceil(78123459897/5) + ceil(78123459897/6) = ceil(15624691979.4) + ceil(13020576649.5) = 15624691980 + 13020576650 = 28645268630, which matches the sample.

Fifth sample: a=1, b=1, m=1

ceil(2/1) + ceil(2/1) = 2 + 2 = 4, which matches the sample.

Sixth sample: a=1, b=1, m=1000000000000000000

ceil(1000000000000000001/1) + ceil(1000000000000000001/1) = 1000000000000000001 + 1000000000000000001 = 2000000000000000002, which matches the sample.

So, in all samples, this formula holds.

Therefore, the correct answer is ceil((m +1)/a) + ceil((m +1)/b)

Now, in Python, to compute ceil(x/y), I can use (x + y -1)//y

So, ceil((m +1)/a) = (m +1 + a -1)//a = (m + a)//a

Similarly, ceil((m +1)/b) = (m + b)//b

Therefore, the total is (m + a)//a + (m + b)//b

Let me verify this with the first sample:

a=6, b=7, m=4

(4 +6)//6 + (4 +7)//7 = 10//6 + 11//7 = 1 + 1 = 2

Second sample:

(10 +3)//3 + (10 +4)//4 = 13//3 + 14//4 = 4 + 3 = 7

Third sample:

(56 +7)//7 + (56 +8)//8 = 63//7 + 64//8 = 9 + 8 = 17

Fourth sample:

(78123459896 +5)//5 + (78123459896 +6)//6 = 78123459901//5 + 78123459902//6 = 15624691980 + 13020576650 = 28645268630

Fifth sample:

(1 +1)//1 + (1 +1)//1 = 2 + 2 = 4

Sixth sample:

(1000000000000000000 +1)//1 + (1000000000000000000 +1)//1 = 100000000000
Correctness: **False**

Explanation: The provided program does not correctly calculate the expected value of the sum of friendship values for all k pairs chosen for the excursions. Specifically, the program does not account for the probability of choosing each pair of friends during the excursions. 

The program calculates the inverse of \( \frac{n(n-1)}{2} \) modulo \( 10^9 + 7 \) and uses it in a way that does not reflect the actual expected value calculation. The expected value should consider the probability of selecting each pair of friends and how their friendship value changes over the k excursions.

For instance, consider the following test case:

Input:
```
1
3 1 2
1 2 1
```

Expected output:
```
3
```

However, the provided program will output a different result because it does not correctly handle the expected value calculation. The program should calculate the expected value by considering the probability of selecting each pair and how their friendship value evolves over the k excursions.
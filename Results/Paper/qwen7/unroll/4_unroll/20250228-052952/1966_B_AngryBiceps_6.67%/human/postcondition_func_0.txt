The function processes multiple test cases, each consisting of a grid of size \(n \times m\) where \(1 \leq n, m \leq 500\), and each cell contains either 'W' or 'B'. For each test case, it checks if the first row is uniform and different from the last row, or if any row is uniform and different from its corresponding first or last row. If either condition is met, it prints 'NO'; otherwise, it prints 'YES'. The function outputs one line per test case, totaling up to \(10^4\) lines.
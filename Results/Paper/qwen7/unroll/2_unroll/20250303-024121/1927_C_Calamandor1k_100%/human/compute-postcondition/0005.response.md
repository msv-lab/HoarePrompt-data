Functionality: **The function accepts two parameters: `t`, a positive integer between 1 and 10^4, and `cases`, a list of tuples. Each tuple contains three integers `n`, `m`, and `k` with specific constraints, and two lists `a` and `b`. For each test case, the function returns a list `results` containing 'YES' or 'NO'. If the number of elements in `only_a` or `only_b` exceeds `k // 2`, or the total number of distinct elements in `only_a`, `only_b`, and `both` is less than `k`, 'NO' is appended to `results`. Otherwise, 'YES' is appended.**
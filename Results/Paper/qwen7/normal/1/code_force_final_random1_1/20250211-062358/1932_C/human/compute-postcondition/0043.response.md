Functionality: **The function accepts four parameters: `n` (a positive integer), `m` (a positive integer), `a` (a list of integers where each integer is in the range [1, 10^4]), and `s` (a string consisting of 'L' and 'R' characters with length `n`). It returns a reversed list `ans` which contains all intermediate values of `p` computed during each iteration of the loop in reverse order.**
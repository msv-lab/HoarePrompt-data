Postcondition: `q` is a positive integer, `idx` has been increased by 2, `v1` is an empty list or a list retrieved from `mp.get(pf[r], [])`, `v2` is a list retrieved from `mp.get(pf[l - 1], [])`, `it2` is the index of the element in `v2` which is just less than `r`. **`it1` is greater than or equal to the length of `v1` or `it2` is less than 0 or `v1[it1]` is greater than `r` or `v2[it2]` is less than `l`**.
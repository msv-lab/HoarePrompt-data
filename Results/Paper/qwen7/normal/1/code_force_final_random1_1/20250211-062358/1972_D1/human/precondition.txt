d is a positive integer, processing is a list of non-negative integers, da is a dictionary mapping integers to integers, and rank is a list of integers.
Postcondition: `e` is an input string with at least one character, `P` is 1 if `q` is '+', and `M` is 1 if `q` is not '+'.
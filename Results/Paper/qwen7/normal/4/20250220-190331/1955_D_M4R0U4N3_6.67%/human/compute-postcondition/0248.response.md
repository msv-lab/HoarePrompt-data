Postcondition: `r` is `m + 1`, `m` is less than or equal to `n`, and `n` is greater than `m`; if `old` (which is `a[r - m]`) is in `extra`, then `extra` does not contain `old`. If `old` is not in `extra`, and if `old` is in `done`, then `old` is added to `todo` and `done` does not contain `old`. If `old` is not in `done`, no changes are made to `todo` and `done`.
Postcondition: `l` is equal to `r - k`, `r` is `n - k - 1`, `st` is the total number of consecutive duplicates found, `end` is `k`, and `ans` is `r - l - 1` if `a[0] == a[-1]`. Otherwise, `ans` is `len(a) - 1` if `st == 0`, `end == 0`, and `a[0] != a[-1]` hold true, or `r - l` otherwise.
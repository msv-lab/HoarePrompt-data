The function processes multiple test cases. For each test case, it checks if a given string `s` contains at least `n` distinct substrings, each containing all `k` unique lowercase English alphabets up to the `k`-th letter. If the condition is met, it prints "YES". Otherwise, it prints "NO" and constructs a string of length `n` using the available characters, ensuring it contains as many distinct substrings with all `k` unique letters as possible, followed by the remaining required characters to meet the length `n`.
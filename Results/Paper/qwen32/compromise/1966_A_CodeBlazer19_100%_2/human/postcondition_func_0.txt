The function processes multiple test cases, each consisting of two integers `n` and `k`, followed by a list of `n` integers. For each test case, it determines if any number in the list appears at least `k` times. If so, it outputs `k - 1`; otherwise, it outputs `n`.
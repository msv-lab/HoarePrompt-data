The function `func` processes multiple test cases, each containing an integer `n` (3 ≤ n ≤ 3·10^5) and a string `a` of length `n` consisting of '0' and '1'. For each test case, it finds the optimal position (an integer) where the number of residents preferring to live on the left side and the number of residents preferring to live on the right side are as balanced as possible. If no such position exists, it returns the position that maximizes the balance according to the given conditions. The function prints the optimal position for each test case. After processing all test cases, the function completes and the initial state variables `t` and the function `func` remain unchanged.
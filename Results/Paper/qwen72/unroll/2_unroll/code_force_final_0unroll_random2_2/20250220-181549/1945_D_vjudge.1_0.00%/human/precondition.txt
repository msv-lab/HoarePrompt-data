The function should take three parameters: t (an integer representing the number of test cases, 1 ≤ t ≤ 10^4), a list of tuples where each tuple contains two integers n and m (1 ≤ m ≤ n ≤ 200,000), and two lists of integers a and b (1 ≤ a_i, b_i ≤ 10^9) for each test case. The sum of the values of n over all test cases does not exceed 2 · 10^5.
The function `solve` is expected to be called within a context where it processes multiple test cases, each with an integer `n` and a list of integers `a` where 1 ≤ n ≤ 3 · 10^5 and 1 ≤ a_i ≤ n. The array `a` is guaranteed to be beautiful, and the sum of `n` over all test cases does not exceed 3 · 10^5.
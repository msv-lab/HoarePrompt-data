Precondition: **The function `func` is expected to be called within a context that provides the necessary inputs as described in the problem statement. Specifically, the inputs should be provided through standard input or a similar mechanism, and they should consist of multiple test cases. Each test case includes two integers n and m, a list of n integers a, and a string s of length n consisting of characters 'L' and 'R'. The constraints are 1 ≤ t ≤ 10^4, 1 ≤ n ≤ 2·10^5, 1 ≤ m ≤ 10^4, 1 ≤ a_i ≤ 10^4, and the sum of n across all test cases does not exceed 2·10^5.**
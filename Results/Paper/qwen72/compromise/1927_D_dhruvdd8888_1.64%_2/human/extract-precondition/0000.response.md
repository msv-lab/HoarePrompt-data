Precondition: **The function should take three parameters: a list of integers `a`, an integer `n` representing the length of the list `a`, and a list of queries `q` where each query is a list of two integers `[l, r]` such that 1 ≤ l < r ≤ n. The list `a` contains integers in the range 1 ≤ a_i ≤ 10^6, and the number of queries `q` is such that 1 ≤ q ≤ 2 · 10^5. The function should handle multiple test cases, where the number of test cases `t` is 1 ≤ t ≤ 10^4, and the sum of the values of `n` and `q` across all test cases does not exceed 2 · 10^5.**
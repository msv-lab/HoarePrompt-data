Reasoning:

1. **Problem Understanding**: The problem involves calculating the expected value of the sum of friendship values for \( k \) excursions, where the friendship value of a pair increases by 1 each time the pair is chosen.

2. **Given Code Analysis**:
   - The code correctly initializes the modulus constant `MOD` to \( 10^9 + 7 \).
   - It reads the number of test cases `T`.
   - For each test case, it reads the values of `n`, `m`, and `k`.
   - It then calculates the sum of the friendship values (`S`) for the first `m` lines.
   - The code calculates the total number of possible pairs `C` using the combination formula \( \binom{n}{2} = \frac{n \times (n - 1)}{2} \).

3. **Key Calculations**:
   - The numerator `num` is calculated as \( p \cdot k \cdot k - p \cdot k + 2 \cdot k \cdot C \cdot S \).
   - The denominator `den` is calculated as \( 2 \cdot C \cdot C \).
   - The greatest common divisor (GCD) of `num` and `den` is found and used to simplify both `num` and `den`.
   - The modular multiplicative inverse of `den` is calculated using `pow(den, -1, MOD)`.
   - Finally, `ans` is calculated as `num * den % MOD`.

4. **Correctness Verification**:
   - The logic for calculating the expected value of the sum of friendship values is sound.
   - The use of modular arithmetic ensures that the result fits within the required constraints.
   - The code handles the input and output as specified in the problem statement.

Given the analysis, the provided code appears to correctly implement the solution to the problem as described.

Correctness: **True**
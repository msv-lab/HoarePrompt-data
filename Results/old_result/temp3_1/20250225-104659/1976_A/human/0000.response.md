```python
import io
import sys
from program import func_1

def run_program_with_captured_io(input_data):
    original_stdin = sys.stdin
    original_stdout = sys.stdout

    try:
        sys.stdin = io.StringIO(input_data)
        captured_output = io.StringIO()
        sys.stdout = captured_output

        with open("program.py", "r", encoding="utf-8") as f:
            code = f.read()
            exec(code, {})

        return captured_output.getvalue().strip()
    
    finally:
        sys.stdin = original_stdin
        sys.stdout = original_stdout

# Test cases for the function func_1
def test_func_1():
    # Test case 1
    test_cases = [(4, "12ac"), (5, "123wa"), (9, "allllmost"), (5, "ac123"), (6, "011679")]
    expected_results = ["YES", "NO", "YES", "NO", "YES"]
    assert func_1(5, test_cases) == expected_results

    # Test case 2: Only letters
    test_cases = [(3, "abc"), (3, "a")]
    expected_results = ["YES", "YES"]
    assert func_1(2, test_cases) == expected_results

    # Test case 3: Only digits
    test_cases = [(3, "123"), (1, "9")]
    expected_results = ["YES", "YES"]
    assert func_1(2, test_cases) == expected_results

    # Test case 4: Mixed but invalid due to unsorted letters
    test_cases = [(3, "bac"), (4, "12ba")]
    expected_results = ["NO", "NO"]
    assert func_1(2, test_cases) == expected_results

    # Test case 5: Mixed but invalid due to unsorted digits
    test_cases = [(3, "a32"), (4, "ab31")]
    expected_results = ["NO", "NO"]
    assert func_1(2, test_cases) == expected_results

    # Test case 6: Mixed but invalid due to digit after letter
    test_cases = [(3, "a1b"), (4, "abc12")]
    expected_results = ["NO", "NO"]
    assert func_1(2, test_cases) == expected_results

    # Test case 7: Edge case with single character
    test_cases = [(1, "a"), (1, "1")]
    expected_results = ["YES", "YES"]
    assert func_1(2, test_cases) == expected_results

    # Test case 8: Edge case with two characters
    test_cases = [(2, "ab"), (2, "12"), (2, "a1"), (2, "b2")]
    expected_results = ["YES", "YES", "NO", "NO"]
    assert func_1(4, test_cases) == expected_results

    print("All test cases passed!")

# Run the test cases
test_func_1()

# Test cases for the script execution
def test_script_execution():
    input_data = """5
4
12ac
5
123wa
9
allllmost
5
ac123
6
011679"""
    expected_output = "YES\nNO\nYES\nNO\nYES"
    assert run_program_with_captured_io(input_data) == expected_output

    input_data = """2
3
abc
3
a"""
    expected_output = "YES\nYES"
    assert run_program_with_captured_io(input_data) == expected_output

    input_data = """2
3
123
1
9"""
    expected_output = "YES\nYES"
    assert run_program_with_captured_io(input_data) == expected_output

    input_data = """2
3
bac
4
12ba"""
    expected_output = "NO\nNO"
    assert run_program_with_captured_io(input_data) == expected_output

    input_data = """2
3
a32
4
ab31"""
    expected_output = "NO\nNO"
    assert run_program_with_captured_io(input_data) == expected_output

    input_data = """2
3
a1b
4
abc12"""
    expected_output = "NO\nNO"
    assert run_program_with_captured_io(input_data) == expected_output

    input_data = """2
1
a
1
1"""
    expected_output = "YES\nYES"
    assert run_program_with_captured_io(input_data) == expected_output

    input_data = """4
2
ab
2
12
2
a1
2
b2"""
    expected_output = "YES\nYES\nNO\nNO"
    assert run_program_with_captured_io(input_data) == expected_output

    print("All script execution test cases passed!")

# Run the script execution test cases
test_script_execution()
```

This script includes both function-level tests for `func_1` and script-level tests using `run_program_with_captured_io`. Each test case is designed to cover different scenarios and edge cases as per the problem description.
To create a test script for the given problem, we need to simulate the input and capture the output of the provided program. Since the program does not define a function directly, we will use the `run_program_with_captured_io` function to execute the program and capture its output.

Here's the complete test script with assertions:

```python
import io
import sys

def run_program_with_captured_io(input_data):
    original_stdin = sys.stdin
    original_stdout = sys.stdout

    try:
        sys.stdin = io.StringIO(input_data)
        captured_output = io.StringIO()
        sys.stdout = captured_output

        with open("program.py", "r", encoding="utf-8") as f:
            code = f.read()
            exec(code, {})

        return captured_output.getvalue().strip()
    
    finally:
        sys.stdin = original_stdin
        sys.stdout = original_stdout

# Test cases
test_cases = [
    (
        "4\n2 1\n1 2 2 1\n6 1\n6 4 2 1 2 3 1 6 3 5 5 4\n4 1\n1 2 3 4 1 2 3 4\n6 2\n5 1 3 3 5 1 2 6 4 6 4 2",
        "2 1\n2 1\n6 4\n1 3\n1 2\n1 2\n5 1 3 3\n6 4 2 4"
    ),
    (
        "1\n4 2\n1 2 3 4 1 2 3 4",
        "1 2 3 4\n1 2 3 4"
    ),
    (
        "1\n6 1\n1 1 2 2 3 3 4 4 5 5 6 6",
        "1 1\n2 2"
    ),
    (
        "1\n8 4\n1 2 3 4 5 6 7 8 1 2 3 4 5 6 7 8",
        "1 2 3 4 5 6 7 8\n1 2 3 4 5 6 7 8"
    ),
    (
        "1\n10 5\n1 2 3 4 5 6 7 8 9 10 1 2 3 4 5 6 7 8 9 10",
        "1 2 3 4 5 6 7 8 9 10\n1 2 3 4 5 6 7 8 9 10"
    )
]

# Run tests
for i, (input_data, expected_output) in enumerate(test_cases):
    output = run_program_with_captured_io(input_data)
    assert output == expected_output, f"Test case {i+1} failed: expected {expected_output}, got {output}"
    print(f"Test case {i+1} passed.")
```

### Explanation:
1. **Helper Function**: We use `run_program_with_captured_io` to execute the program with the provided input and capture its output.
2. **Test Cases**: We define several test cases, each consisting of an input string and the expected output string.
3. **Assertions**: For each test case, we run the program with the input data and assert that the captured output matches the expected output.
4. **Feedback**: If the assertion passes, we print that the test case passed. If it fails, an assertion error will be raised indicating which test case failed.

This script ensures that the provided program behaves correctly across different scenarios.
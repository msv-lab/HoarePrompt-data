To create a comprehensive test script for the provided program, we need to simulate the interactions between Cat and Fox. Since the program involves interactive queries, we'll use the `run_program_with_captured_io` function to capture the input and output. We'll mock the responses from Fox based on the problem description and test the program's behavior.

Here's the complete test script:

```python
import io
import sys

def run_program_with_captured_io(input_data, fox_responses):
    original_stdin = sys.stdin
    original_stdout = sys.stdout

    try:
        sys.stdin = io.StringIO(input_data)
        captured_output = io.StringIO()
        sys.stdout = captured_output

        # Mock the input function to return fox_responses
        def mock_input():
            return fox_responses.pop(0)

        original_input = __builtins__.input
        __builtins__.input = mock_input

        with open("program.py", "r", encoding="utf-8") as f:
            code = f.read()
            exec(code, {})

        __builtins__.input = original_input

        return captured_output.getvalue().strip()
    
    finally:
        sys.stdin = original_stdin
        sys.stdout = original_stdout

# Define test cases
test_cases = [
    {
        "input": "3\n1 1\n",
        "fox_responses": ["1"],
        "expected_output": "! 1"
    },
    {
        "input": "3\n2 2\n",
        "fox_responses": ["1", "2"],
        "expected_output": "? 1 1\n? 2 1\n! -1"
    },
    {
        "input": "3\n6 3\n",
        "fox_responses": ["7", "2", "4", "6", "7", "6", "1"],
        "expected_output": "? 1 9\n? 1 6\n? 3 6\n? 4 6\n! 6"
    },
    {
        "input": "2\n5 3\n",
        "fox_responses": ["5", "3", "5", "5", "3", "5", "5"],
        "expected_output": "? 1 15\n? 1 10\n? 3 10\n? 4 10\n! 10\n? 1 15\n? 1 10\n? 3 10\n? 4 10\n! 10"
    },
    {
        "input": "1\n3 1\n",
        "fox_responses": ["3"],
        "expected_output": "! 3"
    }
]

# Run test cases
for i, test_case in enumerate(test_cases):
    input_data = test_case["input"]
    fox_responses = test_case["fox_responses"]
    expected_output = test_case["expected_output"]
    
    actual_output = run_program_with_captured_io(input_data, fox_responses)
    
    # Replace newlines for easier comparison
    actual_output = actual_output.replace('\n', ' ')
    expected_output = expected_output.replace('\n', ' ')
    
    assert actual_output == expected_output, f"Test case {i+1} failed: expected '{expected_output}', got '{actual_output}'"

print("All test cases passed!")
```

### Explanation:
1. **run_program_with_captured_io**: This function captures the input and output of the program, allowing us to simulate the interaction with Fox.
2. **Mocking Input**: We mock the `input` function to return predefined responses from Fox (`fox_responses`).
3. **Test Cases**: We define several test cases with different inputs and expected outputs. Each test case includes:
   - `input`: The input data for the program.
   - `fox_responses`: The responses that Fox would give to the queries.
   - `expected_output`: The expected output from the program.
4. **Assertions**: We use assertions to compare the actual output of the program with the expected output.

This script ensures that the program behaves correctly across various scenarios.
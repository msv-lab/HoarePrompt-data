To create a comprehensive test script for the given problem, we need to simulate the input and compare the output against the expected results. Since the provided program is a script that reads from standard input and writes to standard output, we'll use the `run_program_with_captured_io` function to capture and compare the output.

Here's the complete test script:

```python
import io
import sys

def run_program_with_captured_io(input_data):
    original_stdin = sys.stdin
    original_stdout = sys.stdout

    try:
        sys.stdin = io.StringIO(input_data)
        captured_output = io.StringIO()
        sys.stdout = captured_output

        with open("program.py", "r", encoding="utf-8") as f:
            code = f.read()
            exec(code, {})

        return captured_output.getvalue().strip()
    
    finally:
        sys.stdin = original_stdin
        sys.stdout = original_stdout

# Test cases
test_cases = [
    # Test case 1
    (
        "5\n5\n1 2 3 4 5\n8\n8 2 3 1 1 7 4 3\n5\n3 3 3 3 3\n1\n1\n2\n2 1",
        "3\n1\n0\n0\n0"
    ),
    # Test case 2: Single element array
    (
        "1\n1\n1",
        "0"
    ),
    # Test case 3: All elements in ascending order
    (
        "1\n5\n1 2 3 4 5",
        "4"
    ),
    # Test case 4: All elements in descending order
    (
        "1\n5\n5 4 3 2 1",
        "0"
    ),
    # Test case 5: All elements are the same
    (
        "1\n5\n2 2 2 2 2",
        "0"
    ),
    # Test case 6: Mixed order with alternating elements
    (
        "1\n6\n1 3 2 4 3 5",
        "2"
    ),
    # Test case 7: Large input with random elements
    (
        "1\n10\n5 3 8 6 2 7 4 9 1 10",
        "3"
    ),
]

# Run tests
for i, (input_data, expected_output) in enumerate(test_cases):
    assert run_program_with_captured_io(input_data) == expected_output, f"Test case {i+1} failed"

print("All test cases passed!")
```

### Explanation:
- **run_program_with_captured_io**: This function captures the output of the `program.py` script when given specific input data.
- **Test Cases**:
  - We have included several test cases to cover different scenarios:
    - Multiple test cases as per the example.
    - Edge cases like a single-element array, all elements in ascending or descending order, and all elements being the same.
    - A mixed-order array and a large input with random elements.
- **Assertions**: Each test case uses an assertion to compare the actual output of the program with the expected output. If any test case fails, an assertion error will be raised indicating which test case failed.

This script ensures that the provided program behaves correctly across various scenarios.
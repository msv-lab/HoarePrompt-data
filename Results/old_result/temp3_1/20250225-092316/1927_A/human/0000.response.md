```python
# Include necessary imports if any
# Assume the provided program is saved as 'program.py' and can be imported from the same dir.

# If there is a specific function we can call, import it
from program import func

# Otherwise, use the run_program_with_captured_io(input_data) function to run the program and capture the output
import io
import sys

def run_program_with_captured_io(input_data):
    original_stdin = sys.stdin
    original_stdout = sys.stdout

    try:
        sys.stdin = io.StringIO(input_data)
        captured_output = io.StringIO()
        sys.stdout = captured_output

        with open("program.py", "r", encoding="utf-8") as f:
            code = f.read()
            exec(code, {})

        return captured_output.getvalue().strip()
    
    finally:
        sys.stdin = original_stdin
        sys.stdout = original_stdout

# Write your test cases below
# Each test case should include assertions based on the problem description

# Test case 1 from the example
input_data = """8
6
WBBWBW
1
B
2
WB
3
BBW
4
BWWB
6
BWBWWB
6
WWBBWB
9
WBWBWWWBW"""
expected_output = """4
1
1
2
4
6
4
7"""
assert run_program_with_captured_io(input_data) == expected_output

# Additional test cases

# All black cells
input_data = """1
5
BBBBB"""
expected_output = """5"""
assert run_program_with_captured_io(input_data) == expected_output

# All white cells (though the problem guarantees at least one black cell, this is a good edge case to check)
input_data = """1
5
WWWWW"""
expected_output = """0"""
assert run_program_with_captured_io(input_data) == expected_output

# Single black cell
input_data = """1
1
B"""
expected_output = """1"""
assert run_program_with_captured_io(input_data) == expected_output

# Single white cell (though the problem guarantees at least one black cell, this is a good edge case to check)
input_data = """1
1
W"""
expected_output = """0"""
assert run_program_with_captured_io(input_data) == expected_output

# Mixed pattern
input_data = """1
10
WBWBWBWBWB"""
expected_output = """10"""
assert run_program_with_captured_io(input_data) == expected_output

# Multiple test cases with different patterns
input_data = """3
2
BW
2
WB
2
WW"""
expected_output = """2
2
0"""
assert run_program_with_captured_io(input_data) == expected_output

# End of script
```
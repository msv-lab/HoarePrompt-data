Alright, I've got this problem to solve. Let's see what it's asking for. So, I'm given two positive integers, n and m, and I need to find the number of ordered pairs (a, b) where 1 ≤ a ≤ n and 1 ≤ b ≤ m, with the condition that a + b is a multiple of b multiplied by the greatest common divisor of a and b. That is, a + b should be divisible by b * gcd(a, b).

First, I need to understand what this condition means. Let's break it down. GCD stands for Greatest Common Divisor, which is the largest positive integer that divides both a and b without leaving a remainder. So, gcd(a, b) is that number.

The condition is that a + b should be divisible by b * gcd(a, b). In mathematical terms, this means that b * gcd(a, b) divides a + b without leaving a remainder.

Let me try to simplify this condition. Maybe there's a way to express this in a more manageable form.

Let’s denote d = gcd(a, b). Then, we can write a = d * a' and b = d * b', where a' and b' are coprime integers (their gcd is 1).

Substituting these into the condition:

a + b = d * a' + d * b' = d(a' + b')

And b * gcd(a, b) = d * b' * d = d^2 * b'

So, the condition becomes: d(a' + b') must be divisible by d^2 * b'.

Simplifying, this means that a' + b' must be divisible by d * b'.

But since a' and b' are coprime, and d = gcd(a, b), I need to see how these relate.

Wait, maybe there's a better way to approach this.

Let’s consider the ratio (a + b) / (b * gcd(a, b)). For this to be an integer, the numerator must be divisible by the denominator.

So, (a + b) / (b * gcd(a, b)) must be an integer.

Let’s substitute a = d * a' and b = d * b', where gcd(a', b') = 1.

Then, (a + b) / (b * gcd(a, b)) = (d * a' + d * b') / (d * b' * d) = (d(a' + b')) / (d^2 b') = (a' + b') / (d * b')

For this to be an integer, (a' + b') must be divisible by d * b'.

But a' and b' are coprime, so a' + b' and b' are not necessarily coprime, but since a' and b' are coprime, maybe I can find some relationship here.

Alternatively, maybe I can look at the condition in terms of divisibility.

We have that b * gcd(a, b) divides a + b.

Let’s consider that gcd(a, b) divides both a and b, so it divides a + b as well.

Therefore, b * gcd(a, b) divides a + b.

But b and gcd(a, b) are not necessarily coprime, so I need to be careful.

Wait, actually, b and gcd(a, b) are not necessarily coprime because b could have factors in common with gcd(a, b).

Hmm.

Let me try to think differently.

Suppose I fix b, and then see for each b, how many a satisfy the condition.

So, for a fixed b, I need to find the number of a such that 1 ≤ a ≤ n, and a + b is divisible by b * gcd(a, b).

But gcd(a, b) divides both a and b, so gcd(a, b) divides a + b.

Therefore, b * gcd(a, b) divides a + b.

Wait, but this seems similar to what I had before.

Maybe I can write a + b = k * b * gcd(a, b), for some integer k ≥ 1.

But this seems a bit messy.

Let me see if I can find a pattern or a formula that can help me compute the number of such pairs efficiently, especially considering the constraints: t ≤ 10^4 test cases, and n and m up to 2*10^6, with the sum of n and m over all test cases not exceeding 2*10^6.

So, I need an efficient way to compute this, probably O(n log n) or better.

Let me think about the properties of gcd.

Another approach: let’s iterate over possible values of gcd(d).

So, d can be any integer from 1 up to min(n, m).

For each d, I can consider all pairs (a, b) where gcd(a, b) = d.

Then, a must be a multiple of d, and b must be a multiple of d.

So, a = d * a', b = d * b', where gcd(a', b') = 1.

Then, the condition becomes:

a + b = d * a' + d * b' = d(a' + b') must be divisible by b * d = d * (d * b') = d^2 * b'.

So, d(a' + b') must be divisible by d^2 * b'.

Simplifying, a' + b' must be divisible by d * b'.

But a' and b' are coprime.

So, a' + b' and b' are coprime except for the common factor of b'.

Wait, no. Since a' and b' are coprime, a' + b' and b' are also coprime.

Wait, is that true?

Let’s see: if a' and b' are coprime, then any common divisor of a' + b' and b' must divide a' as well, but a' and b' are coprime, so their sum and b' are coprime.

Wait, no. For example, take a' = 2, b' = 1. Then a' + b' = 3, which is coprime with b' = 1.

Take a' = 3, b' = 2. a' + b' = 5, which is coprime with b' = 2.

Wait, but take a' = 3, b' = 3. But a' and b' are not coprime in this case.

Wait, I assumed a' and b' are coprime.

So, in general, if a' and b' are coprime, then a' + b' and b' are coprime.

Because any divisor of b' cannot divide a', since they are coprime, hence cannot divide a' + b'.

Therefore, a' + b' and b' are coprime.

Therefore, a' + b' is divisible by d * b' implies that b' divides a' + b', but since a' + b' and b' are coprime, b' must be 1.

Wait, that can't be right.

Wait, if a' + b' is divisible by d * b', and a' + b' and b' are coprime, then d * b' must be 1.

But d is at least 1, and b' is at least 1, so d * b' is at least 1.

If d * b' = 1, then d = 1 and b' = 1.

So, in this case, for the condition to hold, d must be 1 and b' must be 1.

Which means b = d * b' = 1 * 1 = 1, and a = d * a' = 1 * a', so a is any integer.

But wait, that can't be right because in the sample input, there are more pairs than just those with b=1.

Wait, perhaps I made a mistake.

Let’s revisit.

We have a' + b' must be divisible by d * b'.

But a' + b' and b' are coprime, unless b' = 1.

If b' > 1, then a' + b' and b' share no common factors except 1, so for a' + b' to be divisible by d * b', and since b' divides d * b', but b' and a' + b' are coprime unless b' = 1, the only way this can happen is if b' = 1 and d divides a' + b'.

Wait, perhaps I need to consider cases based on b'.

Case 1: b' = 1.

Then, a' + 1 must be divisible by d * 1 = d.

Since a' and 1 are coprime, a' can be any integer greater than or equal to 1.

So, a' + 1 divisible by d.

So, a' ≡ -1 mod d.

Since a' is positive, a' can take values 1, 2, ..., a' ≤ n/d.

Similarly, b' = 1, so b = d * 1 = d, and b ≤ m, so d ≤ m.

So, for each d from 1 to m, and for each a' such that a' ≡ -1 mod d, and a' ≤ n/d.

The number of such a' is floor((n/d + d - 1)/d).

Wait, more carefully: a' ≡ -1 mod d, which is the same as a' ≡ d - 1 mod d.

So, a' = k * d + (d - 1), for k ≥ 0.

And a' ≤ n/d.

So, k * d + (d - 1) ≤ n/d.

Wait, this seems a bit messy.

Alternatively, since a' ≡ -1 mod d, the smallest a' is d - 1, then 2d - 1, 3d - 1, etc., up to some maximum where a' ≤ n/d.

So, a' can take values d - 1, 2d - 1, 3d - 1, ..., up to the largest k where k*d - 1 ≤ n/d.

Wait, this is getting complicated.

Maybe there's a better way.

Alternatively, perhaps I can think in terms of a + b being divisible by b * gcd(a, b).

Wait, perhaps I can consider that a + b is divisible by b * gcd(a, b), which implies that gcd(a, b) divides a + b, which is already true, since gcd(a, b) divides both a and b.

But the condition is stronger: b * gcd(a, b) divides a + b.

So, it's not just that gcd(a, b) divides a + b, but their product with b divides a + b.

This seems tricky.

Let me try to look for some patterns or examples.

Take the first sample input:

n = 1, m = 1.

Only pair is (1,1).

Check condition: a + b = 2, b * gcd(a,b) = 1 * 1 = 1, and 1 divides 2, so it's valid.

Second sample input:

n = 2, m = 3.

Possible pairs: (1,1), (1,2), (1,3), (2,1), (2,2), (2,3).

Check each:

(1,1): 1+1=2, 1*1=1 divides 2 → valid.

(1,2): 1+2=3, 2*1=2 divides 3 → no, since 2 does not divide 3.

(1,3): 1+3=4, 3*1=3 divides 4 → no.

(2,1): 2+1=3, 1*1=1 divides 3 → valid.

(2,2): 2+2=4, 2*2=4 divides 4 → valid.

(2,3): 2+3=5, 3*1=3 divides 5 → no.

So, valid pairs are (1,1), (2,1), (2,2) → total 3, which matches the sample output.

Another sample input:

n = 3, m = 5.

Possible pairs: (1,1), (1,2), (1,3), (1,4), (1,5), (2,1), (2,2), (2,3), (2,4), (2,5), (3,1), (3,2), (3,3), (3,4), (3,5).

Check each:

(1,1): valid.

(1,2): 1+2=3, 2*1=2 divides 3? No.

(1,3): 1+3=4, 3*1=3 divides 4? No.

(1,4): 1+4=5, 4*1=4 divides 5? No.

(1,5): 1+5=6, 5*1=5 divides 6? No.

(2,1): valid.

(2,2): valid.

(2,3): 2+3=5, 3*2=6 divides 5? No.

(2,4): 2+4=6, 4*2=8 divides 6? No.

(2,5): 2+5=7, 5*1=5 divides 7? No.

(3,1): valid.

(3,2): 3+2=5, 2*1=2 divides 5? No.

(3,3): 3+3=6, 3*3=9 divides 6? No.

(3,4): 3+4=7, 4*1=4 divides 7? No.

(3,5): 3+5=8, 5*1=5 divides 8? No.

So, valid pairs are (1,1), (2,1), (2,2), (3,1) → total 4, matching the sample output.

From these examples, it seems that most valid pairs have b = 1, except when a and b share some properties.

Wait, in the first sample, only b=1 is valid.

In the second sample, b=1 and b=2 are valid for certain a.

Wait, but in the second sample, for b=2, a=2 is valid.

Similarly, in the third sample, for b=1, a=1,2,3 are valid.

For b=2, a=2 is valid.

But in the second sample, for b=2, a=2 is valid.

Wait, but in the second sample, for b=2, a=2 is valid, but a=1 is not.

Wait, in the second sample, b=2, a=2 is valid because a + b = 4, and b * gcd(a,b) = 2 * 2 = 4 divides 4.

For a=1, a + b = 3, and b * gcd(a,b) = 2 * 1 = 2, which does not divide 3.

Similarly, for b=3, a=2 is not valid, since 2 + 3 = 5, and 3 * gcd(2,3) = 3 * 1 = 3, which does not divide 5.

Wait, perhaps I can find a general condition for when a and b satisfy the condition.

Let’s try to find a relationship between a and b.

Given that b * gcd(a,b) divides a + b.

Let’s denote d = gcd(a, b).

Then, a = d * a', b = d * b', where gcd(a', b') = 1.

Substituting into the condition:

b * d divides a + b → d * b' * d divides d * a' + d * b' = d(a' + b').

So, d^2 * b' divides d(a' + b'), which simplifies to d * b' divides a' + b'.

But a' and b' are coprime, so a' + b' and b' are coprime.

Therefore, b' divides a' + b' only if b' = 1.

Wait, but in the second sample, b=2, d=2, b'=1, which matches b'=1.

Wait, no, b=2, d=2, b'=1.

Wait, in that case, b' = 1.

Wait, but in the second sample, for b=2, d=2, which gives b'=1.

Wait, perhaps I need to be careful with the value of d.

Wait, perhaps I need to consider d as gcd(a, b), and then see what b' is.

Wait, b = d * b', so b' = b / d.

Given that b is a multiple of d, since d divides b.

So, b' is an integer greater than or equal to 1.

Given that a' and b' are coprime, and a' + b' must be divisible by d * b'.

But a' + b' and b' are coprime unless b' = 1.

Therefore, the only way for d * b' to divide a' + b' is if b' = 1 and d divides a' + b'.

So, b' = 1, which implies b = d * 1 = d.

Therefore, b = d.

And a = d * a', where a' is such that a' is coprime with b' = 1, which means a' can be any positive integer.

But a' + b' = a' + 1 must be divisible by d * 1 = d.

Since b = d, and a' + 1 must be divisible by d.

So, a' ≡ -1 mod d.

Which means a' ≡ d - 1 mod d.

Therefore, a' can take values d - 1, d - 1 + d, d - 1 + 2d, etc., up to a' ≤ n / d.

Wait, but a' is at least 1.

So, a' = d * k + (d - 1), for k ≥ 0, such that a' ≤ n / d.

So, d * k + (d - 1) ≤ n / d.

Wait, this seems a bit off.

Wait, a = d * a', and a ≤ n, so a' ≤ n / d.

Similarly, b = d, and b ≤ m, so d ≤ m.

Therefore, for each d from 1 to m, we can count the number of a' such that a' ≡ d - 1 mod d, and a' ≤ n / d.

Wait, but d - 1 mod d is actually just d - 1, since d - 1 < d.

So, a' ≡ d - 1 mod d.

Which means a' = d * k + (d - 1), for k ≥ 0.

We need a' ≤ n / d.

So, d * k + (d - 1) ≤ n / d.

Let’s solve for k:

d * k + d - 1 ≤ n / d

d * k ≤ n / d - (d - 1)

k ≤ (n / d - d + 1) / d

But this seems messy.

Alternatively, perhaps it's easier to think of a' as a' = d * t - 1, for t ≥ 1, and a' ≤ n / d.

Wait, no, a' = d * t - 1, for t ≥ 1.

Then, d * t - 1 ≤ n / d.

So, d * t ≤ n / d + 1

t ≤ (n / d + 1) / d

But n / d could be a float, so need to be careful.

Alternatively, since a' must be an integer, and a' ≤ floor(n / d), and a' ≡ d - 1 mod d.

So, the number of such a' is floor((floor(n / d) + 1 - (d - 1)) / d).

Wait, perhaps it's better to think in terms of the number of complete cycles of d in the range.

Wait, maybe I should consider that a' ≡ d - 1 mod d.

Which is the same as a' ≡ -1 mod d.

So, the number of a' in the range [1, floor(n / d)] such that a' ≡ -1 mod d.

This is a standard problem of counting the number of integers in a range that are congruent to a certain value modulo d.

The formula for the number of integers x in [1, k] such that x ≡ r mod d is floor((k - r) / d) + 1, provided that r ≤ k.

In this case, r = d - 1.

So, the number of a' is floor((floor(n / d) - (d - 1)) / d) + 1, if d - 1 ≤ floor(n / d), else 0.

Wait, but d - 1 could be 0 if d = 1.

For d = 1, a' ≡ 0 mod 1, which is always true, so a' can be any integer up to floor(n / 1) = n.

So, the number of a' is floor(n / 1) = n.

But in the sample input where n=1, m=1, it's only 1 pair.

Wait, perhaps I'm missing something.

Wait, in the first sample, n=1, m=1, d can be 1.

Then, a' ≤ 1, and a' ≡ 0 mod 1, which is always true, so a' =1 is valid.

So, one pair.

In the second sample, n=2, m=3.

d can be 1,2,3.

For d=1:

a' ≡ 0 mod 1, a' ≤ 2.

So, a' can be 1,2.

But b=1, and for a=1, b=1: valid.

For a=2, b=1: valid.

For d=2:

a' ≡ 1 mod 2, a' ≤ 1.

So, a' =1.

But a' ≡1 mod 2, which is true for a'=1.

So, one a'.

b=2, a=2*1=2.

So, pair (2,2).

For d=3:

a' ≡2 mod 3, a' ≤ 0.

floor(2/3)=0.

But a' ≡2 mod 3, but a' ≤0, which is not possible since a' ≥1.

So, no pairs for d=3.

Total pairs: 1 (from d=1) +1 (from d=2) +0 =2.

But in the sample, it's 3.

Wait, that doesn't match.

Wait, perhaps I missed something.

Wait, in d=1, a' can be 1,2.

But for d=1, b=1.

So, pairs (1,1) and (2,1).

In d=2, a' ≡1 mod 2, a' ≤1.

a'=1 is valid.

So, pair (2,2).

Total pairs: (1,1),(2,1),(2,2) →3, which matches the sample.

Ok, so the formula seems to work for this sample.

Let’s check for n=3, m=5.

d from 1 to 5.

For d=1:

a' ≡0 mod1, a' ≤3.

a' can be 1,2,3.

So, pairs (1,1),(2,1),(3,1).

For d=2:

a' ≡1 mod2, a' ≤1.

a'=1.

Pair (2,2).

For d=3:

a' ≡2 mod3, a' ≤1.

No a' satisfies this.

For d=4:

a' ≡3 mod4, a' ≤0.

No a'.

For d=5:

a' ≡4 mod5, a' ≤0.

No a'.

Total pairs: 3 +1 +0 +0 +0 =4, which matches the sample.

Great, so this seems correct.

So, the general approach is:

For each d from 1 to m:

b = d

a' ≡ d-1 mod d

a' ≤ n / d

The number of such a' is floor((floor(n/d) - (d-1)) / d) + 1, if d-1 ≤ floor(n/d), else 0.

But need to handle d=1 carefully, since d-1=0.

Wait, for d=1:

a' ≡0 mod1, which is always true, so number of a' is floor(n/1)=n.

Wait, but in the formula above, it would be floor((floor(n/d)-(d-1))/d)+1 = floor(n - 0)/1 +1 = n +1, which is incorrect.

So, need to adjust the formula for d=1.

Alternatively, consider that for d=1, a' can be any integer from 1 to floor(n/1), so the number of a' is floor(n/1).

For d >=2, the number of a' is floor((floor(n/d) - (d-1))/d) +1, if d-1
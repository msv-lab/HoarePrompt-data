Alright, I've got this problem to solve. Let's see what it's asking for.

So, Kirill wants to pick some mushrooms to make an elixir. Each mushroom has a magic power, and he wants to maximize the strength of the elixir. The strength is calculated as the product of the number of mushrooms he picks and the minimum magic power among those mushrooms. So, if he picks k mushrooms, the strength is k times the smallest magic power among those k mushrooms.

But there's a catch. There's a permutation p of numbers from 1 to n, and if he picks k mushrooms, the magic power of the first k-1 mushrooms in the permutation becomes zero. He can't use mushrooms with zero magic power in his elixir.

So, I need to help Kirill figure out which mushrooms to pick to maximize the elixir's strength, and among all the options that give the maximum strength, choose the one with the smallest number of mushrooms.

First, I need to understand the permutation p. It's a rearrangement of numbers from 1 to n, indicating some order in which the mushrooms are considered.

Let me think about this step by step.

Suppose Kirill picks k mushrooms. Then, the first k-1 mushrooms in the permutation p have their magic power set to zero. So, he can only use the remaining mushrooms that are not among the first k-1 in the permutation.

Wait, but he picks k mushrooms sequentially, and the magic power of the first k-1 mushrooms in the permutation becomes zero. So, perhaps the order in which he picks the mushrooms affects which mushrooms have their magic power zeroed out.

Hmm, maybe I need to think differently. Maybe the permutation p determines the order in which the mushrooms are considered, and depending on how many he picks, the previous ones in the permutation lose their magic power.

Let me try to rephrase the problem.

There are n mushrooms, each with a magic power v_i. There is a permutation p of 1 to n, which represents some order.

If Kirill picks k mushrooms, then the first k-1 mushrooms in the permutation p have their magic power set to zero, and he can't use them in his elixir.

So, he can only use the k-th mushroom in the permutation and the ones after that, but only the ones he picks.

Wait, no. The problem says: "the magic power of all mushrooms with indices p_1, p_2, ..., p_{k-1} will become 0." So, if he picks k mushrooms, the first k-1 in the permutation have their magic power set to zero.

But he can pick any k mushrooms, but the first k-1 in the permutation have zero magic power, meaning he can't use them.

Wait, no. He picks k mushrooms sequentially, meaning he picks the first k mushrooms in the order defined by the permutation p.

Wait, maybe I'm misunderstanding.

Let me read the problem again carefully.

"It is known that there are n mushrooms growing under the Oak, each of which has magic power v_i. Kirill really wants to make a magical elixir of maximum strength from the mushrooms.

The strength of the elixir is equal to the product of the number of mushrooms in it and the minimum magic power among these mushrooms. To prepare the elixir, Kirill will sequentially pick one mushroom growing under the Oak. Kirill can gather mushrooms in any order.

However, it's not that simple. The Wise Oak informed Kirill of a permutation of numbers p from 1 to n. If Kirill picks only k mushrooms, then the magic power of all mushrooms with indices p_1, p_2, ..., p_{k-1} will become 0. Kirill will not use mushrooms with zero magic power to prepare the elixir.

Your task is to help Kirill gather mushrooms in such a way that he can brew the elixir of maximum possible strength. However, Kirill is a little scared to stay near the oak for too long, so out of all the suitable options for gathering mushrooms, he asks you to find the one with the minimum number of mushrooms."

Okay, so Kirill picks k mushrooms, in some order defined by the permutation p. After picking k mushrooms, the first k-1 mushrooms in the permutation have their magic power set to zero.

Wait, no. It's a bit different.

The permutation p is given, and it defines a specific order. When Kirill picks k mushrooms, it's in the order specified by p. So, p is the order in which he picks the mushrooms.

So, if he picks k mushrooms, the first k-1 mushrooms in the permutation p have their magic power set to zero, meaning he can't use them in his elixir.

Wait, but he picks k mushrooms, so he can't use the first k-1 mushrooms in the permutation, meaning he can only use the k-th mushroom in the permutation and possibly others.

But it's a bit confusing.

Let me consider an example to understand better.

Take the first sample input:

3

9 8 14

3 2 1

So, n=3, v=[9,8,14], p=[3,2,1]

This means that in the order defined by p, the first mushroom picked is p[0]=3, then p[1]=2, then p[2]=1.

If Kirill picks k mushrooms, then the first k-1 mushrooms in the permutation have their magic power set to zero.

So, for k=1:

He picks only p[0]=3, and no mushrooms have their magic power set to zero (since k-1=0). So, he can use mushroom 3, which has v=14. The strength is 1*14=14.

For k=2:

He picks p[0]=3 and p[1]=2. The first k-1=1 mushroom, which is p[0]=3, has its magic power set to zero. So, mushroom 3 now has v=0, and he can't use it. He can only use mushroom 2, which has v=8. So, the strength is 1*8=8.

Wait, but he picked two mushrooms, but only one can be used.

Wait, no. He picks k mushrooms, but some of them have their magic power set to zero.

Wait, the problem says: "the magic power of all mushrooms with indices p_1, p_2, ..., p_{k-1} will become 0. Kirill will not use mushrooms with zero magic power to prepare the elixir."

So, in this case, for k=2, p_1=3 and p_2=2. So, mushrooms p_1=3 and p_2=2 have their magic power set to zero. Wait, it's p_1 to p_{k-1}, which is p_1=3. So, only mushroom 3 has its magic power set to zero.

Wait, no, p is a permutation, p[0]=3, p[1]=2, p[2]=1.

So, p_1=3, p_2=2, p_3=1.

If he picks k=2 mushrooms, then the first k-1=1 mushrooms, which is p_1=3, have their magic power set to zero.

So, mushroom 3 has v=0, and he can't use it.

He picked k=2 mushrooms, which are p_1=3 and p_2=2, but since p_1=3 has v=0, he can only use p_2=2, which has v=8.

So, the strength is 1*8=8.

Wait, but in the sample explanation, it says to pick mushrooms 1 and 2, with strength 2*8=16.

Wait, maybe I'm misunderstanding the picking process.

Wait, perhaps the mushrooms he picks are the first k in the permutation, but he can choose which k to pick.

Wait, re-reading the problem:

"Kirill can gather mushrooms in any order.

However, it's not that simple. The Wise Oak informed Kirill of a permutation of numbers p from 1 to n. If Kirill picks only k mushrooms, then the magic power of all mushrooms with indices p_1, p_2, ..., p_{k-1} will become 0. Kirill will not use mushrooms with zero magic power to prepare the elixir."

So, Kirill chooses to pick k mushrooms, and based on that k, the first k-1 mushrooms in the permutation p have their magic power set to zero.

He can choose any k, and for each k, the first k-1 in p have v=0.

Then, among the remaining mushrooms (those not having v=0), he can choose which ones to use in his elixir.

Wait, no. He picks k mushrooms, and the first k-1 in p have v=0, and he can't use those with v=0.

So, for each k, he picks the first k in p, sets the first k-1 to v=0, and can only use the k-th mushroom in p with its original v.

Wait, but in the sample explanation, he picks mushrooms 1 and 2, which correspond to p_3=1 and p_2=2, meaning k=2.

Wait, I'm getting more confused.

Let me look at the sample input and output.

Sample Input:

6

3

9 8 14

3 2 1

5

1 2 3 4 5

1 2 3 4 5

6

1 2 3 4 5 6

6 5 4 3 2 1

5

1 4 6 10 10

2 1 4 5 3

4

2 2 5 5

4 2 3 1

5

1 2 9 10 10

1 4 2 3 5

Sample Output:

16 2

9 3

8 2

20 2

5 1

20 2

So, for the first case, n=3, v=[9,8,14], p=[3,2,1]

He picks k=2 mushrooms, specifically mushrooms 1 and 2 (indices 1 and 2, since p[2]=1 and p[1]=2), and the first k-1=1 mushroom, which is p[1]=2, has its v set to zero.

Wait, p starts from p_1=3, p_2=2, p_3=1.

Wait, p is 1-indexed in the problem description.

Wait, no, in programming, lists are 0-indexed, but in the problem, p is a permutation of 1 to n, which is 1-indexed.

So, p_1=3, p_2=2, p_3=1.

If he picks k=2 mushrooms, then the first k-1=1 mushrooms, which is p_1=3, have their v set to zero.

So, mushroom 3 has v=0, and he can't use it.

He picked k=2 mushrooms, which are p_1=3 and p_2=2, but since p_1=3 has v=0, he can only use p_2=2, which has v=8.

So, he uses 1 mushroom with v=8, strength=1*8=8.

But according to the sample explanation, he picks mushrooms 1 and 2, with strength=2*8=16.

Wait, that doesn't match.

Wait, maybe I need to consider that he can pick any k mushrooms, not necessarily the first k in p.

Wait, re-reading the problem:

"Kirill can gather mushrooms in any order.

However, it's not that simple. The Wise Oak informed Kirill of a permutation of numbers p from 1 to n. If Kirill picks only k mushrooms, then the magic power of all mushrooms with indices p_1, p_2, ..., p_{k-1} will become 0. Kirill will not use mushrooms with zero magic power to prepare the elixir."

So, he can choose to pick any k mushrooms, but based on k, the first k-1 in the permutation p have their v set to zero.

Wait, no. It's conditional on k.

For a given k, the first k-1 in p have v=0.

Then, among the remaining mushrooms (those not having v=0), he can choose which ones to use.

Wait, but he has to pick exactly k mushrooms, but some of them have v=0 and can't be used.

Wait, no, he picks k mushrooms, and the first k-1 in p have v=0, and he can't use those.

Wait, perhaps I need to think differently.

Let me consider that for a given k, he picks the first k in p, sets the first k-1 to v=0, and can only use the remaining mushrooms that are not set to zero.

Wait, but in the sample, he picks mushrooms 1 and 2, which correspond to p_3=1 and p_2=2, meaning k=2.

Then, the first k-1=1 mushrooms in p, which is p_1=3, have v=0.

So, mushroom 3 has v=0, and he can't use it.

He picked mushrooms 1 and 2, but mushroom 3 is set to zero, which doesn't affect his picked mushrooms since he picked 1 and 2.

Wait, I'm getting confused.

Wait, perhaps I need to think in terms of choosing k, and based on k, determining which mushrooms have v=0, and then choosing which mushrooms to use in the elixir from the remaining ones.

Wait, perhaps I need to iterate over possible k and calculate the strength accordingly.

Let me try to formalize this.

For each possible k from 1 to n:

- Set the magic power of mushrooms p_1 to p_{k-1} to zero.

- Among the remaining mushrooms (those not set to zero), select up to k mushrooms with the highest magic powers.

- Calculate the strength as k times the minimum magic power among the selected mushrooms.

- Choose the k that maximizes this strength, and among those, choose the smallest k.

Wait, but he has to pick exactly k mushrooms, not up to k.

Wait, no, he picks exactly k mushrooms, but some of them may have their magic power set to zero based on k.

Wait, perhaps I need to consider that the first k-1 in p have v=0, and among the remaining mushrooms, he picks k mushrooms, but he can't use the ones with v=0.

So, he has to pick k mushrooms, but some of them may have v=0 and can't be used.

Wait, maybe I need to think differently.

Let me consider that for each k, he picks k mushrooms, and the first k-1 in p have v=0, so he can't use those.

So, he can only use the k-th mushroom in p and the ones after that, but he has to pick exactly k mushrooms.

Wait, perhaps it's better to iterate over k from 1 to n, compute the strength for each k, and choose the k that gives the maximum strength, and among those, choose the smallest k.

Let me try to compute for the first sample input.

n=3, v=[9,8,14], p=[3,2,1]

So, p_1=3, p_2=2, p_3=1

For k=1:

- Set p_1=3 to v=0

- So, v=[9,8,0]

- He picks 1 mushroom, which must be the k-th in p, which is p_1=3, but v=0, so he can't use it.

- So, strength=0

Wait, but according to the sample, he picks mushrooms 1 and 2, which correspond to k=2.

Wait, maybe I need to consider that he picks the first k in p, but can choose which ones to use, excluding those set to zero.

Wait, perhaps I need to consider that he picks the first k in p, sets the first k-1 to zero, and then chooses among the remaining mushrooms, not necessarily the first k.

Wait, maybe I need to consider that he picks any k mushrooms, and based on k, the first k-1 in p have v=0.

Then, he can only use the mushrooms that are not among the first k-1 in p.

Wait, perhaps it's better to think in terms of choosing a k and then choosing which mushrooms to pick, given that the first k-1 in p have v=0.

This is getting too convoluted. Maybe I need to look for a different approach.

Let me consider sorting the mushrooms by their magic power and trying to select a subset that maximizes the product of the number of mushrooms and the minimum magic power.

But I need to take into account the permutation p and the condition about setting the first k-1 mushrooms in p to zero.

Wait, maybe I can consider the permutation p as a fixed order, and think about selecting a subset of mushrooms such that the number of mushrooms before the selected subset in p is k-1.

Wait, perhaps I need to consider the position of the selected mushrooms in the permutation p.

Let me try to think differently.

Suppose I fix the minimum magic power m that I want to use in the elixir.

Then, I need to select at least k mushrooms with magic power at least m, and ensure that among the first k-1 in p, none of them are in the selected mushrooms.

Wait, that might be too complicated.

Maybe I should look for a way to maximize k * m, where m is the minimum magic power among the selected k mushrooms, considering that the first k-1 mushrooms in p have zero magic power.

Wait, perhaps I need to iterate over possible m and find the maximum k for which I can select k mushrooms with magic power at least m, and the first k-1 in p have v=0.

This seems too vague.

Let me try to think about the sample input again.

n=3, v=[9,8,14], p=[3,2,1]

He picks k=2 mushrooms, specifically mushrooms 1 and 2.

So, p_1=3, p_2=2.

Set p_1=3 to v=0, so v=[9,8,0]

He picks mushrooms 1 and 2, which have v=9 and 8, so the minimum is 8, and strength=2*8=16.

Wait, but according to the permutation, he picks p_1=3 and p_2=2, but sets p_1=3 to v=0.

So, he picks mushrooms 3 and 2, but mushroom 3 has v=0, so he can only use mushroom 2 with v=8.

So, strength=1*8=8, but the sample explanation says 2*8=16.

Wait, maybe I'm misunderstanding the problem.

Wait, perhaps he picks k mushrooms in the order specified by p, sets the first k-1 to v=0, and then uses the remaining mushrooms that are not set to zero among the picked ones.

In this case, for k=2:

- Picks p_1=3 and p_2=2

- Sets p_1=3 to v=0

- So, among the picked mushrooms, only p_2=2 has v=8, so strength=1*8=8

But the sample output is 16, which suggests that he picks mushrooms 1 and 2, which correspond to p_3=1 and p_2=2.

Wait, perhaps the "picking" is not strictly in the order of p.

Wait, re-reading the problem:

"Kirill can gather mushrooms in any order.

However, it's not that simple. The Wise Oak informed Kirill of a permutation of numbers p from 1 to n. If Kirill picks only k mushrooms, then the magic power of all mushrooms with indices p_1, p_2, ..., p_{k-1} will become 0. Kirill will not use mushrooms with zero magic power to prepare the elixir."

So, for a given k, the first k-1 mushrooms in p have their magic power set to zero, and he can't use them.

Then, he picks k mushrooms from the remaining mushrooms (excluding the first k-1 in p).

Wait, perhaps I need to consider that he picks k mushrooms, and the first k-1 in p have v=0, and he can't use those.

Wait, maybe I need to consider that the first k-1 mushrooms in p have v=0 regardless of which k mushrooms he picks.

Wait, perhaps it's better to think that for a given k, the first k-1 mushrooms in p have v=0, and he picks k mushrooms from the remaining mushrooms, but he can't use the ones with v=0.

So, for k=2:

- Set p_1=3 to v=0

- Then, he picks k=2 mushrooms, but can't use mushroom 3, which has v=0

- So, he picks mushrooms 1 and 2, both with v=9 and 8, respectively

- The minimum among them is 8, so strength=2*8=16

Ah, maybe I misinterpreted the earlier step.

Wait, perhaps he picks k mushrooms, and among those k, the first k-1 in p have v=0.

Wait, perhaps it's better to think that among the k mushrooms he picks, the first k-1 in the permutation p have v=0.

Wait, I'm getting more confused.

Let me try to think differently.

Let me consider that for a given k, he picks k mushrooms, and the first k-1 mushrooms in p among those k have v=0.

Wait, perhaps it's better to consider that the first k-1 mushrooms in p, regardless of whether they are picked or not, have v=0.

Wait, maybe I need to consider that for a given k, the first k-1 mushrooms in p have v=0, and he picks k mushrooms from the remaining mushrooms.

Wait, but in the sample, for k=2, p_1=3 has v=0, and he picks mushrooms 1 and 2, which are not affected by v=0.

Wait, perhaps I need to consider that the first k-1 mushrooms in p have v=0, and he picks k mushrooms from all mushrooms, but can't use the ones with v=0.

So, for k=2:

- Set p_1=3 to v=0

- Pick k=2 mushrooms, but can't use mushroom 3, which has v=0

- So, he picks mushrooms 1 and 2, with v=9 and 8, respectively

- The minimum among them is 8, so strength=2*8=16

This matches the sample output.

So, for a given k, set the first k-1 mushrooms in p to v=0, and then pick k mushrooms, excluding those with v=0.

Wait, but in this case, he picks k mushrooms, but can't use the ones with v=0.

Wait, perhaps he picks k mushrooms, sets the first k-1 in p to v=0, and then uses only the mushrooms among the k that have v > 0.

Wait, perhaps I need to think that he picks k mushrooms, and the first k-1 in p have v=0, and he can't use those.

Wait, I'm still confused.

Let me try to think in terms of choosing k mushrooms, and then determining which ones have v=0 based on their positions in p.

Wait, perhaps it's better to consider that for a given k, the first k-1 mushrooms in p have v=0, and he picks k mushrooms, but can only use those among the k that have v > 0.

So, for k=2:

- Set p_1=3 to v=0

- Pick mushrooms 1 and 2, which have v=9 and 8, respectively

- Both have v > 0, so he can use both

- The minimum is 8, strength=2*8=16

For k=1:

- Set no mushroom to v=0 (k-1=0)

- Pick mushroom 1, with v=9

- Strength=1*9=9

For k=3:

- Set p_1=3 and p_2=2 to v=0

- Pick mushrooms 1,2,3, with v=9,8,0

- Only mushrooms 1 and 2 can be used, with v=9 and 8

- The minimum is 8, strength=2*8=16

So, the maximum strength is 16, and the minimum k is 2.

This matches the sample output.

So, the approach should be:

- For each possible k from 1 to n:

- Set the first k-1 mushrooms in p to v=0

- Pick k mushrooms, but only use those with v > 0

- Calculate the strength as the number of used mushrooms (with v > 0) times the minimum v among them

- Choose the k that gives the maximum strength, and among those, choose the smallest k.

But this seems inefficient for n up to 200,000.

I need a better way to compute this efficiently.

Let me try to find a smarter way.

Let me consider sorting the mushrooms by their magic power and trying to select a subset that maximizes the product.

But I need to consider the permutation p as well.

Wait, perhaps I can sort the mushrooms in decreasing order of v and try to select the top k mushrooms, considering the positions in p.

Wait, maybe I can sort the mushrooms in decreasing order of v and assign them positions based on p.

Wait, perhaps I need to sort the mushrooms by their v in decreasing order and try to select a subset where the positions in p are beyond a certain point.

This is getting too vague.

Let me think about the following approach:

- Sort the mushrooms in decreasing order of v.

- Then, for each possible k, find the smallest k such that the k-th mushroom in this sorted list has a position in p that is after the first k-1 positions in p.

Wait, maybe I need to sort the mushrooms by v in decreasing order and then find the best k.

Wait, perhaps I need to consider the positions of the mushrooms in p and their v.

Wait, maybe I can sort the mushrooms by v in decreasing order and then, for each k, find the smallest k such that the sum of the first k mushrooms' v is maximized, considering the positions in p.

This seems too convoluted.

Let me try to think differently.

Suppose I fix k and try to maximize the minimum v among the k mushrooms, considering that the first k-1 mushrooms in p have v=0.

Wait, perhaps I can iterate over the possible minimum v and find the maximum k for which I can select k mushrooms with v at least that value, considering the positions in p.

Wait, maybe I need to sort the mushrooms by v in decreasing order and then assign them positions based on p.

Wait, perhaps I need to sort the mushrooms by v in decreasing order and then select the top k mushrooms, excluding those that are among the first k-1 in p.

Wait, maybe I need to sort the mushrooms by v in decreasing order and then, for each k, find the smallest k such that the k-th mushroom is not among the first k-1 in p.

This seems promising.

Let me try to formalize this.

Sort the mushrooms in decreasing order of v: s[0], s[1], ..., s[n-1]

Then, for each k from 1 to n:

- Set the first k-1 mushrooms in p to v=0

- Pick the top k mushrooms from s, but exclude those with v=0

- Calculate the strength as the number of picked mushrooms with v > 0 times the minimum v among them

Wait, but this is similar to the earlier approach.

I need a better way to compute this efficiently.

Let me consider the following approach:

- Sort the mushrooms in decreasing order of v.

- Then, for each k from 1 to n, find the smallest k such that the k-th mushroom in the sorted list is not among the first k-1 in p.

- Calculate the strength for each k and choose the maximum.

Wait, perhaps I need to sort the mushrooms by v in decreasing order and then iterate through k, keeping track of the positions in p.

Wait, maybe I need to sort the mushrooms by v in decreasing order and then, for each k, find the smallest k such that the k-th mushroom is not among the first k-1 in p.

This seems too vague.

Let me try to think in terms of the positions in p.

Let me map each mushroom to its position in p.

For example, in the first sample:

n=3, v=[9,8,14], p=[3,2,1]

So, position in p:

- mushroom 1: p[2]=1

- mushroom 2: p[1]=2

- mushroom 3: p[0]=3

Wait, no, p is 1-indexed, but lists are 0-indexed in programming.

Wait, in programming, lists are 0-indexed, but in the problem, p is a permutation of 1 to n, which is 1-indexed.

So, p[0]=3, p[1]=2, p[2]=1

So, the positions are:

- mushroom 1: position 2

- mushroom 2: position 1

- mushroom 3: position 0

So, for k=2:

- Set the first k-1=1 mushrooms in p to v=0, which is p[0]=3

- So, mushroom 3 has v=0

- Then, pick k=2 mushrooms, which can be mushrooms 1 and 2, with v=9 and 8

- The minimum is 8, strength=2*8=16

Wait, but according to the permutation, p[0]=3, p[1]=2, p[2]=1

So, positions:

- mushroom 1: position 2

- mushroom 2: position 1

- mushroom 3: position 0

So, for k=2:

- Set p[0]=3 to v=0

- Pick k=2 mushrooms, say mushrooms 1 and 2, with v=9 and 8

- The minimum is 8, strength=2*8=16

For k=1:

- Set no mushroom to v=0

- Pick mushroom 1, with v=9

- Strength=1*9=9

For k=3:

- Set p[0]=3 and p[1]=2 to v=0

- Pick mushrooms 1,2,3, with v=9,8,0

- Only mushrooms 1 and 2 can be used, with v=9 and 8

- The minimum is 8, strength=2*8=16

So, maximum strength is 16, and the minimum k is 2.

This matches the sample.

So, perhaps I can iterate over k from 1 to n, set the first k-1 mushrooms in p to v=0, pick k mushrooms, use only those with v > 0, and calculate the strength.

But this is O(n^2), which is too slow for n=200,000.

I need a smarter way.

Let me consider sorting the mushrooms by v in decreasing order and then selecting the top k mushrooms, excluding those set to zero.

Wait, perhaps I can sort the mushrooms by v in decreasing order and then, for each k, find the smallest k such that the k-th mushroom is not among the first k-1 in p.

Wait, maybe I need to sort the mushrooms by v in decreasing order and then keep track of their positions in p.

Let me try to sort the mushrooms by v in decreasing order and store their positions in p.

For the first sample:

v=[14,9,8], positions in p=[0,2,1]

So, sorted by v:

- mushroom 3: v=14, position=0

- mushroom 1: v=9, position=2

- mushroom 2: v=8, position=1

Now, for each possible k, I need to set the first k-1 in p to v=0.

Wait, perhaps I can iterate k from 1 to n and keep track of the mushrooms that are set to zero.

Wait, maybe I need to iterate k from 1 to n, set p[0] to p[k-2] to zero, and then pick k mushrooms with v > 0, and calculate the strength.

But this is still O(n^2).

I need a better approach.

Let me consider that for a given k, the first k-1 mushrooms in p have v=0.

So, I can precompute for each k, which mushrooms have v=0.

But n can be up to 200,000, so I need something faster.

Wait, perhaps I can sort the mushrooms by v in decreasing order and then, for each k, find the smallest k such that the k-th mushroom is not among the first k-1 in p.

Wait, maybe I need to sort the mushrooms by v in decreasing order and then, for each k, find the smallest k such that the sum of the indicators that the mushroom is not among the first k-1 in p is at least k.

Wait, perhaps I need to sort the mushrooms by v in decreasing order and then, for each k, find the smallest k such that among the top k mushrooms, at least k of them are not among the first k-1 in p.

This seems promising.

Let me try to formalize this.

Sort the mushrooms by v in decreasing order: s[0], s[1], ..., s[n-1], where s[0] has the highest v.

Compute for each k from 1 to n:

- Set the first k-1 mushrooms in p to v=0

- Among the top k mushrooms in s, count how many have v > 0

- If the count is m, then the strength is m * s[k-1]

- Choose the maximum among these strengths, and among those, choose the smallest k.

Wait, perhaps I need to iterate k from 1 to n, set the first k-1 mushrooms in p to v=0, then select the top k mushrooms in s, count how many of them have v > 0, and calculate the strength.

But this is still O(n^2).

I need a better way.

Let me consider that the mushrooms are sorted in decreasing order of v: s[0], s[1], ..., s[n-1]

Then, for a given k, the minimum v among the selected k mushrooms is s[k-1]

Now, I need to ensure that among these k mushrooms, at least m have v > 0, where m is the number of mushrooms not set to zero.

Wait, perhaps I can precompute for each k, how many mushrooms among the top k in s have v > 0, given that the first k-1 in p have v=0.

Wait, maybe I need to find for each k, the number of top k mushrooms in s that are not among the first k-1 in p.

Because the first k-1 in p have v=0, and I can't use them.

So, for each k, the number of top k mushrooms in s that are not among the first k-1 in p is the number of mushrooms I can use.

Let me define pos[i] as the position of mushroom i in p.

For example, in the first sample:

pos = [2,1,0]

So, for k=2:

- Set the first k-1=1 mushroom in p to v=0, which is p[0]=3

- So, mushroom 3 has v=0

- Among the top k=2 mushrooms in s: s[0]=3 (v=14), s[1]=1 (v=9)

- Mushroom 3 has v=0, so only mushroom 1 can be used, m=1

- Strength=1*9=9

Wait, but in the sample, it's 16.

Wait, perhaps I need to adjust this.

Wait, in the sample, for k=2, he picks mushrooms 1 and 2, with v=9 and 8, minimum is 8, strength=16.

But according to this, for k=2, m=1, strength=1*9=9, which is not matching.

Wait, perhaps I need to consider that m is the number of mushrooms among the top k in s that are not set to zero.

In this case, for k=2:

- Set p[0]=3 to v=0

- Top k=2 mushrooms in s: s[0]=3 (v=14), s[1]=1 (v=9)

- Mushroom 3 has v=0, so only mushroom 1 can be used, m=1, strength=1*9=9

But in reality, he picks mushrooms 1 and 2, with v=9 and 8, minimum is 8.

So, perhaps I need to consider that m is the number of mushrooms among the top k in s that are not set to zero, but also consider that he picks k mushrooms, so m could be up to k.

Wait, perhaps I need to consider that among the top k in s, the number of mushrooms that are not set to zero is m, and the minimum v is the smallest v among these m mushrooms.

Wait, perhaps I need to sort the mushrooms by v in decreasing order and then, for each k, find the smallest k such that among the top k in s, there are at least m mushrooms not set to zero, and then take m * s[k-1]

But this is getting too complicated.

Let me try to think differently.

Let me consider that for a given k, the first k-1 mushrooms in p have v=0.

So, I can precompute for each k, which mushrooms have v=0.

But this is O(n^2).

I need a better way.

Let me consider that the strength is k * min_v, where min_v is the smallest v among the selected mushrooms with v > 0.

I need to maximize k * min_v.

I can iterate over min_v and find the maximum k for which there are at least k mushrooms with v >= min_v, excluding the first k-1 in p.

Wait, perhaps I can sort the mushrooms by v in decreasing order and then iterate through possible min_v.

Let me sort the mushrooms by v in decreasing order: s[0], s[1], ..., s[n-1]

Then, for each possible min_v = s[i], I can consider selecting the top i+1 mushrooms, but excluding those that are among the first k-1 in p.

Wait, perhaps I need to find, for each possible min_v, the maximum k such that there are at least k mushrooms with v >= min_v, excluding the first k-1 in p.

Wait, perhaps I need to sort the mushrooms by v in decreasing order and then, for each k, find the smallest k such that among the top k in s, at least m mushrooms are not among the first k-1 in p.

Wait, I'm going in circles.

Let me try to think about the positions.

Let me map each mushroom to its position in p.

So, pos[i] = position of mushroom i in p.

For example, in the first sample:

pos = [2,1,0]

Now, for a given k, the first k-1 positions in p have v=0.

So, for k=2:

- Set p[0]=3 to v=0

- So, mushroom 3 has v=0

- Then, among the remaining mushrooms, he picks k=2 mushrooms, which can be mushrooms 1 and 2, with v=9 and 8

- The minimum is 8, strength=2*8=16

Wait, but according to my earlier approach, m=2, min_v=8, strength=16

Wait, perhaps I need to consider that m is the number of mushrooms among the top k in s that are not set to zero.

Wait, perhaps I need to iterate k from 1 to n, set the first k-1 mushrooms in p to v=0, sort the remaining mushrooms by v, and pick the top k mushrooms with v > 0.

But again, this is O(n^2).

I need a better way.

Let me consider that for a given k, the first k-1 mushrooms in p have v=0.

So, I can create a list where the first k-1 mushrooms in p have v=0, and the rest have their original v.

Then, I can select the top k mushrooms with v > 0 and calculate the strength.

But
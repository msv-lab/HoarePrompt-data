Alright, I've got this problem to solve. Let's see what it's asking for.

So, there are n mushrooms, each with a magic power value v_i. Kirill wants to pick some mushrooms to make an elixir, and the strength of this elixir is the product of the number of mushrooms he picks and the minimum magic power among those mushrooms. That sounds straightforward, but there's a twist.

There's a permutation p of numbers from 1 to n, and if Kirill picks k mushrooms, then the magic power of mushrooms at positions p_1 through p_{k-1} becomes zero. He can't use mushrooms with zero magic power in his elixir. So, I need to help Kirill pick the mushrooms in such a way that he maximizes the elixir strength, and among all options that give the maximum strength, he picks the one with the minimum number of mushrooms.

First, I need to understand the permutation p. It's a sequence of numbers from 1 to n in some order. So, p_1 is the first number in this sequence, p_2 is the second, and so on, up to p_n.

When Kirill picks k mushrooms, the mushrooms at positions p_1 through p_{k-1} have their magic power set to zero. That means, if he picks k mushrooms, the first k-1 mushrooms in the permutation p have their values set to zero.

Wait, so the permutation p determines which mushrooms lose their magic power based on how many mushrooms Kirill picks. If he picks k mushrooms, the first k-1 mushrooms in p have their magic power set to zero.

So, the idea is that Kirill picks k mushrooms, but in doing so, the first k-1 mushrooms in p have their magic power set to zero, and he can't use those in his elixir.

Therefore, the mushrooms he can actually use are:

- The k mushrooms he picks, but excluding any that have their magic power set to zero because of the first k-1 positions in p.

Wait, no. Actually, the problem says: "The magic power of all mushrooms with indices p_1, p_2, ..., p_{k - 1} will become 0. Kirill will not use mushrooms with zero magic power to prepare the elixir."

So, when he picks k mushrooms, the mushrooms at positions p_1 through p_{k-1} have their magic power set to zero, and he cannot use those in his elixir.

Therefore, the mushrooms he can use are those not among p_1 through p_{k-1}.

Wait, but he picks k mushrooms, but some of them might be among p_1 through p_{k-1}, and those would have their magic power set to zero.

Wait, no. The problem says: "The magic power of all mushrooms in positions p_1 through p_{k-1} becomes zero, and Kirill will not use those in his elixir."

So, regardless of which mushrooms he picks, the mushrooms at positions p_1 through p_{k-1} have their magic power set to zero and cannot be used.

But Kirill picks k mushrooms, and among those k, some might be from p_1 to p_{k-1}, which have zero magic power.

Wait, but the problem says he won't use mushrooms with zero magic power. So, even if he picks them, he can't use them in the elixir.

Therefore, the elixir is made only from the mushrooms he picks that are not among p_1 to p_{k-1}.

Wait, but the problem says: "Kirill will not use mushrooms with zero magic power to prepare the elixir."

So, the elixir is made from the mushrooms he picks, but excluding those whose magic power is zero, which are those in positions p_1 to p_{k-1}.

Wait, but if he picks a mushroom that is in p_1 to p_{k-1}, its magic power is set to zero, and he can't use it in the elixir.

So, the elixir is made from the mushrooms he picks that are not in p_1 to p_{k-1}.

Therefore, the number of mushrooms in the elixir is k minus the number of mushrooms in p_1 to p_{k-1} that he picks.

Wait, but actually, it's simpler: the elixir is made from the mushrooms he picks, excluding those that are in p_1 to p_{k-1}, because their magic power is zero.

So, the elixir's strength is (number of picked mushrooms not in p_1 to p_{k-1}) times the minimum magic power among the picked mushrooms that are not in p_1 to p_{k-1}.

Wait, but the problem says: "The strength of the elixir is equal to the product of the number of mushrooms in it and the minimum magic power among these mushrooms."

And "Kirill will not use mushrooms with zero magic power to prepare the elixir."

So, the elixir is made from the picked mushrooms that are not in p_1 to p_{k-1}, since those have zero magic power.

Hence, the strength is (number of picked mushrooms not in p_1 to p_{k-1}) times the minimum magic power among the picked mushrooms not in p_1 to p_{k-1}.

Wait, but actually, the minimum magic power among the picked mushrooms that are not in p_1 to p_{k-1} is the same as the minimum magic power among all picked mushrooms, since those in p_1 to p_{k-1} have zero magic power.

Wait, no. The minimum magic power among the mushrooms in the elixir is the minimum of the magic powers of the picked mushrooms that are not in p_1 to p_{k-1}.

Because the mushrooms in p_1 to p_{k-1} have zero magic power and are not used in the elixir.

So, the strength is (number of picked mushrooms not in p_1 to p_{k-1}) times the minimum magic power among the picked mushrooms not in p_1 to p_{k-1}.

But this seems a bit convoluted. Maybe there's a better way to think about it.

Let me try to rephrase: When Kirill picks k mushrooms, the first k-1 positions in p have their magic power set to zero, and he can't use those in the elixir.

So, the elixir is made from the picked mushrooms excluding those in p_1 to p_{k-1}.

Wait, but p_1 to p_{k-1} are the positions whose magic power is set to zero, regardless of whether he picks them or not.

So, in the elixir, he can only use the picked mushrooms that are not in p_1 to p_{k-1}.

Hence, the number of mushrooms in the elixir is the number of picked mushrooms that are not in p_1 to p_{k-1}, and the minimum magic power is the minimum among these mushrooms.

I think that's the key.

Now, I need to maximize this strength, which is the product of the number of mushrooms in the elixir and the minimum magic power among them, and among all such options, choose the one with the smallest number of picked mushrooms.

So, I need to find the smallest k such that the strength is maximized.

This sounds tricky. Let's think about how to approach this.

First, I need to consider different values of k and see what the corresponding strength would be.

But n can be up to 200,000, so I need an efficient way to compute this.

Let me consider sorting the mushrooms in some way.

Wait, but the permutation p affects which mushrooms have their magic power set to zero based on k.

Hmm.

Let me try to think differently.

Suppose I fix the minimum magic power of the elixir to be m, and then find the smallest k such that I can pick k mushrooms, with at least some number of them having magic power at least m, and not being in p_1 to p_{k-1}.

But this seems complicated.

Maybe I should look at the example to get some intuition.

Looking at the first example:

n = 3

v = [9, 8, 14]

p = [3, 2, 1]

So, positions are 1,2,3.

If k=1:

- p_1 is 3, so mushroom at position 3 has its magic power set to zero.

- Kirill picks 1 mushroom, excluding the one at position 3 (which has zero magic power), so he can pick either position 1 or 2.

- If he picks position 1: number of mushrooms in elixir is 1, minimum magic power is 9, strength is 1*9=9.

- If he picks position 2: number of mushrooms in elixir is 1, minimum magic power is 8, strength is 1*8=8.

- So, maximum strength is 9 with k=1.

Wait, but in the sample output, it's 16 with k=2.

Wait, perhaps I miscalculated.

Wait, let's see for k=2.

- p_1 and p_2 are 3 and 2, so mushrooms at positions 3 and 2 have their magic power set to zero.

- Kirill picks 2 mushrooms, but positions 2 and 3 have zero magic power, so he can only use the mushroom at position 1.

- So, number of mushrooms in elixir is 1 (only position 1), minimum magic power is 9, strength is 1*9=9.

Wait, that's the same as when k=1.

Wait, but according to the sample output, it's 16 with k=2.

So, perhaps I'm misunderstanding something.

Wait, perhaps I need to consider that when picking k mushrooms, the magic power of p_1 to p_{k-1} is set to zero, not p_1 to p_k.

Wait, no, it's p_1 to p_{k-1}.

Wait, in the first sample, n=3, v=[9,8,14], p=[3,2,1].

So, positions are 1,2,3.

Let's consider k=2:

- p_1 and p_2 are 3 and 2, so mushrooms at positions 3 and 2 have magic power set to zero.

- Kirill picks 2 mushrooms, but positions 2 and 3 have zero magic power, so only position 1 has non-zero magic power.

- So, number of mushrooms in elixir is 1 (position 1), minimum magic power is 9, strength is 1*9=9.

But according to the sample, it's 16 with k=2.

Wait, perhaps I'm misunderstanding how the elixir is prepared.

Wait, perhaps the elixir is made from all picked mushrooms except those in p_1 to p_{k-1}, regardless of whether they are picked or not.

Wait, no, that can't be.

Wait, perhaps I need to think differently.

Let's consider that when Kirill picks k mushrooms, the magic power of p_1 to p_{k-1} is set to zero, and he cannot use those in the elixir.

So, the elixir is made from the picked mushrooms that are not in p_1 to p_{k-1}.

Hence, the number of mushrooms in the elixir is k minus the number of picked mushrooms that are in p_1 to p_{k-1}.

Wait, but in the first sample, for k=2:

- p_1 and p_2 are 3 and 2.

- Kirill picks 2 mushrooms; suppose he picks positions 1 and 2.

- But position 2 has its magic power set to zero, so only position 1 is usable, hence strength is 1*9=9.

- If he picks positions 1 and 3:

- position 3 has its magic power set to zero, so only position 1 is usable, strength is 1*9=9.

- If he picks positions 2 and 3:

- both positions 2 and 3 have their magic power set to zero, so no mushrooms in the elixir, strength is 0*0=0.

Hence, for k=2, the maximum strength is 9.

But according to the sample, it's 16 with k=2.

Wait, perhaps I'm missing something.

Wait, maybe the strength is calculated before setting the magic power to zero.

Wait, no, the problem says: "The magic power of all mushrooms with indices p_1, p_2, ..., p_{k - 1} will become 0. Kirill will not use mushrooms with zero magic power to prepare the elixir."

So, first, the magic power of p_1 to p_{k-1} is set to zero, and then Kirill picks k mushrooms, excluding those with zero magic power.

Wait, but in the sample explanation, it says: "you need to take the mushrooms with indices 1 and 2, so the strength of the elixir is equal to 2 * min(a_1, a_2) = 2 * min(9,8) = 2*8 = 16."

Wait, but according to the problem, if k=2, p_1 and p_2 are 3 and 2, so mushroom 3's magic power is set to zero.

Then, Kirill picks 2 mushrooms; if he picks 1 and 2, mushroom 2 has zero magic power, so only mushroom 1 is usable, strength is 1*9=9.

But according to the sample, it's 16, which is 2*8.

Wait, perhaps I need to consider that the magic power is set to zero only for p_1 to p_{k-1}, which are 3 and 2 when k=2.

So, positions 3 and 2 have zero magic power.

Then, if Kirill picks positions 1 and 2, only position 1 is usable, strength is 1*9=9.

If he picks positions 1 and 3, only position 1 is usable, strength is 1*9=9.

If he picks positions 2 and 3, neither is usable, strength is 0*0=0.

Hence, maximum strength is 9 with k=1 or k=2.

But according to the sample, it's 16, which suggests that the strength is calculated differently.

Wait, perhaps the strength is k times the minimum magic power among all picked mushrooms, excluding those with zero magic power.

But in the sample explanation, it says "the strength of the elixir is equal to 2 * min(a_1, a_2) = 2*8=16."

Wait, but a_1=9 and a_2=8, so min is 8, times 2 is 16.

But according to the problem, p_1 and p_2 are 3 and 2, so positions 3 and 2 have zero magic power.

If he picks positions 1 and 2, only position 1 is usable, so why is it 2*8?

This is confusing.

Wait, perhaps the "number of mushrooms in it" includes the ones with zero magic power.

Wait, but the problem says "Kirill will not use mushrooms with zero magic power to prepare the elixir."

So, I think the elixir only includes mushrooms with non-zero magic power.

Hence, in the sample, for k=2, picking positions 1 and 2, only position 1 is usable, so number of mushrooms is 1, min magic power is 9, strength is 9.

But according to the sample, it's 16, which is 2*8.

So, perhaps the "number of mushrooms in it" is k, and "the minimum magic power among these mushrooms" is the min of the picked mushrooms, excluding those with zero magic power.

Wait, in the sample, picking positions 1 and 2: k=2, min among usable mushrooms is 9, so strength is 2*9=18.

But according to the sample, it's 16.

Wait, perhaps I'm misinterpreting the problem.

Let me read it again carefully.

"The strength of the elixir is equal to the product of the number of mushrooms in it and the minimum magic power among these mushrooms."

"Kirill will not use mushrooms with zero magic power to prepare the elixir."

So, the "number of mushrooms in it" refers to the number of mushrooms used in the elixir, which excludes those with zero magic power.

And "the minimum magic power among these mushrooms" refers to the minimum among the mushrooms used in the elixir, i.e., those with non-zero magic power.

Hence, in the sample, for k=2, picking positions 1 and 2: only position 1 is usable, so number of mushrooms is 1, min magic power is 9, strength is 9.

But according to the sample, it's 16, which suggests that perhaps "the number of mushrooms in it" is k, regardless of how many are usable.

Wait, but that contradicts the problem statement.

Wait, perhaps I need to think differently.

Let me consider that "these mushrooms" refers to the picked mushrooms, not the ones used in the elixir.

So, perhaps "the strength of the elixir is equal to the product of the number of mushrooms in it and the minimum magic power among the picked mushrooms."

And "Kirill will not use mushrooms with zero magic power to prepare the elixir."

So, perhaps the "number of mushrooms in it" is the number of picked mushrooms with non-zero magic power, and "the minimum magic power among these mushrooms" is the minimum among those with non-zero magic power.

In the sample, for k=2:

- p_1 and p_2 are 3 and 2, so positions 3 and 2 have zero magic power.

- Kirill picks positions 1 and 2.

- Only position 1 has non-zero magic power (9).

- So, number of mushrooms in elixir is 1, min magic power is 9, strength is 9.

But according to the sample, it's 16, which is 2*8.

This suggests that perhaps "the number of mushrooms in it" is k, and "the minimum magic power among these mushrooms" is the minimum among the picked mushrooms, excluding those with zero magic power.

Hence, strength is k times the min among picked mushrooms with non-zero magic power.

In the sample, picking positions 1 and 2: k=2, min among picked mushrooms with non-zero magic power is 9, strength is 2*9=18.

But according to the sample, it's 16, which is 2*8.

This doesn't match.

Wait, perhaps I need to consider that the minimum is taken over all picked mushrooms, including those with zero magic power, but then multiplied by k.

But that doesn't make sense because the problem says "the minimum magic power among these mushrooms", meaning among the ones used in the elixir, which exclude those with zero magic power.

I'm getting confused.

Let me look at another sample.

Second sample:

n=5

v=[1,2,3,4,5]

p=[1,2,3,4,5]

Sample output: 9 3

Let's see for k=3:

- p_1, p_2, p_3 are 1,2,3.

- So, positions 1,2,3 have zero magic power.

- Kirill picks 3 mushrooms; suppose he picks positions 4 and 5 (since 1,2,3 are zero), but he needs to pick 3 mushrooms, so he has to pick one from 1,2,3, which have zero magic power.

- So, if he picks positions 3,4,5: positions 1 and 2 have zero magic power, but he picked position 3, which has zero magic power, so only positions 4 and 5 are usable, with magic powers 4 and 5, min is 4, strength is 2*4=8.

- If he picks positions 2,4,5: positions 1 and 2 have zero magic power, so only positions 4 and 5 are usable, strength 2*4=8.

- If he picks positions 1,4,5: positions 1,2,3 have zero magic power, so only positions 4 and 5 are usable, strength 2*4=8.

- If he picks positions 3,4,5: same as above.

Wait, but according to the sample, it's 9, which is 3*3.

Wait, how can he get 3*3=9?

If he picks positions 3,4,5, but position 3 has zero magic power, so only positions 4 and 5 are usable, strength is 2*4=8.

Wait, maybe if he picks positions 2,3,4: positions 1,2,3 have zero magic power, so only position 4 is usable, strength is 1*4=4.

Wait, that's worse.

Wait, perhaps I'm missing something fundamental.

Let me try to think differently.

Suppose Kirill picks k mushrooms in some order, and the permutation p determines which mushrooms have their magic power set to zero based on the first k-1 picks.

Wait, but the problem says: "If Kirill picks only k mushrooms, then the magic power of all mushrooms with indices p_1, p_2, ..., p_{k - 1} will become 0."

So, regardless of which mushrooms he picks, the first k-1 positions in p have their magic power set to zero.

Then, Kirill picks k mushrooms, and among those, he cannot use the ones whose positions are among p_1 to p_{k-1}.

Wait, perhaps I need to consider that the positions p_1 to p_{k-1} have their magic power set to zero before Kirill picks the mushrooms.

Hence, when he picks k mushrooms, he picks from the remaining mushrooms, some of which have zero magic power.

He can pick mushrooms with zero magic power, but he won't use them in the elixir.

Hence, the elixir is made from the picked mushrooms that are not among p_1 to p_{k-1}.

Wait, but p_1 to p_{k-1} have their magic power set to zero before picking.

Hence, when Kirill picks k mushrooms, some of them might have zero magic power, and he won't use those in the elixir.

So, the strength is (number of picked mushrooms with non-zero magic power) times (minimum magic power among those picked mushrooms with non-zero magic power).

Wait, but in the first sample, for k=2:

- p_1 and p_2 are 3 and 2, so positions 3 and 2 have zero magic power.

- Kirill picks 2 mushrooms; suppose he picks positions 1 and 2.

- Among them, position 2 has zero magic power, so only position 1 is usable, with magic power 9.

- Hence, strength is 1*9=9.

But according to the sample, it's 16, which suggests that perhaps the strength is k times the minimum among all picked mushrooms, including those with zero magic power.

Wait, but that doesn't make sense because the ones with zero magic power are not used.

Wait, maybe the minimum is taken over all picked mushrooms, including those with zero magic power.

So, in this case, picking positions 1 and 2: the picked mushrooms have magic powers 9 and 0, so the minimum is 0, and strength is 2*0=0.

But that can't be, because in the sample, it's 16.

Wait, perhaps I need to consider that the minimum is taken over only the mushrooms with non-zero magic power, and the count is k, not the number of non-zero mushrooms.

Wait, but that seems inconsistent.

Wait, perhaps the strength is k times the minimum among the picked mushrooms with non-zero magic power.

In this case, picking positions 1 and 2: k=2, min among non-zero is 9, strength=2*9=18.

But according to the sample, it's 16, which is 2*8.

Hmm.

Wait, maybe I need to consider that the permutation p determines which mushrooms have their magic power set to zero after picking.

Wait, no, the problem says: "If Kirill picks only k mushrooms, then the magic power of all mushrooms with indices p_1, p_2, ..., p_{k - 1} will become 0."

So, it's based on k, not on which mushrooms are picked.

Hence, p_1 to p_{k-1} have their magic power set to zero, regardless of which mushrooms are picked.

Then, Kirill picks k mushrooms, and among those, he cannot use the ones that are in p_1 to p_{k-1}, because their magic power is zero.

Hence, the elixir is made from the picked mushrooms that are not in p_1 to p_{k-1}.

Wait, but in the first sample, p_1 and p_2 are 3 and 2, so for k=2, positions 3 and 2 have zero magic power.

If Kirill picks positions 1 and 2, only position 1 is usable, strength is 1*9=9.

But according to the sample, it's 16, which suggests that perhaps the strength is k times the minimum among all picked mushrooms, including those with zero magic power.

Wait, but that would be 2*0=0, which is not the case.

I'm clearly misunderstanding something.

Let me look at the sample explanation again.

In the first sample:

"you need to take the mushrooms with indices 1 and 2 , so the strength of the elixir is equal to 2 ⋅ min(a1,a2)=2⋅8=16 . Note that the magic power of the mushroom with index 3 after picking two mushrooms will become 0 ."

Wait, so according to the explanation, he picks indices 1 and 2, and the strength is 2*8=16.

But according to the problem, p_1 and p_2 are 3 and 2, so positions 3 and 2 have zero magic power.

Hence, when he picks positions 1 and 2, position 2 has zero magic power, so only position 1 is usable with magic power 9.

Hence, strength should be 1*9=9, but according to the sample, it's 2*8=16.

Wait, perhaps there's a misunderstanding in the indexing.

Wait, in the problem, positions are 1-based, and lists in Python are 0-based.

So, p=[3,2,1], which corresponds to positions 3,2,1.

But in the sample explanation, it says "take the mushrooms with indices 1 and 2", meaning positions 1 and 2.

But according to p, for k=2, p_1 and p_2 are 3 and 2, so positions 3 and 2 have zero magic power.

Hence, picking positions 1 and 2: position 2 has zero magic power, so only position 1 is usable with magic power 9, strength is 1*9=9.

But according to the sample
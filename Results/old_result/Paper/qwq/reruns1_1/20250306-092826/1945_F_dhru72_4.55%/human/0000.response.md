Alright, I've got this problem to solve. Let's see what it's asking for.

So, Kirill wants to pick mushrooms to make an elixir. Each mushroom has a magic power, and he wants to maximize the strength of the elixir. The strength is calculated as the product of the number of mushrooms he picks and the minimum magic power among those mushrooms. So, if he picks k mushrooms, the strength is k times the smallest magic power among those k mushrooms.

But there's a catch. There's a permutation p of numbers from 1 to n, and if he picks k mushrooms, the magic power of the mushrooms at positions p1 to p(k-1) becomes zero. He can't use mushrooms with zero magic power in his elixir.

My task is to help Kirill figure out which mushrooms to pick to maximize the elixir's strength, and among all options that give the maximum strength, choose the one with the minimum number of mushrooms.

First, I need to understand the permutation p. It's a sequence of indices from 1 to n, and it determines which mushrooms lose their magic power based on how many mushrooms Kirill picks.

Let's consider an example to get a better grasp.

Suppose n=3, v=[9,8,14], and p=[3,2,1].

If Kirill picks 1 mushroom, say the first one with power 9, then according to p, the mushroom at position p1=3 has its power set to zero. So, the third mushroom's power becomes 0. But since he's only picking one mushroom, and the third one is now zero, he only uses the first mushroom with power 9. So, strength is 1*9=9.

If he picks 2 mushrooms, say the first and the second, their powers are 9 and 8 respectively. According to p, the mushrooms at positions p1=3 and p2=2 have their powers set to zero. So, the third mushroom becomes 0, and the second mushroom becomes 0. But he's picking the first and the second, so he can't use the second anymore because its power is now zero. So, he can only use the first mushroom with power 9. Strength is 1*9=9.

Wait, that doesn't seem right. Let's read the problem again.

"The magic power of all mushrooms with indices p1, p2, ..., p(k-1) will become 0. Kirill will not use mushrooms with zero magic power to prepare the elixir."

So, if he picks k mushrooms, the mushrooms at positions p1 to p(k-1) have their magic power set to zero, and he cannot use those in his elixir.

In the first case, picking 1 mushroom: p1=3, so mushroom 3's power becomes zero. He can pick mushroom 1 (power 9) or mushroom 2 (power 8), but not mushroom 3 (now power 0). So, if he picks mushroom 1, strength is 1*9=9. If he picks mushroom 2, strength is 1*8=8. So, the maximum is 9.

In the second case, picking 2 mushrooms: p1=3 and p2=2, so mushroom 3 and mushroom 2 have power set to zero. He can only pick mushroom 1 (power 9) and mushroom 2 (power 0), but he can't use mushroom 2 because its power is zero. So, effectively, he's only using mushroom 1, strength is 1*9=9.

If he picks 3 mushrooms: p1=3, p2=2, p3=1, so all mushrooms' power is set to zero. But he can't use any mushroom because all have power zero. So, strength is 0.

Therefore, the maximum strength is 9, achieved by picking either 1 or 2 mushrooms, but since we need the minimum number of mushrooms among the options giving the maximum strength, we choose 1.

But in the example provided in the problem, for this input, it says the output should be 16 2. Wait, that doesn't match my calculation. Maybe I misread the problem.

Wait, in the problem's example, n=3, v=[9,8,14], p=[3,2,1], and the output is 16 2.

But according to my earlier reasoning, it should be 9 1. Hmm, seems like I'm missing something.

Let me read the problem again carefully.

"Kirill can gather mushrooms in any order."

"The magic power of all mushrooms with indices p1, p2, ..., p(k-1) will become 0. Kirill will not use mushrooms with zero magic power to prepare the elixir."

Wait, perhaps the order in which he picks the mushrooms matters.

Wait no, the problem says "Kirill can gather mushrooms in any order", meaning he can choose any sequence of k mushrooms, and the permutation p determines which mushrooms have their power set to zero.

Wait, perhaps I need to consider that the permutation p determines the order in which the magic powers are zeroed out as he picks mushrooms.

Wait, let's read the problem again.

"As soon as everyone in the camp fell asleep, Kirill sneaked out of the tent and went to the Wise Oak to gather mushrooms.

It is known that there are n mushrooms growing under the Oak, each of which has magic power v_i. Kirill really wants to make a magical elixir of maximum strength from the mushrooms.

The strength of the elixir is equal to the product of the number of mushrooms in it and the minimum magic power among these mushrooms. To prepare the elixir, Kirill will sequentially pick one mushroom growing under the Oak. Kirill can gather mushrooms in any order.

However, it's not that simple. The Wise Oak informed Kirill of a permutation of numbers p from 1 to n. If Kirill picks only k mushrooms, then the magic power of all mushrooms with indices p1, p2, ..., p(k-1) will become 0. Kirill will not use mushrooms with zero magic power to prepare the elixir.

Your task is to help Kirill gather mushrooms in such a way that he can brew the elixir of maximum possible strength. However, Kirill is a little scared to stay near the oak for too long, so out of all the suitable options for gathering mushrooms, he asks you to find the one with the minimum number of mushrooms."

So, Kirill picks k mushrooms in some order, and for each k, the first k-1 mushrooms he picks have their magic power set to zero for the final elixir.

Wait, no. The problem says: "If Kirill picks only k mushrooms, then the magic power of all mushrooms with indices p1, p2, ..., p(k-1) will become 0."

So, p is a permutation that the Wise Oak provides, and p1 to p(k-1) are the indices of mushrooms that lose their magic power when Kirill picks k mushrooms.

The order in which Kirill picks the mushrooms doesn't matter; what matters is how many he picks (k), and based on that, the first k-1 elements of the permutation p determine which mushrooms have their magic power set to zero.

So, for each k, the mushrooms at positions p1 to p(k-1) have their magic power set to zero, and Kirill can't use those in his elixir.

He then uses the remaining mushrooms that haven't had their power set to zero to make the elixir.

Wait, but in the earlier example, for k=2, p1=3 and p2=2, so mushrooms 3 and 2 have their power set to zero. So, he can only use mushroom 1, which has power 9, so strength is 1*9=9.

But according to the sample input, for n=3, v=[9,8,14], p=[3,2,1], the output is 16 2.

I must be misunderstanding something.

Wait, perhaps I need to consider that when he picks k mushrooms, only the first k-1 positions in p have their magic power set to zero.

Wait, no, the problem says: "If Kirill picks only k mushrooms, then the magic power of all mushrooms with indices p1, p2, ..., p(k-1) will become 0."

So, for k=2, p1 and p2 are set to zero.

Wait, no, p1 to p(k-1), so for k=2, p1 and p2 are set to zero.

Wait, no, p1 to p(k-1), which for k=2 is p1 only.

Wait, hold on, I need to read carefully.

"If Kirill picks only k mushrooms, then the magic power of all mushrooms with indices p1, p2, ..., p(k-1) will become 0."

So, for k=2, p1 to p(k-1)=p1 is set to zero.

Wait, in the earlier example, p=[3,2,1], so p1=3, p2=2, p3=1.

So, for k=2, p1=3 is set to zero.

So, mushroom 3's power is set to zero.

Then, Kirill picks 2 mushrooms: say mushrooms 1 and 2.

But mushroom 3 is set to zero, but since he's not picking mushroom 3, it doesn't affect his elixir.

Wait, but according to the problem, he can't use mushrooms with zero magic power, but since he's not picking mushroom 3, it's irrelevant.

Wait, perhaps I need to re-express this.

When Kirill picks k mushrooms, the magic power of mushrooms at positions p1 to p(k-1) is set to zero.

Then, among the mushrooms he picks, if any of them has its magic power set to zero, he can't use them.

So, in this case, for k=2, p1=3 is set to zero.

If Kirill picks mushrooms 1 and 2, mushroom 3 is set to zero, but since he didn't pick mushroom 3, it doesn't affect him.

So, he uses mushrooms 1 and 2, with powers 9 and 8, so strength is 2*8=16.

Wait, that matches the sample output.

But earlier, I thought p1 to p(k-1) are set to zero, which for k=2 is p1=3.

But in the sample explanation, it seems like p1 to p(k-1) are set to zero, and he picks k mushrooms, excluding those set to zero.

Wait, but in this case, p1=3 is set to zero, and he picks mushrooms 1 and 2, neither of which are set to zero, so he can use both.

Hence, strength is 2*8=16.

Similarly, for k=1, p1 to p0, which is nothing, so no mushrooms are set to zero.

He picks one mushroom, say mushroom 1 with power 9, so strength is 1*9=9.

For k=2, p1=3 is set to zero, so mushroom 3 is zero, but he picks mushrooms 1 and 2, so strength is 2*8=16.

For k=3, p1=3 and p2=2 are set to zero, so mushrooms 3 and 2 are zero.

He picks mushrooms 1, 2, and 3, but since 2 and 3 are zero, he can only use mushroom 1, so strength is 1*9=9.

Hence, the maximum strength is 16, achieved with k=2.

So, I was misinterpreting which mushrooms are set to zero based on k.

Now, I need to generalize this.

Given n, v, and p, I need to find, for each k from 1 to n, which mushrooms are set to zero, and then find the maximum strength achievable with the remaining mushrooms, and find the k that gives the maximum strength with the smallest k.

But iterating over all k from 1 to n would be too slow since n can be up to 2e5.

I need a smarter approach.

Let me think differently.

Let's consider that for a given k, the first k-1 elements of p are set to zero.

So, for k=1, no elements are set to zero.

For k=2, p1 is set to zero.

For k=3, p1 and p2 are set to zero.

And so on.

So, for a given k, the set of mushrooms set to zero is p1 to p(k-1).

Then, Kirill picks k mushrooms from the remaining n - (k-1) mushrooms that are not set to zero.

Wait, but he can't pick mushrooms that have been set to zero.

Wait, no, he can pick them, but he can't use them in his elixir.

Wait, the problem says: "Kirill will not use mushrooms with zero magic power to prepare the elixir."

So, he can pick them, but if their magic power is zero, he can't include them in the elixir.

So, for a given k, p1 to p(k-1) are set to zero.

Then, among the k mushrooms he picks, any of them that are in p1 to p(k-1) have zero magic power and can't be used.

So, effectively, for a given k, the mushrooms that are set to zero are p1 to p(k-1), and among the k mushrooms he picks, any that are in p1 to p(k-1) are zero and can't be used.

Wait, maybe it's better to think in terms of which mushrooms are available.

For a given k, the mushrooms that are set to zero are p1 to p(k-1).

So, the mushrooms that are not set to zero are pk to pn.

Then, Kirill picks k mushrooms, but can only use those that are not set to zero.

So, among the k mushrooms he picks, only those that are not in p1 to p(k-1) can be used.

Wait, but he picks k mushrooms, and among them, any that are in p1 to p(k-1) have zero magic power and can't be used.

So, to maximize the strength, he should pick as many mushrooms as possible that are not in p1 to p(k-1).

Wait, perhaps it's better to consider that for a given k, the mushrooms that can be used are those not in p1 to p(k-1), and he picks k mushrooms, so the number of usable mushrooms is the number of picked mushrooms that are not in p1 to p(k-1).

Wait, this seems complicated.

Let me try to think differently.

Suppose I sort the mushrooms in decreasing order of their magic power.

Then, for the first k mushrooms, the minimum magic power is the k-th largest.

So, the strength is k * v[k], where v is sorted in decreasing order.

But I need to consider the permutation p and the zeroing out of mushrooms.

Wait, maybe I should consider the positions in p.

Let me consider p as determining the order in which mushrooms are zeroed out.

Wait, perhaps I should iterate over k and keep track of which mushrooms are zeroed out.

But n can be up to 2e5, so I need an efficient way.

Let me consider that for a given k, the first k-1 elements of p are zeroed out.

Then, Kirill picks k mushrooms, and among those k, if any are in the first k-1 of p, their magic power is zero and can't be used.

So, in the elixir, only the mushrooms that are not in p1 to p(k-1) are used.

Hence, the number of mushrooms used is k - (number of picked mushrooms in p1 to p(k-1)).

And the minimum magic power is the smallest among the picked mushrooms not in p1 to p(k-1).

This seems messy.

Maybe I need to find a way to maximize k * min(v[j] for j in picked and j not in p1 to p(k-1)).

This is tricky.

Perhaps I need to consider the permutation p and the values v in a combined way.

Wait, maybe I can rearrange the problem.

Suppose I sort the mushrooms based on their magic power in decreasing order.

Let's say I have v sorted as v[s1] >= v[s2] >= ... >= v[s_n].

Then, for a given k, if I pick the first k mushrooms from this sorted list, the minimum magic power is v[s_k].

But I need to consider that some mushrooms are zeroed out based on p.

Wait, perhaps I can think in terms of the positions in p.

Let me try to think of p as the order in which mushrooms are zeroed out.

So, p1 is the first to be zeroed out, p2 the second, and so on.

Then, for k, the first k-1 positions in p are zeroed out.

So, for each k, p1 to p(k-1) are zeroed out.

Then, Kirill picks k mushrooms, and among them, any that are in p1 to p(k-1) have zero magic power and can't be used.

So, to maximize the strength, I need to maximize k times the minimum magic power among the k picked mushrooms that are not in p1 to p(k-1).

This seems complicated to maximize directly.

Maybe I can think about fixing the minimum magic power and finding the maximum k for which this is possible.

But I need to consider the zeroing out based on p.

This is tricky.

Let me consider reordering the problem.

Suppose I sort the permutation p in such a way that p1 to pn are in increasing order of their indices.

Wait, p is already a permutation, so p1 to pn are just a rearrangement of 1 to n.

Wait, perhaps I need to consider the positions in p and their corresponding v values.

Wait, maybe I can consider the v values in the order specified by p.

Let me try that.

If I create a new array a where a[i] = v[p[i] - 1], for i from 1 to n.

So, a is v rearranged according to p.

Then, for a given k, the first k-1 elements of a are set to zero.

So, a1 to a(k-1) are zero.

Then, Kirill picks k mushrooms from the original set, but in terms of a, he picks k elements, and the first k-1 are zero.

Wait, perhaps I can think in terms of a.

So, a = [v[p1], v[p2], ..., v[pn]].

Then, for k, a1 to a(k-1) are zero.

So, if Kirill picks k mushrooms, he picks a1 to ak, but a1 to a(k-1) are zero.

So, among the k picked, only ak is non-zero.

Wait, that seems promising.

So, for k, he picks a1 to ak, but a1 to a(k-1) are zero, so only ak is non-zero.

So, the strength is 1 * ak, because only one mushroom is usable.

Wait, that can't be right, because in the earlier example, for k=2, it was 2*8=16, not 1*8=8.

Wait, perhaps I need to think differently.

Wait, perhaps Kirill can pick any k mushrooms from the original set, but the first k-1 in p have their magic power set to zero.

So, in terms of a, a1 to a(k-1) are zero.

Then, among the k mushrooms he picks, any that are in a1 to a(k-1) are zero.

So, the number of non-zero mushrooms is k - (number of picked mushrooms in a1 to a(k-1)).

Wait, perhaps it's better to think in terms of the positions.

Let me map the positions.

Given p is a permutation, p1 to pn are positions from 1 to n.

So, p1 is the first position to be zeroed out, p2 the second, and so on.

So, for k, p1 to p(k-1) are zeroed out.

Then, Kirill picks k mushrooms, and among them, if any are in p1 to p(k-1), their magic power is zero.

So, the number of usable mushrooms is k - (number of picked mushrooms in p1 to p(k-1)).

And the minimum magic power is the smallest among the usable mushrooms.

This seems too vague.

Maybe I need to consider that for a given k, the usable mushrooms are those not in p1 to p(k-1).

So, the usable mushrooms are pn from p[k] to pn.

So, Kirill needs to pick k mushrooms, and among them, only those not in p1 to p(k-1) can be used.

So, to maximize the strength, he should pick as many usable mushrooms as possible.

The maximum number of usable mushrooms is k - (k-1) = 1, but that doesn't make sense.

Wait, no, k - min(k-1, k) = k - k +1 =1, which is not correct.

Wait, perhaps I need to think differently.

Let me consider that for a given k, the set of usable mushrooms is pn from p[k] to pn.

So, the first k-1 mushrooms in p are zeroed out and can't be used.

So, the usable mushrooms are p[k] to pn.

Then, Kirill picks k mushrooms from the original set, and among them, only those that are in p[k] to pn can be used.

So, to maximize the strength, he should pick as many mushrooms as possible from p[k] to pn.

The maximum number of usable mushrooms is k, but some of them might be in p1 to p(k-1).

Wait, no, the mushrooms in p1 to p(k-1) are zeroed out, so if he picks any of them, their magic power is zero and can't be used.

So, to maximize the strength, he should pick k mushrooms from p[k] to pn, if possible.

In that case, the minimum magic power would be the smallest among the k mushrooms picked from p[k] to pn.

So, to maximize the strength, he should pick the k mushrooms with the largest magic powers from p[k] to pn.

Wait, but p[k] to pn are the positions that are not zeroed out for k.

So, for each k, the usable mushrooms are p[k] to pn.

Then, Kirill picks k mushrooms from p[k] to pn, and the strength is k times the minimum among those k mushrooms.

Wait, but p[k] to pn are n - (k-1) mushrooms.

So, for each k, he can pick up to k mushrooms from the n - (k-1) usable mushrooms.

But he has to pick exactly k mushrooms, but only the ones from p[k] to pn are usable.

So, if n - (k-1) >=k, he can pick k mushrooms from p[k] to pn.

Wait, no, n - (k-1) is the number of usable mushrooms.

But he has to pick exactly k mushrooms, but only the ones from p[k] to pn are usable.

So, if n - (k-1) >=k, he can pick k mushrooms from p[k] to pn.

Wait, let's see.

For example, n=3, k=2.

p=[3,2,1].

So, p1=3, p2=2, p3=1.

For k=2, p1=3 is zeroed out.

So, usable mushrooms are p[2] to p[3], which are positions 2 and 1.

So, positions 2 and 1 are usable.

Then, Kirill picks 2 mushrooms, and among them, only the ones in positions 2 and 1 can be used.

So, if he picks positions 1 and 2, both are usable, so strength is 2*min(9,8)=16.

If he picks positions 1 and 3, position 3 is p1 and is zeroed out, so only position 1 is usable, strength is 1*9=9.

If he picks positions 2 and 3, position 3 is zeroed out, so only position 2 is usable, strength is 1*8=8.

So, the maximum is 16 with k=2.

Similarly, for k=3, p1=3 and p2=2 are zeroed out.

So, only p3=1 is usable.

He picks 3 mushrooms, but only position 1 is usable.

So, strength is 1*9=9.

For k=1, no p's are zeroed out.

He picks 1 mushroom, say position 1, strength is 1*9=9.

So, maximum strength is 16 with k=2.

Okay, so to generalize, for each k, the usable mushrooms are p[k] to pn.

He picks k mushrooms, but only the ones from p[k] to pn are usable.

So, to maximize the strength, he should pick the k mushrooms with the largest magic powers from p[k] to pn.

Wait, but to maximize k times the minimum among the k picked, he should pick the k mushrooms with the largest magic powers from p[k] to pn.

Wait, no, to maximize k * min, he should pick the k mushrooms with the smallest possible magic powers that are still among p[k] to pn.

Wait, no, to maximize k * min, he should pick the k mushrooms with the highest possible magic powers, but since min is involved, he needs to balance between k and min.

Wait, perhaps I need to think differently.

Let me consider that for each k, the usable mushrooms are p[k] to pn.

I need to pick k mushrooms from p[k] to pn, and the strength is k times the smallest among them.

To maximize this, I should pick the k mushrooms with the highest magic powers from p[k] to pn.

Wait, no, if I pick the k highest, the min among them is as high as possible, so k * min is maximized.

Wait, yes, that makes sense.

So, for each k, sort the magic powers of p[k] to pn in decreasing order, pick the top k, and take k times the k-th largest.

Wait, but n is up to 2e5, and t is up to 1e4, so I need an efficient way to handle this.

This seems too slow.

I need a smarter approach.

Let me consider that I can iterate over the possible min values.

Wait, perhaps I can sort the v in decreasing order and find the maximum k such that k of the largest v's are among p[k] to pn.

Wait, maybe I need to find for each possible min value, the maximum k for which there are k mushrooms with magic power >= min, and these k mushrooms are among p[k] to pn.

This sounds similar to finding the largest k where there are at least k mushrooms with magic power >= v[s_k], and these k mushrooms are among p[k] to pn.

Wait, perhaps I need to sort v in decreasing order and map it to p.

This is getting complicated.

Let me try to think differently.

Suppose I sort the v in decreasing order: s1, s2, ..., sn where v[s1] >= v[s2] >= ... >= v[sn].

Then, the optimal k is the largest k where v[s_k] >= (total strength)/k.

Wait, no, that's for a different problem.

Perhaps I need to consider the sorted v and find the k that maximizes k * v[s_k], but considering the constraints from p.

Wait, but I need to factor in p.

Maybe I need to find for each k, the smallest v among the top k mushrooms that are not in p1 to p(k-1).

Wait, that seems too slow.

Let me consider that a = [v[p1], v[p2], ..., v[pn]], where p is the permutation.

Then, for each k, the first k-1 elements of a are zeroed out.

So, a[k] to a[n] are the usable mushrooms.

So, for k, he picks k mushrooms, and among them, only the ones from a[k] to a[n] are usable.

So, to maximize the strength, he should pick the k largest mushrooms from a[k] to a[n].

Wait, but a[k] to a[n] are sorted in some order.

Wait, no, a is just a rearrangement based on p.

So, a[k] to a[n] are the mushrooms that are not zeroed out for that k.

So, to maximize k * min, where min is the smallest among the k picked from a[k] to a[n].

To maximize this, I should pick the k largest from a[k] to a[n].

Wait, but a[k] to a[n] are not necessarily sorted.

So, for each k, I need to find the k-th largest in a[k] to a[n].

Then, the strength is k * (k-th largest in a[k] to a[n]).

Then, I need to find the k that maximizes this value.

But n is up to 2e5, and t is up to 1e4, so this needs to be done efficiently.

Perhaps I can sort a[k] to a[n] for each k, but that's too slow.

Alternatively, I can have a data structure that allows me to find the k-th largest in a[k] to a[n] efficiently.

Wait, if I have a sorted list of a[k] to a[n], I can find the k-th largest easily.

So, perhaps I can maintain a sorted list of a[k] to a[n], and for each k from 1 to n, find the k-th largest in that list and compute k * (k-th largest).

Then, find the maximum among all k.

Then, among all k that give this maximum, choose the smallest k.

But n is up to 2e5, and t is up to 1e4, so this needs to be optimized.

I need a way to compute the k-th largest in a[k] to a[n] efficiently.

One way is to reverse the array a, so a[n] to a[1], and then maintain a sorted multiset that starts with a[n], and as k increases, I add a[n - k +1] to the multiset.

Wait, let's see.

If I reverse a, so b = a[::-1], then b[1] = a[n], b[2] = a[n-1], ..., b[n] = a[1].

Then, for k, the multiset contains b[1] to b[n -
Certainly! Below are the comprehensive test cases for the problem described. These test cases are divided into Basic and Edge scenarios to ensure the code's robustness, reliability, and scalability.

### Basic Test Cases

# Test 1
**Input**:
```
6
9
mmapnapie
9
azabazapi
8
mappppie
18
mapmapmapmapmapmap
1
p
11
pppiepieeee
```
**Output**:
```
2
0
2
6
0
2
```
**Scenario**: This test case covers a variety of string lengths and compositions, including strings that are initially beautiful and those that require deletions to become beautiful.

# Test 2
**Input**:
```
3
5
piepie
6
mapmap
7
pippie
```
**Output**:
```
3
3
3
```
**Scenario**: This test case includes strings that contain multiple occurrences of the substrings "pie" and "map", requiring multiple deletions to make the string beautiful.

# Test 3
**Input**:
```
4
3
pie
3
map
4
pmap
4
piep
```
**Output**:
```
3
3
2
2
```
**Scenario**: This test case includes the smallest possible strings that contain the substrings "pie" and "map", as well as strings that contain these substrings with one additional character.

# Test 4
**Input**:
```
2
10
mapppppppie
10
pieppppppmap
```
**Output**:
```
3
3
```
**Scenario**: This test case includes strings where the substrings "pie" and "map" are separated by a large number of other characters, ensuring the function can handle such cases correctly.

# Test 5
**Input**:
```
3
10
mapppppppie
10
pieppppppmap
12
mapppppppiepie
```
**Output**:
```
3
3
4
```
**Scenario**: This test case includes strings with multiple occurrences of "pie" and "map" and ensures the function can handle longer strings with multiple deletions.

### Edge Test Cases

# Test 6
**Input**:
```
1
1
a
```
**Output**:
```
0
```
**Scenario**: This test case includes the shortest possible string that does not contain "pie" or "map", ensuring the function handles single-character strings correctly.

# Test 7
**Input**:
```
1
1000000
abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz
```
**Output**:
```
0
```
**Scenario**: This test case includes the longest possible string (1,000,000 characters) that does not contain "pie" or "map", ensuring the function can handle very large strings efficiently.

# Test 8
**Input**:
```
1
1000000
piepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepie
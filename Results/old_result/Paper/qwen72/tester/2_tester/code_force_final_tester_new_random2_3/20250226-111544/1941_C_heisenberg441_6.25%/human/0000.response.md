Certainly! Below are comprehensive test cases for the given problem, divided into Basic and Edge scenarios.

### Basic Test Cases

# Test 1
**Input**: 
```
6
9
mmapnapie
9
azabazapi
8
mappppie
18
mapmapmapmapmapmap
1
p
11
pppiepieeee
```
**Output**: 
```
2
0
2
6
0
2
```
**Scenario**: This test case covers a variety of string lengths and compositions, including strings that are already beautiful and those that need characters removed to become beautiful.

# Test 2
**Input**: 
```
3
5
piepie
5
mapie
5
piepi
```
**Output**: 
```
3
2
2
```
**Scenario**: This test case includes strings that contain both "pie" and "map" substrings, requiring the removal of multiple characters.

# Test 3
**Input**: 
```
4
3
pie
3
map
3
pam
3
pip
```
**Output**: 
```
3
3
0
1
```
**Scenario**: This test case includes the shortest possible strings containing "pie" and "map" substrings, as well as a string that is already beautiful and one that needs a single character removed.

# Test 4
**Input**: 
```
2
7
mapppie
7
pieppie
```
**Output**: 
```
2
2
```
**Scenario**: This test case includes strings that contain "map" and "pie" substrings with additional characters, requiring the removal of a few characters to make them beautiful.

### Edge Test Cases

# Test 5
**Input**: 
```
1
1000000
piepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepie
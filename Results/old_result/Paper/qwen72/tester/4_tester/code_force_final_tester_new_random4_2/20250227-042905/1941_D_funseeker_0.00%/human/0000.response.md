Certainly! Below are comprehensive test cases for the given problem, including both basic and edge scenarios.

### Basic Test Cases

# Test 1
**Input**:
```
5
6 3 2
2 ?
2 ?
2 ?
12 1 2
3 1
10 7 4
2 ?
9 1
4 ?
7 0
2 0
8 1
5 3 1
4 0
4 ?
1 ?
4 1 1
2 ?
```
**Output**:
```
3
2 4 6
1
11
4
3 5 7 9
3
2 3 5
1
3
```

# Test 2
**Input**:
```
3
4 2 1
1 0
1 0
7 2 3
2 1
2 1
10 2 5
3 0
3 0
```
**Output**:
```
1
3
1
1
1
8
```

# Test 3
**Input**:
```
2
5 1 1
1 ?
8 2 2
2 0
2 0
```
**Output**:
```
2
1 2
1
6
```

# Test 4
**Input**:
```
1
3 2 1
1 0
1 1
```
**Output**:
```
1
3
```

# Test 5
**Input**:
```
1
10 3 1
1 0
1 1
1 0
```
**Output**:
```
1
1
```

### Edge Test Cases

# Test 6
**Input**:
```
1
2 1 1
1 0
```
**Output**:
```
1
2
```

# Test 7
**Input**:
```
1
2 1 1
1 1
```
**Output**:
```
1
1
```

# Test 8
**Input**:
```
1
2 1 1
1 ?
```
**Output**:
```
2
1 2
```

# Test 9
**Input**:
```
1
1000 1000 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999 1
999 0
999
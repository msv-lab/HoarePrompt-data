Output State: **The function `func` is intended to interact with a predefined interactor that manages the graph and responses. The graph is a complete undirected graph with `n` vertices, from which exactly `(n - 2)` edges have been removed. The function can handle multiple test cases, where the number of test cases `t` satisfies \(1 \le t \le 1000\), and for each test case, `n` satisfies \(2 \le n \le 10^5\). The sum of `n` over all test cases does not exceed \(10^5\). The function can make up to `n` queries of the form "? d" to the interactor, where `d` is an integer such that \(0 \le d \le n - 1\). The interactor responds with two integers representing a vertex and another vertex not connected to it, or "0 0" if no such vertex exists. The function must output a Hamiltonian path in the form "! v_1 v_2 ... v_n" and flush the output buffer after each query and answer. The variable `q` is now a function that sends a query to the interactor with the given distance `d` and returns the response as a map of integers.**

Explanation:
- The initial state remains unchanged except for the introduction of the variable `q`.
- `q` is now a function that, when called with an integer `d`, prints the query "? d" to the interactor, flushes the output buffer, and then reads the interactor's response, converting it into a map of integers.
- This function `q` can be used to query the interactor and process the response within the function `func`.
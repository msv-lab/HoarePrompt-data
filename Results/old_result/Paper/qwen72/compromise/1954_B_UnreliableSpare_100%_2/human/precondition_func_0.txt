The function should accept two parameters: a list of integers `a` and an integer `n` representing the length of the list `a`. The list `a` is a beautiful array as defined in the problem, and `1 <= n <= 3 * 10^5`. The function should also handle multiple test cases, where the number of test cases `t` is an integer such that `1 <= t <= 10^4`. The sum of `n` over all test cases does not exceed `3 * 10^5`.
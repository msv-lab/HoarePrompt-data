Correctness: **False**

Explanation:

The provided solution has a logical error in how it calculates the expected value of the sum of friendship values. Specifically, the formula used to calculate `p` and `q` is incorrect. The correct approach should consider the probability of selecting a friend pair and the increase in friendship value over the excursions.

Hereâ€™s a corrected version of the logic:

1. **Calculate the initial expected value**: For each excursion, the expected value of the friendship value of the chosen pair is the sum of the friendship values of all friend pairs divided by the total number of possible pairs (including non-friend pairs).

2. **Update the expected value for subsequent excursions**: Each time a friend pair is chosen, their friendship value increases by 1, which affects the expected value for future excursions.

The correct formula for the expected value of the sum of friendship values over `k` excursions is:

\[ E = \sum_{i=1}^{k} \left( \frac{\text{sum\_f}}{\binom{n}{2}} + \frac{i-1}{\binom{n}{2}} \right) \]

Where:
- \(\text{sum\_f}\) is the sum of the initial friendship values.
- \(\binom{n}{2}\) is the total number of possible pairs.
- \(i-1\) accounts for the increase in friendship value due to previous selections.

This can be simplified to:

\[ E = k \cdot \frac{\text{sum\_f}}{\binom{n}{2}} + \frac{k(k-1)}{2} \cdot \frac{1}{\binom{n}{2}} \]

Let's rewrite the program with the correct logic:

```python
import math

def func():
    t = int(input())
    M = 10 ** 9 + 7
    for i in range(t):
        (n, m, k) = map(int, input().split())
        sum_f = 0
        for j in range(m):
            (a, b, f) = map(int, input().split())
            sum_f += f
        cn2 = n * (n - 1) // 2
        expected_value = (k * sum_f + k * (k - 1) // 2) * pow(cn2, -1, M) % M
        print(expected_value)

func()
```

This corrected version correctly calculates the expected value of the sum of friendship values over the excursions.
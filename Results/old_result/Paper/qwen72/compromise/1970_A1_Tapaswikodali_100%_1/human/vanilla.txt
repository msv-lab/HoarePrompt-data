- The program correctly computes the balance for each prefix and stores the balance information along with the position and character.
   - The sorting is done according to the specified criteria.
   - The result is constructed by joining the characters in the sorted order.
   - The program handles the input and output as described in the problem statement.

### Conclusion:
The given program is correct based on the problem description.

Correctness:
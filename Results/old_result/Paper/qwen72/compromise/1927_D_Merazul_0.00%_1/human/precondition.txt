a is a list of n integers where 2 ≤ n ≤ 2·10^5, and each element a_i satisfies 1 ≤ a_i ≤ 10^6. n is the length of the array a. q is a non-negative integer representing the number of queries, where 1 ≤ q ≤ 2·10^5. queries is a list of q tuples, each containing two integers l and r, where 1 ≤ l < r ≤ n. The sum of n and q across all test cases does not exceed 2·10^5.
Output State: **`nodes` must contain at least one unprocessed key, `key` is the next key in `nodes`, `leaves` now includes `key`.**
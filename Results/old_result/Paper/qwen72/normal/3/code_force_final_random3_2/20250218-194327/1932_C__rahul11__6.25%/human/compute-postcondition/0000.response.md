Output State: **The function `func` is expected to be part of a larger program that processes multiple test cases. Each test case consists of an integer n (1 ≤ n ≤ 2·10^5), an integer m (1 ≤ m ≤ 10^4), a list of n integers a (1 ≤ a_i ≤ 10^4), and a string s of n characters, each being either 'L' or 'R'. The number of test cases t is an integer (1 ≤ t ≤ 10^4), and the sum of n values across all test cases does not exceed 2·10^5. `MOD` is now 1000000006.**
- The logic for precomputing the minimum costs in both directions is correct.
   - The query handling correctly uses the precomputed values to find the minimum cost.
   - The program handles the constraints and edge cases as specified in the problem statement.

### Conclusion:
The program is correct and should work as expected for the given problem.

Correctness:
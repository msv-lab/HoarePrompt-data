The function `solve` is expected to handle multiple test cases. Each test case includes an integer `t` (1 ≤ t ≤ 3 · 10^4) indicating the number of test cases, followed by `t` sets of inputs. Each set of inputs consists of three lines: the first line contains two integers `n` and `k` (1 ≤ n ≤ 3 · 10^5, 1 ≤ k ≤ 2 · 10^9), the second line contains `n` integers `a_1, a_2, ..., a_n` (1 ≤ a_i ≤ 10^9), and the third line contains `n` integers `x_1, x_2, ..., x_n` (-n ≤ x_1 < x_2 < ... < x_n ≤ n, x_i ≠ 0). The sum of `n` over all test cases does not exceed 3 · 10^5.
Output State: **`n`, `x`, `y` remain unchanged. `t`, `chosen_vertices`, `a`, and `present` remain unchanged. `ans` is incremented by the sum of all `gap` values in `gaps` that are fully consumed by the loop (i.e., `y >= pairs`), plus `2 * y` for the last partial consumption of `gap` (if any).**
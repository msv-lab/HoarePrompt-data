The function should take two parameters: a list of integers `piles` representing the number of stones in each pile, and an integer `n` representing the number of piles. The list `piles` should have a length equal to `n`, and each element in `piles` should be a positive integer (1 ≤ a_i ≤ 10^9). Additionally, the function should handle multiple test cases, where the number of test cases `t` is a positive integer (1 ≤ t ≤ 10^4). The sum of `n` over all test cases does not exceed 2·10^5.
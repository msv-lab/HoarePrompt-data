d is a dictionary where keys are integers and values are lists of integers, processing is a list of integers of length at least max(di - 1 for di in d[da]), da is an integer that is a key in d, and rank is a list of integers of length at least da - 1.
The function `solve` is part of a program that processes multiple test cases. Each test case contains a single integer n (3 ≤ n ≤ 10^5) representing the length of the permutation p. The sum of n over all test cases does not exceed 10^5.
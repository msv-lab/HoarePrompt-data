The function `func` is expected to be called within a context that provides the necessary inputs as described in the problem statement, including the number of test cases `t`, the length of the permutation `n`, the duration of the game `k`, the starting positions `P_B` and `P_S`, the permutation `p`, and the array `a`. The inputs are such that 1 ≤ t ≤ 10^4, 1 ≤ P_B, P_S ≤ n ≤ 2 × 10^5, 1 ≤ k ≤ 10^9, 1 ≤ p_i ≤ n, and 1 ≤ a_i ≤ 10^9. The sum of values of `n` over all test cases does not exceed 2 × 10^5.
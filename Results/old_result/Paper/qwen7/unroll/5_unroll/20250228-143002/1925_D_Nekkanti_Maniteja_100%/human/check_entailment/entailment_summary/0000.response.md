Reasoning:

1. **Understanding the Problem**: 
   - We need to calculate the expected value of the sum of friendship values of all k pairs chosen for the excursions.
   - For each excursion, if a pair of friends is chosen, their friendship value increases by 1 for all subsequent excursions.
   - The expected value calculation involves understanding the probability of choosing each pair and how their friendship values evolve over the excursions.

2. **Key Components of the Solution**:
   - **Total Number of Pairs**: \( \text{Total pairs} = \frac{n \cdot (n - 1)}{2} \).
   - **Inverse Modulo Calculation**: \( c = \left(\frac{n \cdot (n - 1)}{2}\right)^{-1} \mod M \) ensures that we can use modular arithmetic effectively.
   - **Sum of Friendship Values**: \( a \) is the sum of all initial friendship values.
   - **Expected Value Calculation**: The expression \( s = \sum_{i=0}^{k-1} \left(c \cdot i \cdot c \cdot m + c \cdot a\right) \mod M \) is used to compute the expected sum of friendship values.

3. **Verification of the Code**:
   - The code correctly reads the number of test cases and processes each test case.
   - It calculates the inverse modulo \( c \) correctly.
   - It sums up the friendship values \( a \).
   - The loop for calculating \( s \) uses the correct formula and applies the modulo operation at the end.

Given the above points, the provided code seems to follow the correct approach and logic as described in the problem statement and the execution summary.

Correctness: **True**
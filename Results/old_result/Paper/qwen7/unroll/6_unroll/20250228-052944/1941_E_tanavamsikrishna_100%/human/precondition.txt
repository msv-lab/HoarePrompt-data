row is a list of lists where each sublist represents a row of the river grid and contains m positive integers corresponding to the depths of the cells. d is an integer representing the maximum allowed distance between any pair of adjacent supports.
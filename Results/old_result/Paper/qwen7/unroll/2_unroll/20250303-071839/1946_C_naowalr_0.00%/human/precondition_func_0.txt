t is an integer such that 1 ≤ t ≤ 10^4. For each set of input data, n and k are integers such that 1 ≤ k < n ≤ 10^5. The adjacency list adj represents a tree where adj[i] is a list of integers representing the neighbors of vertex i. The variable L is initialized to 1 and R is initialized to 100001. The function dfs is assumed to exist and returns the number of vertices in the largest connected component that remains after removing the edges according to the current value of x.
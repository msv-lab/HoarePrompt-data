The function processes a series of test cases, where for each test case, it reads an integer `t` (1 ≤ t ≤ 10^4) and a list of integers `a_1, a_2, ..., a_n` (0 ≤ a_i ≤ n) with the condition that 1 ≤ n ≤ 3⋅10^5 and the sum of all n values across all test cases does not exceed 3⋅10^5. For each test case, it calculates and prints the number of ways to choose three distinct indices `i`, `j`, and `k` such that `a_i = a_j = a_k`. If `n < 3`, it prints 0. The function collects the results of these calculations in a list `buffer` and outputs them after processing all test cases.
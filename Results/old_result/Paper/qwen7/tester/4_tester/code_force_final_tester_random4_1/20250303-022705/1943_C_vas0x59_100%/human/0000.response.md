To address the given problem, we will create comprehensive test cases that cover both basic and edge scenarios. Each test case will include an input and expected output format as specified in the problem statement.

### Test Case 1: Single Vertex Tree
**Objective**: Verify the function works correctly when there is only one vertex in the tree.

**Input**:
```
1
1
```
**Output**:
```
1
1 0
```

### Test Case 2: Two Vertex Tree
**Objective**: Verify the function works correctly when there are exactly two vertices in the tree.

**Input**:
```
1
2
1 2
```
**Output**:
```
2
1 0
2 0
```

### Test Case 3: Three Vertex Tree
**Objective**: Verify the function works correctly when there are three vertices in the tree.

**Input**:
```
1
3
1 2
1 3
```
**Output**:
```
3
1 0
2 1
3 1
```

### Test Case 4: Four Vertex Tree
**Objective**: Verify the function works correctly when there are four vertices in the tree.

**Input**:
```
1
4
1 2
1 3
1 4
```
**Output**:
```
4
1 0
2 1
3 1
4 1
```

### Test Case 5: Four Vertex Tree with Different Structure
**Objective**: Verify the function works correctly when the tree has a different structure but still requires four operations.

**Input**:
```
1
4
1 2
2 3
2 4
```
**Output**:
```
2
2 1
1 0
3 1
4 1
```

### Test Case 6: Five Vertex Tree
**Objective**: Verify the function works correctly when there are five vertices in the tree.

**Input**:
```
1
5
1 2
1 3
1 4
1 5
```
**Output**:
```
5
1 0
2 1
3 1
4 1
5 1
```

### Test Case 7: Six Vertex Tree
**Objective**: Verify the function works correctly when there are six vertices in the tree.

**Input**:
```
1
6
1 2
1 3
1 4
1 5
1 6
```
**Output**:
```
6
1 0
2 1
3 1
4 1
5 1
6 1
```

### Test Case 8: Seven Vertex Tree with Different Structure
**Objective**: Verify the function works correctly when the tree has a different structure but still requires seven operations.

**Input**:
```
1
7
1 2
2 3
3 4
4 5
5 6
6 7
```
**Output**:
```
2
1 1
2 0
3 1
4 1
5 1
6 1
7 1
```

### Test Case 9: Seven Vertex Tree with Multiple Branches
**Objective**: Verify the function works correctly when the tree has multiple branches and requires more than one operation per branch.

**Input**:
```
1
7
1 2
2 3
3 4
4 5
1 6
6 7
```
**Output**:
```
3
1 1
2 0
3 1
4 1
5 1
6 1
7 1
```

### Test Case 10: Large Tree with Many Vertices
**Objective**: Verify the function works correctly with a large tree that has many vertices.

**Input**:
```
1
10
1 2
1 3
1 4
1 5
1 6
1 7
1 8
1 9
1 10
```
**Output**:
```
10
1 0
2 1
3 1
4 1
5 1
6 1
7 1
8 1
9 1
10 1
```

### Test Case 11: Degenerate Tree (Star Configuration)
**Objective**: Verify the function works correctly when the tree is a star configuration.

**Input**:
```
1
5
1 2
1 3
1 4
1 5
```
**Output**:
```
2
1 1
2 0
3 0
4 0
5 0
```

### Test Case 12: Random Tree Configuration
**Objective**: Verify the function works correctly with a random tree configuration.

**Input**:
```
1
7
1 2
2 3
3 4
4 5
5 6
6 7
```
**Output**:
```
2
1 1
2 0
3 1
4 1
5 1
6 1
7 1
```

These test cases cover a range of scenarios from simple to complex, ensuring the solution handles various configurations of trees and operations effectively.
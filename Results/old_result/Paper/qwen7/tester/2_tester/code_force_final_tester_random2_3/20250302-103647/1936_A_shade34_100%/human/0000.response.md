Given the problem statement, we need to create comprehensive test cases to ensure the robustness, reliability, and scalability of the solution. Here are the test cases divided into basic and edge scenarios:

### Basic Test Cases

#### Test 1: Small Permutation
**Objective**: Verify the solution works for a small permutation size.
**Input**:
```
2
4
```
**Output**:
```
? 0 2 3 1
<
? 1 1 2 3
=
? 1 2 0 3
>
! 3 2
! 0 1
```

#### Test 2: Medium Permutation
**Objective**: Verify the solution works for a medium permutation size.
**Input**:
```
2
8
```
**Output**:
```
? 0 2 3 1
<
? 1 1 2 3
=
? 1 2 0 3
>
! 7 6
! 0 1
```

#### Test 3: Large Permutation
**Objective**: Verify the solution works for a large permutation size.
**Input**:
```
2
10000
```
**Output**:
```
? 0 2 3 1
<
? 1 1 2 3
=
? 1 2 0 3
>
! 9999 9998
! 0 1
```

### Edge Test Cases

#### Test 4: Single Element Permutation
**Objective**: Verify the solution handles a single-element permutation.
**Input**:
```
2
1
```
**Output**:
```
! 0 0
```

#### Test 5: Two Elements Permutation
**Objective**: Verify the solution handles a two-element permutation.
**Input**:
```
2
2
```
**Output**:
```
! 0 1
```

#### Test 6: Permutation with Maximum XOR at Edge
**Objective**: Verify the solution finds the pair with the maximum XOR even when the maximum XOR is at the edge of the permutation.
**Input**:
```
2
4
```
**Output**:
```
? 0 2 3 1
<
? 1 1 2 3
=
? 1 2 0 3
>
! 3 2
! 0 1
```

#### Test 7: Permutation with All Elements Equal
**Objective**: Verify the solution handles a permutation where all elements are the same.
**Input**:
```
2
4
0 0 0 0
```
**Output**:
```
! 0 1
```

#### Test 8: Permutation with Maximum XOR in the Middle
**Objective**: Verify the solution finds the pair with the maximum XOR when the maximum XOR is in the middle of the permutation.
**Input**:
```
2
4
0 3 1 2
```
**Output**:
```
? 0 2 3 1
<
? 1 1 2 3
=
? 1 2 0 3
>
! 2 3
! 0 1
```

#### Test 9: Permutation with Maximum XOR at the Beginning
**Objective**: Verify the solution finds the pair with the maximum XOR when the maximum XOR is at the beginning of the permutation.
**Input**:
```
2
4
2 3 1 0
```
**Output**:
```
? 0 2 3 1
<
? 1 1 2 3
=
? 1 2 0 3
>
! 0 1
! 2 3
```

#### Test 10: Permutation with Maximum XOR at the End
**Objective**: Verify the solution finds the pair with the maximum XOR when the maximum XOR is at the end of the permutation.
**Input**:
```
2
4
3 2 0 1
```
**Output**:
```
? 0 2 3 1
<
? 1 1 2 3
=
? 1 2 0 3
>
! 3 2
! 0 1
```

These test cases cover a range of scenarios from small to large permutations, including edge cases and permutations with specific properties, ensuring the solution is robust and reliable.
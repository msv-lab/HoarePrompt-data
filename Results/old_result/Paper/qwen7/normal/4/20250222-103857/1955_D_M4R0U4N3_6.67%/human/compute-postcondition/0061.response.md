Postcondition: `r` is `m + 1`, `m` remains the same, `n` remains the same, `a` remains the same, `old` is now `a[r - m]`, `extra` includes `a[r - m]`, `done` is `done` minus `old`, and `todo` contains `a[r]` and `a[r - m]` if `old` is in `done`; otherwise, `todo` either contains `a[r]` or does not contain `a[r]`.
Postcondition: `r` is `m`, `old` remains in `extra` and `done`, and `todo` and `extra` are updated as follows: if `a[r]` is in `todo`, then `old` is added to `todo` and removed from `extra` and `done`; otherwise, `extra` includes `a[r]` and `done` includes `old`.
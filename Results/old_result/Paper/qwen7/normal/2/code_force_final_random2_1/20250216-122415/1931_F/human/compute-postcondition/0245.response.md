Postcondition: `i` is `k+3`, `idx1` is either `i` or `k+3`, `idx2` is either `k+3` or `i`, `p1` is either 1 or remains the same, `p2` is either 1 or remains the same. If `i + max(p1, p2) == n - 1`, we break out of the most internal loop or if statement.
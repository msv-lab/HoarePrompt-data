Postcondition: `i` is either `n - 4` or `n - 5`, `k` is updated as `k * a[q] % m`, where `q` is either `q2 + 1` if `t[i] == 'R'` or `q1 - 1` if `t[i] != 'R'`.
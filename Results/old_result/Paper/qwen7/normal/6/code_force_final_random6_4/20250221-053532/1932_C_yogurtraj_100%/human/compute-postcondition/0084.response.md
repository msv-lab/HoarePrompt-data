Postcondition: `i` is either `n - 3` or `n - 4`; `k` is updated as follows: if `t[i]` equals 'R', `k` is `k * a[q2] % m` (or `k * a[q1] % m` depending on the condition); `y[i]` is updated to `k * a[q2] % m` if `t[i]` equals 'R', otherwise `y[i]` is `k * a[q1] % m`; if `t[i]` equals 'R', `q2` is incremented by 1, otherwise `q1` is decremented by 1.
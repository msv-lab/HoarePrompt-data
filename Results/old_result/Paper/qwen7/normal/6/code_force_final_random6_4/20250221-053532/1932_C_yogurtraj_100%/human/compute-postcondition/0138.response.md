Postcondition: `i` is either -1 or -3, `n` must be at least 1, `k` is updated as `k * a[q2] % m` if `t[i] == 'R'` and `k * a[q1] % m` otherwise, and `q2` is increased by 1 if `t[i] == 'R'`.
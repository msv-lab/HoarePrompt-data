Postcondition: `nx` is either 'FF' or 'SF' or 'FS' or 'SS', and `j` is in the range from `2` to `n/4`. If `i` is in the first quarter of `sa` or `j` is in the first quarter of `sa`, then `nx` is either 'FFF' or 'SFF' or 'FFS' or 'SSF'. Otherwise, `nx` is either 'FFS', 'SFS', 'FSF', or 'SSS'.
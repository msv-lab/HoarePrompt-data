Postcondition: `j` is 2, `i` is `n - 4`, `idx_B` is either `[i, n - 4]` or `[i]`, and `B` is either `[0]` or `[x, 2 * (n - 4)]`, where `x` is `2 * (n - 4)` if `idx_B` is not empty.
row is a list of lists where each inner list represents a row of the river grid, with each element being the depth in the corresponding cell (0 at the river banks). d is an integer representing the maximum allowed distance between any pair of adjacent supports.
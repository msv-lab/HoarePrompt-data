Postcondition: `res` is an empty list, `i` is `n + 2`, and either we break out of the most internal loop or if statement, or there is no else part since `ul == ur`.
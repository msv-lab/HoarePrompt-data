The function processes multiple test cases, where each test case consists of a positive integer `t` (1 ≤ t ≤ 10^4) and a string `s` of lowercase Latin letters with length `n` (1 ≤ n ≤ 10^6). For each test case, it counts and prints the total number of non-overlapping occurrences of the substrings 'map' or 'pie' within the string `s`. After processing all test cases, it prints the count for each case.
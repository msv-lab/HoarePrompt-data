Postcondition: `ans` is 2, `r` is `m`, `old` is `a[r - m]`, and `old` is either already in `done` or has been added to `todo`.
Correctness: True, Confidence: 95

The program appears to be correct based on the problem description and the provided examples. The program generates all possible permutations of the remaining characters after removing the substring from the original string, then checks if the generated number is valid by ensuring the substring is present and the length matches. Finally, it returns the smallest valid number. The logic seems sound and covers all possible cases as described in the problem.
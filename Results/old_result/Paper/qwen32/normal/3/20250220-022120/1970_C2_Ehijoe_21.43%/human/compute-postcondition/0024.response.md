Postcondition: **`nodes` is a defaultdict where each key `u` has a list of connected nodes `v` and must have at least one key-value pair. `key` is `key_next`, which is the next key in `nodes` that has not been processed yet. If the list associated with `key` has exactly one element, then `leaves` includes `key_next` as one of its elements.**
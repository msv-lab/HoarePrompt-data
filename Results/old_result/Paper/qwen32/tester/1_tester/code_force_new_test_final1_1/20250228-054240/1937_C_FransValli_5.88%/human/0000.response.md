Certainly! Below are comprehensive test cases for the given problem, covering both basic and edge scenarios.

### Basic Test Cases

#### Test 1: Small Input with Known Permutation
**Input**:
```
1
4
```
**Output**:
```
? 0 1 2 3
? 0 2 1 3
? 0 3 1 2
! 1 3
```
**Explanation**: This test case uses a small permutation (0, 1, 2, 3) to verify the basic functionality of the solution.

#### Test 2: Another Small Input with Known Permutation
**Input**:
```
1
4
```
**Output**:
```
? 0 1 2 3
? 0 3 1 2
? 1 2 0 3
! 3 2
```
**Explanation**: This test case uses a different permutation (0, 3, 1, 2) to verify the solution's ability to handle different permutations.

### Edge Test Cases

#### Test 3: Minimum Size Input
**Input**:
```
1
2
```
**Output**:
```
? 0 1 0 1
! 0 1
```
**Explanation**: This test case uses the minimum possible input size (n=2) to verify the solution's behavior with the smallest possible input.

#### Test 4: Maximum Size Input with Known Permutation
**Input**:
```
1
10000
```
**Output**:
```
? 0 1 2 3
? 0 2 1 3
? 0 3 1 2
...
! 9998 9999
```
**Explanation**: This test case uses the maximum possible input size (n=10000) to verify the solution's scalability and ability to handle large inputs.

#### Test 5: Permutation with Repeated XOR Maximum
**Input**:
```
1
4
```
**Output**:
```
? 0 1 2 3
? 0 2 1 3
? 0 3 1 2
! 1 3
```
**Explanation**: This test case uses a permutation where multiple pairs have the same maximum XOR value to verify the solution's ability to handle ties.

#### Test 6: Permutation with All Elements Different XOR Values
**Input**:
```
1
4
```
**Output**:
```
? 0 1 2 3
? 0 2 1 3
? 0 3 1 2
! 1 3
```
**Explanation**: This test case uses a permutation where all pairs have different XOR values to verify the solution's ability to find the unique maximum XOR pair.

#### Test 7: Permutation with Increasing Order
**Input**:
```
1
5
```
**Output**:
```
? 0 1 2 3
? 0 2 1 3
? 0 3 1 2
? 0 4 1 2
? 1 2 3 4
? 1 3 2 4
? 1 4 2 3
? 2 3 4 0
? 2 4 3 0
? 3 4 2 0
! 3 4
```
**Explanation**: This test case uses a permutation in increasing order (0, 1, 2, 3, 4) to verify the solution's behavior with a simple, ordered permutation.

#### Test 8: Permutation with Decreasing Order
**Input**:
```
1
5
```
**Output**:
```
? 0 1 2 3
? 0 2 1 3
? 0 3 1 2
? 0 4 1 2
? 1 2 3 4
? 1 3 2 4
? 1 4 2 3
? 2 3 4 0
? 2 4 3 0
? 3 4 2 0
! 0 1
```
**Explanation**: This test case uses a permutation in decreasing order (4, 3, 2, 1, 0) to verify the solution's behavior with a simple, ordered permutation.

#### Test 9: Large Input with Random Permutation
**Input**:
```
1
10000
```
**Output**:
```
? 0 1 2 3
? 0 2 1 3
? 0 3 1 2
...
! 9998 9999
```
**Explanation**: This test case uses a large permutation with random values to verify the solution's ability to handle random permutations.

#### Test 10: Multiple Test Cases with Different Sizes
**Input**:
```
3
2
4
10000
```
**Output**:
```
? 0 1 0 1
! 0 1
? 0 1 2 3
? 0 2 1 3
? 0 3 1 2
! 1 3
? 0 1 2 3
? 0 2 1 3
? 0 3 1 2
...
! 9998 9999
```
**Explanation**: This test case includes multiple test cases with different sizes to verify the solution's ability to handle multiple test cases efficiently.

These test cases should cover a wide range of scenarios, ensuring the robustness, reliability, and scalability of the solution.
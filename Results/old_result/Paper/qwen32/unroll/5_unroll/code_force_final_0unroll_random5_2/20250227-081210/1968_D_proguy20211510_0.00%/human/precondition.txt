t is a positive integer (1 ≤ t ≤ 10^4). test_cases is a list of tuples, where each tuple contains four integers (n, k, P_B, P_S) and two lists (p, a). Each tuple represents a test case with 1 ≤ P_B, P_S ≤ n ≤ 2 × 10^5, 1 ≤ k ≤ 10^9, p is a permutation of length n with elements in the range [1, n], and a is a list of n integers with elements in the range [1, 10^9]. The sum of values of n over all test cases does not exceed 2 × 10^5.
Correctness: **False**

The provided program is incorrect due to a mistake in the calculation of the expected value of the sum of friendship values for all k pairs chosen for the excursions. The current implementation incorrectly calculates the expected value and the probability components.

Here's a brief overview of the issues:
- The formula used in the program to compute `p` and `q` does not correctly reflect the expected value calculation.
- The probability of selecting a specific pair of friends during an excursion is not properly considered.
- The calculation of the expected increase in friendship values for each pair of friends over k excursions is not correctly implemented.

The correct way to approach the problem involves calculating the expected contribution of each pair of friends to the total sum of friendship values. This can be done by considering the probability of selecting each pair and the expected number of times their friendship value is incremented.

Here is a corrected version of the program:

```python
import math

def func():
    t = int(input())
    M = 10 ** 9 + 7
    for i in range(t):
        (n, m, k) = map(int, input().split())
        pairs = {}
        for j in range(m):
            (a, b, f) = map(int, input().split())
            if a > b:
                a, b = b, a
            pairs[(a, b)] = f
        total_pairs = n * (n - 1) // 2
        expected_sum = 0
        for (a, b), f in pairs.items():
            prob = 1 / total_pairs
            expected_increase = 0
            for x in range(1, k + 1):
                expected_increase += x * prob
                prob *= (k - x) / (total_pairs - 1)
            expected_sum += f * expected_increase
        for non_friend in range(total_pairs - m):
            prob = 1 / total_pairs
            expected_increase = 0
            for x in range(1, k + 1):
                expected_increase += x * prob
                prob *= (k - x) / (total_pairs - 1)
            expected_sum += 0 * expected_increase
        p = int(expected_sum * total_pairs)
        q = total_pairs ** k
        gcd = math.gcd(p, q)
        p //= gcd
        q //= gcd
        print(int(p * pow(q, -1, M) % M))

func()
```

This corrected program calculates the expected sum of friendship values for all k pairs chosen for the excursions by considering the probability of selecting each pair and the expected number of times their friendship value is incremented. It then calculates the result as a fraction and reduces it to its simplest form before computing the final result modulo \(10^9 + 7\).
lists is a list of lists, and each sublist should be a non-empty list.
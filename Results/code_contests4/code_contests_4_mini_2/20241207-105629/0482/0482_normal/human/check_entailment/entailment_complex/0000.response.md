To determine the correctness of the provided program based on the problem description, we need to analyze the functionality of the code and see if it meets the requirements stated in the problem.

### Problem Requirements Recap:
The task is to count the number of subarrays in an array `a` such that there are at least `k` equal numbers within those subarrays.

### Analysis of the Provided Code:
1. **Input Handling**: The code reads two integers `n` and `k`, followed by an array of integers `vals`. This is consistent with the problem description.

2. **Case for `k = 1`**: 
   - The program calculates the total number of subarrays when `k = 1` as `count = n * (n + 1) / 2`. This formula correctly computes the number of subarrays for any array of size `n`, as every element contributes to multiple subarrays.

3. **Case for `k > 1`**:
   - The code initializes a counter (`count`) and a dictionary (`d`) to keep track of the indices of occurrences of each value.
   - It iterates through each value in `vals`, updating the dictionary with the indices of occurrences.
   - When a value has at least `k` occurrences, it maintains the index of the leftmost occurrence of the `k`-th most recent occurrence.
   - The `count` is incremented by `leftmost + 1`, which effectively counts how many subarrays end at the current index `i` that can include the `k`-th occurrence.

### Correctness Consideration:
- The handling of `k = 1` is straightforward and correct.
- For `k > 1`, the logic builds upon previously encountered indices, correctly updating the leftmost index of the `k`-th occurrence. The counting mechanism correctly adds to `count` based on valid subarrays ending at index `i`.

### Edge Cases:
- The code does not explicitly check for the case where `k` is greater than `n`, but this is inherently handled because if there are not enough occurrences to reach `k`, `count` will simply not increment beyond its initial value.

### Conclusion:
The provided program adheres to the requirements of the problem statement. The logic correctly counts the number of valid subarrays that contain at least `k` equal numbers. 

Thus, the program is correct based on the problem description.

Correctness: **True**
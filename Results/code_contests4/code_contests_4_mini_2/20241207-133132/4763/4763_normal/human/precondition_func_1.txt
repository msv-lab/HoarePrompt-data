n is an integer (2 ≤ n ≤ 3 ⋅ 10^5) representing the length of the bitstring, k is an even integer (2 ≤ k ≤ n) representing the parameter for a balanced bitstring, and s is a string of length n consisting only of the characters '0', '1', and '?'. The total number of test cases t (1 ≤ t ≤ 10^4) is provided, with the sum of n over all test cases not exceeding 3 ⋅ 10^5.
Correctness: **False**

The program fails to correctly calculate the minimum and maximum possible sums for certain cases. Specifically, the issue lies in the way it calculates the sums based on the sorted counts of the fruits Valera wants to buy. 

Hereâ€™s a potential edge case where the program does not work correctly:

Consider the following input:

```
3 3
10 1 5
apple
banana
banana
```

Expected output should be:
- Minimum: 1 (for banana) + 5 (for apple) = 6
- Maximum: 10 (for banana) + 10 (for banana) + 5 (for apple) = 25

However, based on the current implementation, the program incorrectly calculates the minimum and maximum sums due to the way it pairs the cheapest prices with the counts of fruits. The logic behind how the fruits are matched with the prices does not ensure that the most frequent fruits get the cheapest prices, nor does it handle the cases where multiple identical fruits can have their prices maximized incorrectly. 

Thus, the program does not handle all potential cases correctly as specified in the problem description.
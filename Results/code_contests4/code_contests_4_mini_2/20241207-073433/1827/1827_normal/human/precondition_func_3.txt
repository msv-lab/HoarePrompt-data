n is a non-negative integer representing the number of nodes in a directed graph, and the function processes a list of directed edges and a sequence of queries on pairs of nodes (u, v) where 0 <= u, v < n. The number of edges must satisfy 0 <= |E| <= 30,000, and the number of queries Q must satisfy 1 ≤ Q ≤ 100,000.
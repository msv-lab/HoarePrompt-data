t is an integer with 1 ≤ t ≤ 100, n is an integer with 1 ≤ n ≤ 300 for each test case, and the grid consists of n strings of length n containing only the characters 'X' or '.' (no 'O' characters allowed), with at least one non-empty cell. The sum of n across all test cases does not exceed 300.
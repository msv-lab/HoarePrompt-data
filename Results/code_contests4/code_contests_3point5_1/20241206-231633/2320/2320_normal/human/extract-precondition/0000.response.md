**Precondition:**

- n, m, dx, dy are positive integers such that 1 ≤ n ≤ 10^6, 1 ≤ m ≤ 10^5, 1 ≤ dx, dy ≤ n.
- xi, yi are non-negative integers such that 0 ≤ xi, yi ≤ n - 1.
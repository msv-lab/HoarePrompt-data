**Precondition**: 
- n is a positive integer such that 1 ≤ n ≤ 100,000.
- x1, y1, x2, y2 are non-negative integers such that 0 ≤ x1 ≤ x2 ≤ 100,000 and 0 ≤ y1 ≤ y2 ≤ 100,000.
- rix, riy, vix, viy are integers such that 0 ≤ rix, riy ≤ 100,000 and -100,000 ≤ vix, viy ≤ 100,000.
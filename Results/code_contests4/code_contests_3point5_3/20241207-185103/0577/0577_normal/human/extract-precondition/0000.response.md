**Precondition:**

- n is a positive integer (1 ≤ n ≤ 105).
- Each person in the tree is represented by a unique number from 1 to n.
- For each person i (1 ≤ i ≤ n):
  - si is a non-empty string representing the name of the person.
  - ri is an integer such that 0 ≤ ri ≤ n, where ri represents the direct ancestor of person i (if ri = 0, person i has no direct ancestor).
- m is a positive integer (1 ≤ m ≤ 105).
- For each record j (1 ≤ j ≤ m):
  - vi and ki are positive integers such that 1 ≤ vi, ki ≤ n.
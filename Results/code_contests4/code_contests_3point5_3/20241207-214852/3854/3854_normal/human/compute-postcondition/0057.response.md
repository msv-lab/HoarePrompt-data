Output State: **`n`, `m`, `k`, `ins`, `cell`, `nn`, `core`, `i`, `j`, `d` are as described. `nn[d]` is updated to `j` based on the conditions mentioned.**
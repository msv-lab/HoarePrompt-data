**Precondition:**

- t is a positive integer representing the number of test cases.
- n, m, and k are positive integers such that 1 ≤ m ≤ n ≤ 3500 and 0 ≤ k ≤ n - 1.
- a_i are positive integers representing elements of the array.
- l, r, seglen are integers used in the function.
- A, prilist are lists used in the function.
- pri_idx is an integer representing an index used in the function.
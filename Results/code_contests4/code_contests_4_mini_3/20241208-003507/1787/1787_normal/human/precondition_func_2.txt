n is a positive integer representing the length of the password, r is an array of n positive integers, fact and ifact are lists of precomputed factorials and their modular inverses, respectively.
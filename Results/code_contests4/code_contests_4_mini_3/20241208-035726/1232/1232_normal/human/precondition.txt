T is an integer such that 1 ≤ T ≤ 150000, n is an integer such that 2 ≤ n ≤ 300000 for each test case, and for each monster i, a_i and b_i are integers such that 1 ≤ a_i, b_i ≤ 10^{12}. The total number of monsters across all test cases does not exceed 300000.
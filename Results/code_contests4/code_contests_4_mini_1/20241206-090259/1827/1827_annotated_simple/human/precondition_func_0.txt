frm is a directed graph represented as a list of edges where each edge is a tuple (si, ti) indicating a directed edge from si to ti, and to is a list of queries where each query is a tuple (ui, vi) representing a pair of nodes. The graph contains |V| nodes (0 to |V|-1) and |E| edges, with constraints 1 ≤ |V| ≤ 10,000 and 0 ≤ |E| ≤ 30,000. The number of queries Q is between 1 and 100,000.
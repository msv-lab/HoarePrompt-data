now is a node in the directed graph represented by integers from 0 to |V|-1, used is a set of nodes that have been visited, and back_track is a data structure used to manage the traversal of the graph. The graph has |V| nodes (1 ≤ |V| ≤ 10,000) and |E| edges (0 ≤ |E| ≤ 30,000), and the queries consist of pairs of nodes (u, v) where 1 ≤ Q ≤ 100,000.
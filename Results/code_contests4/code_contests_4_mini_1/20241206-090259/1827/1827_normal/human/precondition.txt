G is a directed graph represented by a set of edges where each edge is a pair of integers (si, ti) indicating a directed connection from node si to node ti. The number of nodes |V| is an integer in the range 1 to 10,000 and the number of edges |E| is an integer in the range 0 to 30,000. Each query consists of a pair of nodes (ui, vi) where 0 <= ui, vi < |V|, and Q is a non-negative integer such that 1 <= Q <= 100,000.
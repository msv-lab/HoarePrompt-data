t is an integer such that 1 ≤ t ≤ 100; n is an integer such that 1 ≤ n ≤ 300 for each test case; the grid consists of n strings of length n, where each character is either '.' or 'X', and it is guaranteed that not all cells are empty; the sum of n across all test cases does not exceed 300.
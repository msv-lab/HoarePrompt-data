t is an integer such that 1 ≤ t ≤ 100, n is an integer such that 1 ≤ n ≤ 300 for each test case, and the grid is represented as n strings of length n containing only characters 'X' or '.', where at least one cell is not empty. The total sum of n across all test cases does not exceed 300.
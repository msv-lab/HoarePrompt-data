t is an integer such that 1 ≤ t ≤ 100, n is an integer such that 1 ≤ n ≤ 300 for each test case, and the grid consists of n strings of length n where each character is either '.', or 'X'. The total number of cells across all test cases is guaranteed to be non-empty and does not exceed 300.
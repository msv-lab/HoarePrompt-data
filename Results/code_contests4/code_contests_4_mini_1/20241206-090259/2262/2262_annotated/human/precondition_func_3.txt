The function processes multiple test cases where each test case consists of an integer n (1 ≤ n ≤ 300) representing the size of a Tic-Tac-Toe grid, followed by n strings of length n containing either the character '.' for empty cells or 'X' for cells containing tokens. It is guaranteed that not all cells are empty and that the character 'O' does not appear in the input. The total sum of n across all test cases does not exceed 300.
x is a list of tuples where each tuple contains two integers a and b (1 ≤ b < a ≤ 3 ⋅ 10^5), and r is a list of strings where each string consists of characters '.' and 'X' with length between 1 and 3 ⋅ 10^5. The total length of all strings in r does not exceed 3 ⋅ 10^5.
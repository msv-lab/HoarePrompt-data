Output State: **`p` is a list representing the longest prefix which is also a suffix for each index in `v`, `ans` is the count of valid indices in `v` where `p[i]` is equal to `len(s) - 2` and both `c(v[i - p[i]], s[0])` and `c(v[i + 1], s[-1])` are true, `len(v)` is at least 2.**
The function accepts two integers `n` and `m`, representing the number of pairs of distinct integers from two sets. It processes these pairs to determine if there is exactly one valid match for either set, based on shared numbers between the pairs. If there is exactly one match, it returns the shared number; otherwise, it returns 0. If there is any inconsistency or invalid match during processing, it outputs -1. The function does not handle cases where the input pairs might not adhere to the specified constraints.
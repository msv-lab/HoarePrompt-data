Functionality: ** The function accepts an integer `n` (where 2 ≤ n ≤ 300,000) and a list `h` of `n` integers (where each integer satisfies 1 ≤ h[i] ≤ 1,000,000,000). It calculates the minimum number of operations needed to transform the sequence in `h` such that each element is either less than or equal to the next or greater than or equal to the next. The function ultimately returns this minimum number of operations as the last element of the `dp` list, which keeps track of the minimum operations for each index. **
Output State: **`hidx` is equal to the length of `h`, `pidx` is equal to the length of `p` if all elements in `p` are less than or equal to the furthest right position calculated during the last iteration; otherwise, `pidx` is the first index in `p` that exceeds the last calculated `furthestright`; `works` is False.**
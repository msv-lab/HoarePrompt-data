Correctness: **False**

The code provided does not fully adhere to the problem description for every potential case. One key issue is that the code does not properly handle Type 2 queries where the number of different characters occurring in the substring of S between the l_q-th and r_q-th characters (inclusive) should be calculated. The implementation of the function `func_3` does not accurately compute the number of different characters in the specified substring.

Therefore, the code is incorrect as it fails to meet the requirements of the problem description for all potential cases.
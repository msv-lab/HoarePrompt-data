**Precondition:**

- t is a positive integer less than or equal to 1000.
- n, m, and k are positive integers such that 1 ≤ m ≤ n ≤ 3500 and 0 ≤ k ≤ n - 1.
- a_i are positive integers such that 1 ≤ a_i ≤ 10^9.
- l, r, k, pri_idx, seglen are all integers.
- A is a list of positive integers.
- prilist is a list containing tuples of integers.
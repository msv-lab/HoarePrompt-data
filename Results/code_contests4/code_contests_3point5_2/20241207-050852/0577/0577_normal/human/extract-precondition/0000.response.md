**Precondition:**
- n is an integer representing the number of people in the family tree (1 ≤ n ≤ 10^5).
- Each person in the tree is represented by a unique number from 1 to n.
- For each person i (1 ≤ i ≤ n), the i-th line contains a string si representing the name of the person and an integer ri representing the number of the direct ancestor of person i (0 ≤ ri ≤ n).
- m is an integer representing the number of records Polycarpus has (1 ≤ m ≤ 10^5).
- For each record j (1 ≤ j ≤ m), the j-th line contains integers vj and kj representing the person number vi and the depth ki for which Polycarpus wants to find the number of distinct names among all the ki-sons of person vi (1 ≤ vi, ki ≤ n).
Correctness: **True**

Explanation: 
- The code reads the number of balls and their coordinates correctly.
- It then calculates the minimum total cost required to collect all the balls based on the given conditions.
- The functions provided handle the logic of choosing the optimal p and q values to minimize the cost effectively.
- The code follows the problem description for every potential case, as it correctly implements the required operations to collect all the balls with the minimum total cost.
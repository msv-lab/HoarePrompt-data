Output State: **`q` is non-empty; `cur` is the next leftmost element of `q` after processing the current `to`; `e[cur]` contains at least one element; `top` is equal to `to`.**
Correctness: **False**

Explanation: The provided program does not correctly identify unique teams for all regions as per the problem description. Specifically, the program fails to handle cases where multiple teams meet the criteria but does not ensure the selection of the lexicographically smallest team if there are ties in scores.

Consider the following input:
```
5 2
Ivanov 1 800
Andreev 2 763
Petrov 1 800
Sidorov 1 800
Semenov 2 503
```

The output of the program is:
```
?
Andreev Semenov
```

However, according to the problem description, the team from region 1 can have three possible combinations ("Ivanov"-"Petrov", "Ivanov"-"Sidorov", "Petrov"-"Sidorov") since all three have the highest score of 800. The program should return `?` for both regions because it cannot uniquely determine the teams.

To fix this, the program needs to ensure that if there are multiple teams with the highest score, it selects the lexicographically smallest pair. Additionally, it should correctly handle the case where the third-highest score is equal to the highest or second-highest score.
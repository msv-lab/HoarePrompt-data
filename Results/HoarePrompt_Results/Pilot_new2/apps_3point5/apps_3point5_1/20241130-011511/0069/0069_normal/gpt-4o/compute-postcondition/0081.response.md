Output State: prefix_balances is a list of running balances starting from 0 of length n + 1.
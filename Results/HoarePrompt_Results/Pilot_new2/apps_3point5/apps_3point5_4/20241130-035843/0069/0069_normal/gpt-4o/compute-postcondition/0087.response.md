Output State: **`n` must be greater than 2, `x`, `s`, `balance`, `prefix_balances`, `results`, and `T` must be correctly updated. `prefix_balances[i]` will be updated as described.**
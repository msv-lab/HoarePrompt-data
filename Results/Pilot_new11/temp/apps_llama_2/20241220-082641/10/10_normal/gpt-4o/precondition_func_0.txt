There are integer variables d, n, m, representing the number of sofas in the storehouse, and the size of the storehouse respectively. There is a list of d sofas, each sofa represented by four integer coordinates (x1, y1, x2, y2) with 1 ≤ x1, x2 ≤ n, 1 ≤ y1, y2 ≤ m, the cells (x1, y1) and (x2, y2) have a common side, and no cell is covered by more than one sofa. Additionally, there are four integer variables cntl, cntr, cntt, cntb with 0 ≤ cntl, cntr, cntt, cntb ≤ d - 1, representing the number of sofas to the left, right, top, and bottom of the target sofa, respectively, with 1 ≤ d ≤ 10^5, 1 ≤ n, m ≤ 10^5.
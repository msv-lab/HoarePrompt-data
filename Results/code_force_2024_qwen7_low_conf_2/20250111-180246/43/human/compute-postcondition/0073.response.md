Postcondition: **`total` is 0, `n` is at least 1, `p` is `fa[i] - 1`, `i` is `i_prev - 1`. If `p != -1`, then `dp1[p]` is updated to `dp1[p] + min(dp1[i], dp2[i] + 1)`, and `dp2[p]` is updated to `dp2[p] + min(dp1[i] + 1, dp2[i])`. Otherwise, no changes are made to `dp1[p]` and `dp2[p]`.**
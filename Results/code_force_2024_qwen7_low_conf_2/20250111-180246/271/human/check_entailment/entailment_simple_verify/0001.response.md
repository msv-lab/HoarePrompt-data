### Reasoning:

1. **Magic Words Generation**:
   - The `func_1` function generates `n` distinct magic words, each with a random length between 1 and 30 * n characters. Each character is randomly chosen to be either 'X' or 'O'.
   - This part is correctly implemented and ensures that the magic words meet the problem requirements.

2. **Substrings Calculation**:
   - The `func_2` function calculates the number of unique non-empty substrings of a given string `s`. It iterates through all possible substrings and adds them to a set, ensuring uniqueness.
   - This function is correctly implemented and accurately computes the number of unique non-empty substrings.

3. **Spell Power Matching**:
   - The `func_3` function takes a list of magic words and a target spell power. It checks all possible pairs of magic words (including the same word twice) to see if their concatenated result matches the target spell power.
   - The function returns the indices of the matching pair if found, otherwise, it returns (-1, -1).
   - However, there is a critical issue in the `func_3` function. It does not ensure that the indices returned are in the correct order. If `w_u` and `w_v` are the words used by a student, the function might return `(v + 1, u + 1)` instead of `(u + 1, v + 1)`. This can lead to incorrect results if the student provides a power that can be matched by either order of the words.

4. **Interaction**:
   - The main logic reads the input `n`, prints `n` magic words, reads the number of students `q`, and then processes each student's request to find the indices of the magic words that match the given spell power.
   - The interaction follows the specified protocol, including flushing the output streams after each step.

### Correctness Analysis:

- **Magic Word Generation**: The generation of magic words is random but meets the constraints and requirements.
- **Substring Counting**: The substring counting logic is accurate and handles all possible substrings without duplicates.
- **Spell Power Matching**: The logic for matching the spell power to the correct pair of magic words is thorough and covers all cases, including when the same word is used twice. However, the function does not guarantee that the indices are in the correct order, which can lead to incorrect results.

### Conclusion:

Given that the `func_3` function does not ensure that the indices returned are in the correct order, the program is not fully correct according to the problem statement. Therefore, the original assessment is inaccurate.

### Final: **False**
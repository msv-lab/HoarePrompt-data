### Reasoning:

1. **Magic Words Generation**:
   - The `func_1` function correctly generates `n` distinct magic words, each with a random length between 1 and 30 * n characters, consisting of 'X' and 'O'.
   - This part is correctly implemented and ensures that the magic words meet the problem requirements.

2. **Substrings Calculation**:
   - The `func_2` function correctly calculates the number of unique non-empty substrings of a given string `s` by adding substrings to a set and returning the size of the set.
   - This function is correctly implemented and accurately computes the number of unique non-empty substrings.

3. **Spell Power Matching**:
   - The `func_3` function iterates through all possible pairs of magic words (including the same word twice) to find a pair whose concatenated result matches the given spell power.
   - However, there is a critical issue in the implementation of `func_3`. The function does not account for the possibility that the same magic word might be used twice. While the function will correctly identify the indices if both words are distinct, it might fail to find the correct indices if the same word is used twice in the spell.

   Specifically, consider the case where the same magic word `w_i` is used twice to form the spell `w_i + w_i`. The number of unique substrings of `w_i + w_i` is not necessarily double the number of substrings of `w_i`, and the function `func_2` does not distinguish this case. Therefore, `func_3` may not correctly identify the indices in such cases.

4. **Interaction**:
   - The main logic correctly reads `n`, prints the generated magic words, reads the number of students `q`, and processes each student's request to find the indices of the magic words that match the given spell power.
   - The interaction follows the specified protocol, including flushing the output streams after each step.

### Correctness Analysis:

- **Magic Word Generation**: The generation of magic words is random but meets the constraints and requirements.
- **Substring Counting**: The substring counting logic is accurate and handles all possible substrings without duplicates.
- **Spell Power Matching**: The logic for matching the spell power to the correct pair of magic words is thorough and covers all cases, except when the same word is used twice. In such cases, the function might fail to find the correct indices.

Given that the function `func_3` fails to handle the case where the same magic word is used twice, the overall program is not fully correct.

### Correctness: **False**

### Final Evaluation:
Final: **False**
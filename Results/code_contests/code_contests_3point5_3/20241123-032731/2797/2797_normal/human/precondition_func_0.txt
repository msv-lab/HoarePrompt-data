**Precondition**: n, m, and k are positive integers such that 1 <= n, m <= 5000, n * m <= 100,000, and 1 <= k <= 100,000. Each query input (ri, ai) or (ci, ai) satisfies the given constraints.
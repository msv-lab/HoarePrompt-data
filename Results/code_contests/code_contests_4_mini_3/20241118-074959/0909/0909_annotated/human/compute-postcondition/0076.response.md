Postcondition: ***`a` is non-empty, `gaps` contains the previous value of `gl`, and `specialgap` is less than `k`.***
Postcondition: ***`pi[u]` is `v`, `visited[u]` is `True`, `determinate` is either `True` or retains its original value `False`, `stack` is non-empty with the new top element being `u`. If `not determinate`, then `distances1[u]` is updated to `distances1[v] + 1` and `distances2[u]` is set to `heights1[u]`. Otherwise, `distances1[u]` is updated to the maximum of `heights1[u]` and `distances2[v] + 1`, while `distances2[u]` remains unchanged as the maximum of its previous value and `distances2[v] + 1` or `heights1[u]`.***
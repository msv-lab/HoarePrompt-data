The function `func_5` performs a depth-first search (DFS) starting from one of the attacked cities. It updates the `pi` list to store the parent of each city in the DFS tree, sets the `visited` list to indicate visited cities, and calculates two distance lists (`distances1` and `distances2`) representing the maximum distance from the root city to each city in the DFS tree under two different scenarios. Specifically, for each city `u` in the DFS tree starting from the initial city `v`, it sets `pi[u]` to `v`, marks `u` as visited, and updates `distances1[u]` and `distances2[u]` based on the conditions involving `heights1[u]`, `distances1[v]`, and `distances2[v]`. If certain conditions are met, it also updates `distances2[u]` accordingly. The function covers all cities reachable from the initial attacked city and ensures that the `stack` is eventually empty. Potential edge cases include scenarios where the initial city has no unvisited adjacent cities or where the `adjacents_list` might be empty for some cities. The function does not handle cases where the `numbers_of_attacked_cities` list is empty, which could lead to an error if `numbers_of_attacked_cities[0]` is accessed without checking its length.
(n, i) are integers such that 1 ≤ n ≤ 4 ⋅ 10^5 and 1 ≤ i ≤ 10^8; ca is a list of tuples where each tuple contains a unique integer from the input list and its frequency, sorted by the integer values; md is an integer calculated as the smallest power of 2 such that the number of distinct values K is less than or equal to 2^md, which is determined by the formula md = 2^(8 * i / n); pref is a prefix sum list of the frequencies of the unique integers; s is the initial count of the minimum number of changes needed, initialized to n; the loop iterates over a range determined by the length of pref minus md, calculating the number of unchanged elements for each segment and updating s with the minimum value found; if the range end is less than or equal to 0, s is set to 0 before calling func_2(s).
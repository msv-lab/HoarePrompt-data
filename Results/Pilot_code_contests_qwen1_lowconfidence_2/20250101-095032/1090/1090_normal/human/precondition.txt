n is an integer such that 1 <= n <= 10^3, s is a string of length n consisting of lowercase English letters, and a is a list of 26 integers where 1 <= a[i] <= 10^3 representing the maximum lengths of substrings each letter can appear in.
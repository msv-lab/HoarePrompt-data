x is a list of tuples, where each tuple contains a name (string) and an integer representing the direct ancestor index (or 0 if no direct ancestor), and dep is a list of length 2 containing two positive integers vi and ki respectively (1 ≤ vi, ki ≤ n).
Output State: **N, M, S, mod, i, j, k, dp remain the same.**
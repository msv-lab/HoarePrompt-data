Postcondition: ***`N` is a positive integer, `M` is a positive integer, `S` is a positive integer, `i` is a positive integer (1 ≤ i ≤ N^2), `j` is at least 3, `dp` reflects the cumulative results of the iterations, `s` is at least 2, and `k` is 1 for the first iteration. The variable `i` is greater than 0, and `j` is greater than `k`.***
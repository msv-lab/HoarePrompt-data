Postcondition: ***N, M, S, mod, m, j+1, k+1, s+1 are integers. If j >= k, i is updated to 1 and dp is updated with a new value.***
**Precondition:**

For each dataset, N is an integer such that 1 <= N <= 7, M is an integer such that 1 <= M <= 2000, and S is a positive integer such that 1 <= S <= 3000.
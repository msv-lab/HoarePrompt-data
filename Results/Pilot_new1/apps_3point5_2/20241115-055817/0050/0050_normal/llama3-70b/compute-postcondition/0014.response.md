Output State: **`n`, `m`, `r`, `s`, `b`, `shares` where `r` and `shares` are adjusted based on the loop logic**
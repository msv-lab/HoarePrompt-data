Postcondition: ***`n` is greater than 0, `i` is `i - 1` where `i` was either `n-1` or has been decremented until `S[i]` is not 'S'; `dp1` and `dp2` are lists of `n + 1` where `dp1[p]` is updated to `dp1[p] + min(dp1[i], dp2[i] + 1)` and `dp2[p]` is updated to `dp2[p] + min(dp1[i] + 1, dp2[i])`; `p` is `fa[i] - 1`.***
n is an integer representing the size of the chessboard (n x n), k is an integer representing the number of moves already played (0 <= k <= n), fact is a list of factorials precomputed up to n, and mod is the integer 10^9+7.
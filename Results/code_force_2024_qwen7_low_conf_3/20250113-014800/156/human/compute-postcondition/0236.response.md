Postcondition: ***`total` is unchanged, `t` is unchanged, `m` is unchanged, `k` is `k_val`, `n` is `n_val`, `b` is a list of elements from `a` that are in `s` and `leng` is the number of such elements, `mx` is the maximum value in `b`, `mx_ind_lt` is unchanged, `leng` is the number of elements added to `b`, `i` is `i + 1` (either `i_new + 2` or `i_val + 2`), and `res` is updated either to `res + (b[i] + c) * (k % m)` if `b[i] == mx` and `i == mx_ind_lt` holds true, or to `res_prev + (b[i] + c) * m` otherwise, with `c` updated accordingly in both cases.***
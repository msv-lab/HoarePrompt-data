Postcondition: **`n + m` must be at least 1, `val` is `ans - a[types[i]][i]`, `bad != -1`, `i >= bad` or `(types[i] != badType)`**
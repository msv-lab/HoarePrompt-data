Postcondition: ***`ans[x]` must be non-empty, `i` is the last element of `query[x]` at even indices, and `j` is the last element of `query[x]` at odd indices. If `j` is not in `ans[fa[x]]`, then `ans[fa[x]][j]` is equal to `ans[x][j]`. If `j` is in `ans[fa[x]]`, then the length of `ans[fa[x]][j]` is updated to the length of `ans[x][j]` if it is shorter, otherwise it remains unchanged and is at least as long as the length of `ans[x][j]`.***
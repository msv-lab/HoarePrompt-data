Postcondition: ***`pi` is a dictionary with key `u` mapped to value `v`; `visited` is a dictionary with key `u` mapped to value `True`; `determinate` remains `False` unless `distances1[u]` equals `heights1[u]`, in which case it becomes `True`; `stack` contains `u` (plus any other elements that were already in the stack); if `distances1[u]` equals `heights1[u]`, then `distances1[u]` is `max(heights1[u], distances2[v] + 1)` and `distances2[u]` is `max(distances2[v] + 1, heights2[u])`. Otherwise, `distances2[u]` is equal to `heights1[u]`.***
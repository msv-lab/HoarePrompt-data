Correctness: **False**

Explanation: The program does not handle the case where a user sends a message to themselves, which is explicitly stated in the problem description as being impossible. Additionally, the program does not sort the data by message times before processing, which could lead to incorrect results if the input is not perfectly sorted as required.

For example, consider the following input:
```
3 1
vasya vasya 1
petya vasya 2
vasya petya 3
```

According to the problem description, the first message from `vasya` to `vasya` should be ignored since no one can send a message to themselves. However, the current implementation would incorrectly process this message and potentially consider `vasya` and `petya` as friends, which is not correct.

To fix this, the program should include a check to ignore self-messages and ensure the data is properly processed in the correct order.
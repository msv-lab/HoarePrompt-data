Postcondition: `i` is either `n - 2` or `n - 3`, `k` is updated as `k * a[q1] % m` if `t[i]` is not 'R', otherwise `k` is updated as `k * a[q2] % m`. `q2` is incremented by 1 if `t[i]` is 'R'.
Postcondition: `i` is either `n - 2` or `n - 3`, `k` is updated as `k * a[q1] % m` or `k * a[q2] % m` depending on whether `t[i]` is 'R' or not, `n` must be greater than or equal to 1, and `q1` is decreased by 1 if `t[i]` is not 'R'.
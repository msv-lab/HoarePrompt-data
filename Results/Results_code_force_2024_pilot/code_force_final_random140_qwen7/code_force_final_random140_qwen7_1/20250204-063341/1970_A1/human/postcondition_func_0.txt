The function accepts a string `s` consisting only of "(" and ")", counts the balance of parentheses at each position, records the balance, index, and character at each step, sorts these records by balance and index, and finally returns a string formed by joining the characters in the sorted records, ending with the record showing a balance of 0 at the last index.
Correctness: **False**.

Explanation:
The program provided has several issues that make it incorrect according to the problem description:

1. **Variable Naming Conflicts**: The variable `d` is used both for the number of queries and as part of the loop for reading operations. This can lead to unexpected behavior and conflicts.

2. **Incorrect Logic for Operation Type 1**: The logic for appending an integer to the array is incorrect. The program uses `a[-1] += 1` and `b[a[-1]] = e`, which does not correctly append the integer to the array. Instead, it should simply append the integer to the array.

3. **Handling Large Arrays**: The program attempts to handle large arrays by using a dictionary `b` and a list `a` to keep track of the size of the array. However, the logic for updating and querying the array is flawed. Specifically, the way it handles the modulo operation and the dictionary lookups is not correct.

4. **Function `func_1`**: The function `func_1` is intended to handle the queries, but it is not defined in the provided code. The placeholder `r` is used in the `print` statement, which is not defined anywhere in the code.

5. **Incorrect Output Format**: The output format in the `print` statement is incorrect. It uses `str(list(map(r, input().split())))[1:-1].replace(',', '')`, which is not a valid way to format the output as required by the problem description.

Given these issues, the program does not correctly implement the required functionality for the problem description. Therefore, the program is incorrect.
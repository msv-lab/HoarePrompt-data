Reasoning:

1. **Input Handling**: The program correctly reads the number of test cases and processes each test case individually. For each test case, it reads the number of children (`n`), pairs of friends (`p`), and excursions (`k`).

2. **Friendship Values**: The program reads the friendship values for the `p` pairs of friends and sums them up. This is done correctly using a loop that iterates `p` times.

3. **Combinatorial Calculation**: The program calculates the total number of possible pairs of children, `C`, which is `n * (n - 1) // 2`. This is the correct combinatorial formula for choosing 2 children out of `n`.

4. **Expected Value Calculation**: The program calculates the numerator (`num`) and denominator (`den`) of the expected value expression. The formula used is:
   \[
   \text{num} = p \cdot k \cdot k - p \cdot k + 2 \cdot k \cdot C \cdot S
   \]
   \[
   \text{den} = 2 \cdot C \cdot C
   \]
   This formula seems to be derived from the problem's requirements, but it needs to be verified against the problem statement to ensure it matches the expected value calculation.

5. **Simplification and Modulo Operation**: The program simplifies the fraction by dividing both the numerator and the denominator by their greatest common divisor (GCD). It then computes the modular inverse of the denominator and multiplies it by the numerator to get the final result modulo \(10^9 + 7\).

6. **Output**: The program prints the result for each test case, which is the expected behavior.

However, there is a potential issue with the formula used for the expected value calculation. The formula provided in the program might not correctly reflect the expected value as described in the problem statement. Specifically, the expected value should account for the probability of selecting a friend pair and the increase in friendship value over multiple excursions.

Given the complexity of the problem, the formula used in the program might need to be re-evaluated to ensure it correctly computes the expected value. However, based on the provided execution summary and the structure of the program, it appears to follow the intended logic.

Correctness: **False**

The formula used for calculating the expected value might not be correct, and further verification is needed to ensure it aligns with the problem's requirements.
Reasoning:

1. **Input Parsing**: The program correctly parses the input for the number of test cases (`T`) and the parameters for each test case (`n`, `m`, `k`). It also reads the friendship values for each pair of friends.

2. **Sum of Friendship Values**: The program calculates the sum of the initial friendship values (`S`) for all pairs of friends. This is done correctly by iterating through the `m` pairs and summing the third element of each input line.

3. **Total Possible Pairs**: The program calculates the total number of possible pairs (`C`) using the combination formula \( \binom{n}{2} = \frac{n(n-1)}{2} \). This is correct.

4. **Expected Value Calculation**:
   - The numerator (`num`) is calculated as \( p \cdot k \cdot k - p \cdot k + 2 \cdot k \cdot C \cdot S \).
   - The denominator (`den`) is calculated as \( 2 \cdot C \cdot C \).

5. **GCD and Simplification**: The program simplifies the fraction by dividing both the numerator and the denominator by their greatest common divisor (GCD). This is a standard approach to reduce fractions to their simplest form.

6. **Modular Inverse**: The program calculates the modular inverse of the denominator using the `pow` function with the third argument as `MOD`. This is correct for finding the modular inverse under modulo \( 10^9 + 7 \).

7. **Final Answer**: The final answer is computed as \( \text{num} \cdot \text{den}^{-1} \mod (10^9 + 7) \) and printed for each test case.

However, there is a potential issue in the calculation of the numerator (`num`). The formula used seems to be derived from a specific mathematical expectation, but it's not immediately clear if it matches the problem's requirements. Specifically, the term \( p \cdot k \cdot k - p \cdot k \) might not be correct for the expected value calculation.

Given the complexity of the problem and the need to verify the correctness of the mathematical derivation, it's important to ensure that the formula used for the expected value is accurate. If the formula is correct, then the program is correct. If the formula is incorrect, the program will produce incorrect results.

Based on the provided code and the problem statement, the program appears to follow the correct steps, but the correctness of the formula used for the expected value needs to be verified.

Correctness: **False**

The reason for marking it as **False** is the potential issue with the formula used for the expected value calculation. The formula \( p \cdot k \cdot k - p \cdot k + 2 \cdot k \cdot C \cdot S \) needs to be re-evaluated to ensure it correctly represents the expected value of the sum of friendship values.
### Reasoning:

1. **Input Handling**:
   - The program correctly reads the number of test cases `T`.
   - For each test case, it reads `n`, `p`, and `k` which represent the number of children, the number of pairs of friends, and the number of excursions, respectively.
   - It then reads the friendship values for each pair of friends and sums them up in `S`.

2. **Sum of Friendship Values**:
   - The program initializes `S` to 0 and sums up the friendship values of all pairs of friends. This step is correct.

3. **Total Possible Pairs**:
   - The program calculates the total number of possible pairs of children using the combination formula \( C = \frac{n(n-1)}{2} \). This is correct.

4. **Expected Value Calculation**:
   - The program calculates the numerator `num` and the denominator `den` for the expected value.
   - The numerator is calculated as \( p \cdot k \cdot k - p \cdot k + 2 \cdot k \cdot C \cdot S \).
   - The denominator is calculated as \( 2 \cdot C \cdot C \).

5. **Simplification**:
   - The program simplifies the fraction by dividing both the numerator and the denominator by their greatest common divisor (GCD).
   - It then computes the modular inverse of the denominator modulo \( 10^9 + 7 \).

6. **Final Answer**:
   - The program multiplies the simplified numerator by the modular inverse of the denominator and takes the result modulo \( 10^9 + 7 \) to get the final answer.

### Detailed Evaluation:

- **Input Handling**: Correct. The program reads the input as specified in the problem description.
- **Sum of Friendship Values**: Correct. The program correctly sums the friendship values.
- **Total Possible Pairs**: Correct. The calculation of \( C \) is accurate.
- **Expected Value Calculation**:
  - The formula for the numerator \( p \cdot k \cdot k - p \cdot k + 2 \cdot k \cdot C \cdot S \) seems to be derived from the problem statement, but let's verify it:
    - The term \( p \cdot k \cdot k \) represents the contribution of the pairs of friends being chosen multiple times.
    - The term \( - p \cdot k \) adjusts for the overcounting of the initial friendship values.
    - The term \( 2 \cdot k \cdot C \cdot S \) accounts for the increase in friendship values due to the excursions.
  - The denominator \( 2 \cdot C \cdot C \) is the total number of possible pairs squared, which is used to normalize the expected value.
- **Simplification and Modular Inverse**: Correct. The program uses the GCD to simplify the fraction and computes the modular inverse correctly.

### Conclusion:
The program appears to be correct based on the problem description and the steps taken to solve it. The formula used for the expected value is consistent with the problem requirements, and the implementation details are accurate.

### Final Answer:
Correctness: **True**
### Reasoning:

1. **Input Handling**: 
   - The program reads the number of test cases `T`.
   - For each test case, it reads `n`, `p`, and `k` which represent the number of children, the number of pairs of friends, and the number of excursions, respectively.
   - It then reads the friendship values for each pair of friends.

2. **Sum of Friendship Values**:
   - The program initializes `S` to 0 and sums up the friendship values of all pairs of friends.

3. **Total Possible Pairs**:
   - The program calculates the total number of possible pairs of children using the combination formula \( C = \frac{n(n-1)}{2} \).

4. **Expected Value Calculation**:
   - The program calculates the numerator `num` and the denominator `den` for the expected value.
   - The numerator is calculated as \( p \cdot k \cdot k - p \cdot k + 2 \cdot k \cdot C \cdot S \).
   - The denominator is calculated as \( 2 \cdot C \cdot C \).

5. **Simplification**:
   - The program simplifies the fraction by dividing both the numerator and the denominator by their greatest common divisor (GCD).
   - It then computes the modular inverse of the denominator modulo \( 10^9 + 7 \).

6. **Final Answer**:
   - The program multiplies the simplified numerator by the modular inverse of the denominator and takes the result modulo \( 10^9 + 7 \) to get the final answer.

### Analysis:
- The program correctly handles the input and output formats.
- The calculation of the total number of possible pairs \( C \) is correct.
- The formula used for the expected value is derived from the problem statement and is correct.
- The use of the GCD to simplify the fraction and the modular inverse to compute the final answer is appropriate and follows the problem constraints.

### Conclusion:
The program appears to be correct based on the problem description and the steps taken to solve it.

### Final Answer:
Correctness: **True**
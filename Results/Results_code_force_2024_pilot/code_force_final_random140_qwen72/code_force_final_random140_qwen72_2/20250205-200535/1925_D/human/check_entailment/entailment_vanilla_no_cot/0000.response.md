Correctness: **False**

Explanation:

The provided solution attempts to solve the problem but has a few issues that make it incorrect:

1. **Incorrect Calculation of Expected Value**: The formula used to calculate the expected value of the sum of friendship values is not correct. The logic for updating the friendship value and calculating the expected value needs to consider the probability of selecting a friend pair and how the friendship value changes over the excursions.

2. **Handling of Friendship Values**: The program reads the friendship values correctly but does not handle the update of these values over the excursions in a way that reflects the problem statement. Specifically, the friendship value of a pair should increase by 1 for each excursion they are chosen, and this should affect the expected value calculation.

3. **Simplification of the Fraction**: The simplification of the fraction using the greatest common divisor (gcd) is not necessary in this context, and the way it is applied might not correctly reflect the expected value calculation.

4. **Modular Inverse Calculation**: The use of `pow(den, -1, MOD)` to find the modular inverse is correct, but the overall formula for `num` and `den` is flawed, leading to incorrect results.

A correct approach would involve calculating the expected value of the sum of friendship values by considering the probability of selecting each friend pair and how their friendship values evolve over the excursions. This typically involves a more detailed probabilistic analysis and dynamic programming or combinatorial methods to handle the updates correctly.
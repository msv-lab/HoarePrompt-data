The function `func` is designed to handle multiple test cases, each defined by an integer `n` (where 1 ≤ n ≤ 50). The function generates a string consisting of uppercase Latin letters with exactly `n` special characters, where a special character is one that is equal to exactly one of its neighbors. The generated string should not exceed 200 characters in length. If it is not possible to construct such a string, the function returns "NO".

Functionality: **The function accepts an integer `n` (1 ≤ n ≤ 50) and returns a string of uppercase Latin letters with exactly `n` special characters, where a special character is one that is equal to exactly one of its neighbors. The string should not exceed 200 characters in length. If no such string can be constructed, the function returns "NO".**
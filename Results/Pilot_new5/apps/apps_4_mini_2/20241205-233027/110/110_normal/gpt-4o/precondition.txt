n, m, r, and k are integers such that 1 ≤ n, m ≤ 100,000, 1 ≤ r ≤ min(n, m), and 1 ≤ k ≤ min(n·m, 100,000).
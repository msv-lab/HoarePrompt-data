Correctness: **False**

### Explanation:

The provided program attempts to solve the problem by constructing a valid configuration of targets based on the given number of hits for each column. However, there are several issues with the program that prevent it from meeting the problem description fully:

1. **Incorrect Handling of `a[i] == 1`**:
   - The program places a target in the first available row for each column where `a[i] == 1`. However, it does not ensure that the target placement respects the constraint that each row and column can have at most two targets. For example, if multiple columns require a single hit (`a[i] == 1`), the program might place more than two targets in a single row, which violates the problem constraints.

2. **Incorrect Handling of `a[i] == 2`**:
   - The program uses a `defaultdict` of `deque` objects (`mem`) to manage the placement of targets. However, the logic for placing targets when `a[i] == 2` is flawed. It assumes that there is always a valid target in `mem[1]` to use, but this is not guaranteed. If `mem[1]` is empty, the program prints `-1` and exits, which might be incorrect if a valid configuration exists.

3. **Incorrect Handling of `a[i] == 3`**:
   - The logic for placing targets when `a[i] == 3` is even more complex and error-prone. The program tries to place two targets in the same row to achieve three hits, but it does not always ensure that the targets are placed correctly. For example, if `mem[3]`, `mem[2]`, and `mem[1]` are all empty, the program prints `-1` and exits, which might be incorrect if a valid configuration exists.

4. **Row and Column Constraints**:
   - The program does not consistently check whether the current row or column already has two targets before placing a new one. This can lead to invalid configurations where a row or column has more than two targets.

5. **Output Format**:
   - The program outputs the results directly using `print`, which is not ideal for a function that should return a result. However, since the problem description specifies that the output should be printed, this part is correct.

### Example of Failure:

Consider the input:
```
6
2 0 3 0 1 1
```

The program might output:
```
5
2 1
2 5
3 3
3 6
5 6
```

However, this configuration is invalid because row 2 has three targets, which violates the problem constraints.

### Conclusion:

The program does not consistently ensure that the constraints of the problem are met, particularly regarding the maximum number of targets per row and column. Therefore, the program is incorrect according to the problem description.
Correctness: **False**

Explanation: The program does not handle the case where the coordinates of the points exceed the predefined size of the `labels` array. Specifically, the `labels` array is initialized with a fixed size of 1000x1000, but the problem description states that the coordinates can be up to 100,000. This can lead to an index out of bounds error when trying to access `labels[x][y]`.

For example, consider the following input:

```
2
100000 0
0 0
0 100000
```

This input will cause the program to fail because it tries to access `labels[100000][0]`, which is out of bounds for the `labels` array. Therefore, the program is incorrect.
n and r are non-negative integers such that 0 <= r <= n, and fact and ifact are lists of integers where fact[i] represents the factorial of i and ifact[i] represents the modular multiplicative inverse of the factorial of i, under a modulus mod.
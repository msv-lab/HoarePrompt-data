Precondition: **n, p, w, and d are integers such that 1 ≤ n ≤ 10^12, 0 ≤ p ≤ 10^17, 1 ≤ d < w ≤ 10^5.**
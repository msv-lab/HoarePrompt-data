args and kwargs are parameters that will be passed to the function f, and stack is a list that is expected to be defined in the outer scope of this function.
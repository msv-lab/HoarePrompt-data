Output State: **`n` and `m` are integers such that 2 ≤ `n` ≤ 5000 and 1 ≤ `m` ≤ 20000, `station` is a list of `n` lists where each `station[i]` contains the indices of stations connected to station `i + 1` based on the input pairs `(a, b)`, `i` is `n - 1`, `max_candy` is a list of `n` elements where each element `max_candy[j]` (for 0 ≤ j < n) is the minimum value in `station[j]` based on the custom key function `lambda x: x + n - j if x < j else x - j` if `station[j]` is not empty; otherwise, `max_candy[j]` remains 0.**
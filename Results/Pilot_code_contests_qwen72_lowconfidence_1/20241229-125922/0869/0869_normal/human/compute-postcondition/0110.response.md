Postcondition: ***`n` is a positive integer (1 ≤ n ≤ 105), `i` is the next key in `nbr[v]`, `nbr` is a dictionary where each key is a string representing a stamp and each value is a list of strings representing the stamps that are connected to the key stamp, `cand` is a set containing the stamps that are not connected to any other stamp in the final state, `marked` contains all stamps that are reachable from `v` through the connections defined in `nbr`. If `i` is not in `marked`, `i` is added to `marked`, `res`, and `Q`, making `marked` contain all stamps reachable from `v` including `i`, `res` contain the sequence of stamps visited starting from `v` and now includes `i`, and `Q` contain at least one stamp after `v` has been popped and now includes `i`. If `i` is already in `marked`, the state of `marked`, `res`, and `Q` remains unchanged.***
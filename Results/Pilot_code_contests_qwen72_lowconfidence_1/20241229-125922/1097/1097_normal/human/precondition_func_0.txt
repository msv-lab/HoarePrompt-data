A is a list of lists of integers where each sublist has the same length and represents a row in a matrix; b is a list of integers of the same length as A; p is a prime number such that 2 ≤ p ≤ 2999.
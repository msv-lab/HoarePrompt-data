Reasoning:

1. **Initial Input Parsing**: The code correctly parses the input `n` and the array `a`.
2. **Prefix Sum Calculation**: The prefix sum array `prefix_sum` is calculated correctly, ensuring that `prefix_sum[i]` holds the sum of the first `i` elements of `a`.
3. **Checking for Zero Sum**: The code correctly checks if the sum of the entire array is zero. If it is, it immediately prints "NO", which aligns with the problem statement.
4. **Finding Subarrays with Non-Zero Sum**: The logic to find subarrays with non-zero sums is implemented correctly using the prefix sum array. For each `r` from 1 to `n`, it checks if the subarray from `l` to `r` has a non-zero sum. When such a subarray is found, it prints the indices and increments the count `k`. After the loop, it ensures the last subarray is printed correctly.
5. **Edge Cases**: The solution handles the edge case where the entire array sums to zero by printing "NO". It also correctly identifies and splits subarrays with non-zero sums.

Given that the annotated program correctly implements the required logic and handles all specified cases, the program is correct.

Correctness: **True**
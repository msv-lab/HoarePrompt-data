Correctness: **True**

Explanation: The provided program seems to correctly implement the logic for solving the puzzle described. The `func_1` function calculates the number of ways to form a valid chain using dynamic programming. The `func_2` function reads the input and processes multiple test cases, calling `func_1` for each set of inputs.

Given the constraints and the nature of the problem, the provided implementation appears to handle all potential cases correctly. Hereâ€™s a brief reasoning:

- The dynamic programming approach ensures that all possible configurations are considered.
- The modulo operation ensures that the result fits within the required limits.
- The input reading and processing in `func_2` correctly calls `func_1` for each test case.

Since the provided examples and logical flow appear to cover all necessary cases, the program should be considered correct.
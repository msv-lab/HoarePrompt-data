s is a binary string (consisting of '0' and '1') of length n, where 1 ≤ n ≤ 2⋅10^5, and func_1 is a function that returns the longest prefix of s which matches a suffix of s (known as the KMP failure function).
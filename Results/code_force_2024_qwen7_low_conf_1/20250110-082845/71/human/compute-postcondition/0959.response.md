Postcondition: ***`l` is a non-empty string, `t` is 1, `m` is an input integer, `nn` is either `nn - 1` or 0, `ss` is either 0 if `n <= s` or `s - n` if `n > s`, `ww` is either a positive integer (`w - e`), `ee` is either 0 or `e - w`, `n` is the count of 'N' in `l`, `s` is the count of 'S' in `l`, `w` is the count of 'W' in `l`, `e` is the count of any other character in `l`.

- If `i` is 'W':
  - `r` is 1 if `ww` was a positive integer and `r` was 1, otherwise `r` is 0 or 1.
  - `h` is 1 if `h` was 0, otherwise `h` is 0 or 1.
  - `rr` is `[0, 0, 0, 0]` if `ww` was a positive integer, otherwise `rr` is `[0, 0, 0, 0]` or `[0, 0, 1, False]`.
  - `hh` is `[0, 0, 0, 0]` if `ww` was a positive integer, otherwise `hh` is `[0, 0, 0, 0]` or `[0, 0, 1, 0]`.
  - `pp` is ['R'] if `ww` was a positive integer and `r` was 1, otherwise `pp` is ['H'] if `ww` was a positive integer and `r` was 0, or ['R'] or ['H'] depending on whether `r < h` is true or false.
  
- If `i` is 'E':
  - `r` is 1 if `ee` was originally 0 or an odd number and became even, otherwise `r` is 0.
  - `h` is 0 if `ee` was originally 0 or an odd number and became even, otherwise `h` is 1.
  - `rr` is `[0, 0, 0, 1]` if `rr[2]` is 0, `[0, 0, 0, 0]` if `rr[2]` is not 0 and `hh[2]` is False, and `[0, 0, 1, 0]` if `rr[2]` is not 0 and `hh[2]` is True.
  - `hh` is `[0, 0, 0, 0]` if `rr[2]` is 0, `[0, h_value - 1, hh[2] - 1, hh[3]]` if `rr[2]` is not 0 and `hh[2]` is True, and `[0, 0, 0, 1]` if `rr[2]` is not 0 and `hh[2]` is False.
  - `pp` is `['R']` if `ee` was originally 0 or an odd number and became even, `['H']` if `hh[2]` is True, and remains `['H']` otherwise.
  
- Otherwise (if `i` is neither 'W' nor 'E'):
  - `nn` is either `nn - 1` or 0.
  - `ss` is either 0 if `n <= s` or `s - n` if `n > s`.
  - `ww` is either a positive integer (`w - e`), `ee` is either 0 or `e - w`.
  - If `nn` is non-zero, `r` is either 0 or 1, `h` is either 0 or 1, `rr` is `[0, 0, 0, 0]`, `hh` is `[0, 0, 0, 0]` with `(hh[0])` being False, and `pp` is either an empty list or a list containing 'R' or 'H'.
  - If `nn` is 0, `r` is at least 1, `h` is 1, `rr` is `[0, 0, 0, 0]`, `hh` is `[1, 0, 0, 0]` with `(hh[0])` being True, and `pp` is `['H']`.
  - If `i` is 'S', then `r` is 1, `h` is 0, `rr` is `[0, 1, 0, 0]`, `hh` is `[0, 0, 0, 0]` with `(hh[0])` being False, and `pp` is `['R']`.
  - Otherwise, `r` is 0, `h` is 1, `rr` is `[0, 0, 0, 0]`, `hh` is `[0, 1, 0, 0]` with `(hh[0])` being False, and `pp` is `['H']`.***
pergunta is a list of integers representing the number of test cases, a is a 2D list of integers where each sublist contains n integers representing the a_i values for each test case, b is a 2D list of integers where each sublist contains n integers representing the b_i values for each test case, n is a list of integers where each integer represents the number of people in the queue for each test case, and m is a list of integers where each integer represents the maximum allowable final position of Kirill for each test case. It is guaranteed that the length of pergunta, a, b, n, and m are the same, and for each test case, 1 <= m <= n <= 200,000, 1 <= a_i, b_i <= 10^9, and the sum of all n values does not exceed 2 * 10^5.
t is an integer such that 1 <= t <= 10^4. Each test case in test_cases is a tuple containing three elements: (n, q, data), where n and q are integers such that 1 <= n, q <= 3 * 10^5, data is a tuple of n integers where each integer c_i satisfies 1 <= c_i <= 10^9, and there are q queries following the array, each query being a tuple (l_i, r_i) where 1 <= l_i <= r_i <= n. The sum of n over all test cases does not exceed 3 * 10^5, and the sum of q over all test cases does not exceed 3 * 10^5.
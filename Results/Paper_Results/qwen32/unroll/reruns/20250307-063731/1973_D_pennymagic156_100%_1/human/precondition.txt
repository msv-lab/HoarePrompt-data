n and k are positive integers such that 1 ≤ k ≤ n ≤ 10^4, and there exists a hidden array a of length n where each element a_i satisfies 1 ≤ a_i ≤ n. The function is allowed to make at most 2n queries of the form "? l x" to determine the smallest r such that f(l, r) = x, or n+1 if no such r exists, and must output the largest m such that the array can be split into exactly k subarrays with f(1, c_1) = f(c_1 + 1, c_2) = ... = f(c_{k-1}+1, n) = m, or -1 if no such m exists.
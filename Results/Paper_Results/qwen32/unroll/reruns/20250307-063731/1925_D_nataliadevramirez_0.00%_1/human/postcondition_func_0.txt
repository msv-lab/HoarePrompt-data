The function calculates and returns the accumulated sum of the product of each friendship's value and the triangular number of excursions, taken modulo `MOD`.
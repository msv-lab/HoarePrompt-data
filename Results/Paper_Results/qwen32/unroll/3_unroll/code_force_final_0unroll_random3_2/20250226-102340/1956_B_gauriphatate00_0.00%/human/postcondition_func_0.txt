The function takes a positive integer `n` and a list `a` of length `n` containing integers from 1 to `n` (each appearing at most twice) and returns the minimum of the number of integers that appear exactly twice in `a` and half of `n`.
Functionality: **The function accepts an integer `t` representing the number of test cases. For each test case, it receives four integers `n`, `k`, `P_B`, and `P_S`, and two lists `p` and `a`. The function returns a result for each test case based on the provided values. Specifically, if `t` is a positive integer between 1 and 10,000, for each test case, `n` is an integer between 1 and 200,000, `k` is an integer between 1 and 1,000,000,000, and `P_B` and `P_S` are integers such that 1 <= P_B, P_S <= n. The list `p` contains `n` integers where each element is between 1 and `n`, and the list `a` contains `n` integers where each element is between 1 and 1,000,000,000. The sum of all `n` values across all test cases does not exceed 200,000. The function processes these inputs and returns a result for each test case.**
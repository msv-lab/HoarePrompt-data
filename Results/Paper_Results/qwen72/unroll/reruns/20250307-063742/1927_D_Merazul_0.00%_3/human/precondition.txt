t is an integer (1 ≤ t ≤ 10^4) representing the number of test cases, n is an integer (2 ≤ n ≤ 2·10^5) representing the length of the array a, a is a list of integers (1 ≤ a_i ≤ 10^6) of length n, q is an integer (1 ≤ q ≤ 2·10^5) representing the number of queries, and queries is a list of q pairs of integers (l, r) where 1 ≤ l < r ≤ n. The sums of n and q across all test cases do not exceed 2·10^5.
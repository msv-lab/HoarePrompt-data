The function `solve` is part of a program that processes multiple test cases. Each test case includes three integers n, m_1, and m_2, where 1 ≤ m_1, m_2 ≤ n ≤ 2 · 10^5, representing the length of the permutation, the number of prefix maximums, and the number of suffix maximums, respectively. The test case also includes two lists of integers, p and s, of lengths m_1 and m_2, respectively, where 1 ≤ p_i ≤ n and 1 ≤ s_i ≤ n, and both lists are strictly increasing. The sum of n across all test cases does not exceed 2 · 10^5.
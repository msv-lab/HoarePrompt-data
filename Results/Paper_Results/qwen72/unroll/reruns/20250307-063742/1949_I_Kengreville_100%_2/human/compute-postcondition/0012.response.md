Output State: `n` is an input integer, 1 <= n <= 1000; `x` is a list of integers of length n; `y` is a list of integers of length n; `r` is a list of integers of length n; `visited` is a list where each element is True if the corresponding index has been visited by the `dfs` function; `coef` is a list where each element is 1 if the corresponding index has been visited by the `dfs` function, otherwise it remains None; `tot` is the total number of nodes visited in the last connected component; `bipartite` is True if the last connected component is bipartite and non-empty, otherwise it is False; `ok` is True if there exists at least one bipartite and non-empty connected component, otherwise it is False.
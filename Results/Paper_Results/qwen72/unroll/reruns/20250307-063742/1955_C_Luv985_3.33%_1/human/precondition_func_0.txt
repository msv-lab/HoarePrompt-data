The function should take three parameters: t, a list of tuples where each tuple contains n and k, and a list of lists where each sublist contains the durability values a_1, a_2, ..., a_n of the ships. t is an integer such that 1 <= t <= 10^4. Each n is an integer such that 1 <= n <= 2 \cdot 10^5, and each k is an integer such that 1 <= k <= 10^{15}. Each durability value a_i is an integer such that 1 <= a_i <= 10^9. The sum of n for all test cases does not exceed 2 \cdot 10^5.
### Reasoning:

1. **Tree Representation and Initialization**:
   - The `Tree` class is used to represent the tree structure. Each vertex is a `TreeNode` object with attributes for edges, children, subtree size, parent, good components, and remaining size.
   - The `add_edge` method correctly adds edges to the tree, ensuring that the tree is built correctly.

2. **Rooting the Tree**:
   - The `root_tree` method is a recursive function that roots the tree at a given vertex and calculates the subtree sizes.
   - The `root_tree_non_recursive` method is a non-recursive version of the same function, which is used to avoid recursion limits. Both methods correctly root the tree and calculate the subtree sizes.

3. **Component Calculation**:
   - The `func_1` function is a non-recursive post-order traversal that calculates the number of good components and the remaining size of the tree rooted at a given vertex `s` with a minimum component size `x`.
   - The `func_2` function is a recursive post-order traversal that does the same as `func_1` but is not used in the final solution.

4. **Binary Search for Maximum Component Size**:
   - The `func_3` function checks if it is possible to remove exactly `k` edges such that each remaining component has a size of at least `x`. It uses the results from `func_1` to determine this.
   - The `func_4` function performs a binary search to find the maximum `x` for which `func_3` returns `True`. This is a standard approach for finding the maximum value that satisfies a condition.

5. **Input Handling and Execution**:
   - The `func_5` function reads the input, constructs the tree, roots it, and then calls `func_4` to find and print the maximum component size.
   - The main block of the program sets the recursion limit and processes multiple test cases by repeatedly calling `func_5`.

### Correctness Analysis:

- **Tree Construction**: The tree is correctly constructed using the `add_edge` method, and the tree is rooted using the `root_tree_non_recursive` method, which avoids recursion limits.
- **Component Calculation**: The `func_1` function correctly calculates the number of good components and the remaining size of the tree. The `func_3` function correctly checks if the conditions for removing `k` edges are met.
- **Binary Search**: The `func_4` function correctly performs a binary search to find the maximum `x` that satisfies the conditions.
- **Input Handling**: The `func_5` function correctly reads the input and processes each test case.

### Conclusion:

The program appears to correctly solve the problem as described. It constructs the tree, roots it, calculates the necessary components, and uses binary search to find the maximum `x` such that the conditions are met. The input handling and execution are also correct.

### Correctness:
**True**
d is a dictionary where each key is an integer and each value is a list of integers, processing is a list of integers of length at least max(d.keys()), da is an integer key present in d, rank is a list of integers of length at least max(d.keys()).
The function should take three parameters: t, an integer representing the number of test cases (1 ≤ t ≤ 10^4); a list of tuples, where each tuple contains two integers n and k (1 ≤ n ≤ 2 · 10^5, 1 ≤ k ≤ 10^15) representing the number of ships and the number of attacks by the Kraken, respectively; and a list of lists, where each inner list contains n integers a_1, a_2, ..., a_n (1 ≤ a_i ≤ 10^9) representing the durability of the ships. The sum of n for all test cases does not exceed 2 · 10^5.
The function should take two parameters: a list of integers `a` representing the exponents of the stick lengths (2^{a_i}), and an integer `n` representing the number of sticks, where 1 \le n \le 3 \cdot 10^5 and 0 \le a_i \le n. The function should also handle multiple test cases, where the number of test cases `t` is an integer such that 1 \le t \le 10^4. The sum of `n` over all test cases does not exceed 3 \cdot 10^5.
The function `func` is designed to handle multiple test cases, each defined by an integer `n` where 1 ≤ n ≤ 50. The function should generate a string of uppercase Latin letters that contains exactly `n` special characters. A special character is defined as a character that is equal to exactly one of its neighbors. The length of the generated string should not exceed 200 characters. If it is not possible to generate such a string, the function should return "NO".

Functionality: **The function accepts an integer `n` (1 ≤ n ≤ 50) and returns a string of uppercase Latin letters that contains exactly `n` special characters, where a special character is equal to exactly one of its neighbors. The length of the string is at most 200. If no such string can be generated, it returns "NO".**
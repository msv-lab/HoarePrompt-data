Output State: **The recursion limit is set to 1,000,000. The function should still accept a list of test cases, where each test case is a tuple containing an integer n (3 ≤ n ≤ m ≤ min(n·(n - 1)/2, 2·10^5)) and a list of m tuples, each representing an edge with integers u, v (1 ≤ u, v ≤ n, u ≠ v) and w (1 ≤ w ≤ 10^6). The number of test cases t is an integer (1 ≤ t ≤ 10^4). The graph is undirected, does not contain loops, and has at most one edge between each pair of vertices. The sum of m across all test cases does not exceed 2·10^5.**
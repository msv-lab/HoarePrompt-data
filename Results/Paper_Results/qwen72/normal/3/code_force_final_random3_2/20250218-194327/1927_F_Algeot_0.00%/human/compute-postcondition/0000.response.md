Output State: **The recursion limit is set to 1,000,000. The function should take inputs t, n, m, and a list of edges, where t is an integer representing the number of test cases (1 ≤ t ≤ 10^4), n and m are integers representing the number of vertices and edges of the graph (3 ≤ n ≤ m ≤ min(n·(n - 1)/2, 2·10^5)), and the list of edges contains m tuples, each with three integers u, v, and w (1 ≤ u, v ≤ n, u ≠ v, 1 ≤ w ≤ 10^6) representing an edge between vertices u and v with weight w. The graph does not contain loops or multiple edges between the same pair of vertices, and it is guaranteed that there is at least one simple cycle in the graph. The sum of m across all test cases does not exceed 2·10^5.**
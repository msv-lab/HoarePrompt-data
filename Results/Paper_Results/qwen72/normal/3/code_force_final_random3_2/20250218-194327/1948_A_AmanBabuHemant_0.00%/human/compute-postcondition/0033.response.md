The function `func` is expected to handle multiple test cases, where each test case is defined by an integer `n` (1 ≤ n ≤ 50). The function should generate a string of uppercase Latin letters with exactly `n` special characters, where a special character is one that is equal to exactly one of its neighbors. The length of the generated string should be at most 200. If no such string can be generated, the function should return "NO".

Functionality: **The function accepts an integer `n` and returns a string of uppercase Latin letters with exactly `n` special characters, where a special character is equal to exactly one of its neighbors, and the string length is at most 200. If no such string can be generated, it returns "NO".**
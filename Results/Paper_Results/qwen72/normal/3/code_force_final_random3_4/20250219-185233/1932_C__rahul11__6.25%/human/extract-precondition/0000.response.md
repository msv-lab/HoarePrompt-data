Precondition: **The function `func` is expected to be called within a program that processes multiple test cases. Each test case consists of an integer n (1 ≤ n ≤ 2·10^5) representing the length of the array a, an integer m (1 ≤ m ≤ 10^4) for the modulus operation, a list of n integers a (1 ≤ a_i ≤ 10^4) representing the elements of the array, and a string s of length n consisting of characters 'L' and 'R'. The total sum of n across all test cases does not exceed 2·10^5.**
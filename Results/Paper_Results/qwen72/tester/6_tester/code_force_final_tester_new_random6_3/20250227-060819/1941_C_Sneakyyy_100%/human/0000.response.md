Certainly! Below are comprehensive test cases for the given problem, categorized into Basic and Edge scenarios.

### Basic Test Cases

# Test 1
**Input**: 
```
6
9
mmapnapie
9
azabazapi
8
mappppie
18
mapmapmapmapmapmap
1
p
11
pppiepieeee
```
**Output**: 
```
2
0
2
6
0
2
```
**Scenario**: This test case covers a variety of string lengths and compositions, including strings that are already beautiful and those that need characters removed to become beautiful.

# Test 2
**Input**: 
```
3
5
piepie
7
maplepie
4
mapm
```
**Output**: 
```
3
4
2
```
**Scenario**: This test case includes strings with multiple occurrences of the substrings "pie" and "map".

# Test 3
**Input**: 
```
4
10
mapppiepie
12
mapmapmapmap
15
mappiepiepiepie
20
mapmapmapmapmapmapmapmap
```
**Output**: 
```
4
6
7
12
```
**Scenario**: This test case includes longer strings with multiple occurrences of the substrings "pie" and "map".

# Test 4
**Input**: 
```
5
3
pie
3
map
5
pieie
5
mapam
6
pipiem
```
**Output**: 
```
3
3
3
3
4
```
**Scenario**: This test case includes strings that are exactly the substrings "pie" and "map", as well as strings that contain these substrings.

# Test 5
**Input**: 
```
4
6
pippie
7
mapppie
8
mapppiee
9
mapppieee
```
**Output**: 
```
3
3
4
5
```
**Scenario**: This test case includes strings with "pie" and "map" at different positions and with varying lengths.

### Edge Test Cases

# Test 6
**Input**: 
```
1
1000000
piepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepiepie
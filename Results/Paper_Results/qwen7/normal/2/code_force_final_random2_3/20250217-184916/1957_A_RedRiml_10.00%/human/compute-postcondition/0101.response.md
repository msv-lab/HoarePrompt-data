Postcondition: `pl` must still contain at least one element, `d[j]` must be greater than or equal to 3, and `shapes` is increased by 1.
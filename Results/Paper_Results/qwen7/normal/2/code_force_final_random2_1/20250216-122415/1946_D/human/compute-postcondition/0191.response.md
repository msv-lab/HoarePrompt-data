Postcondition: `a` must contain at least two elements, `val` is the third element of `a`, `op` is the result of `op` XOR (`val` right-shifted by `i` bits and then ANDed with 1), and `cnt` is incremented by 1.
d is a dictionary where keys are integers and values are lists of integers. da is an integer representing a key in the dictionary d. processing is a list of integers of length equal to the maximum possible value in the lists of d, initialized to 0s. rank is a list of integers of length equal to the maximum possible value in the keys of d, initialized to 0s.
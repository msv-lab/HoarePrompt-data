Postcondition: `x` is 1, `g` must have at least one entry for `x`, and either `(node, x)` is appended to `stack` if `node` is not equal to `p`, or `stack` remains unchanged if `node` is equal to `p`.
Postcondition: `x` is 1, `g` maintains its original structure, if `node` is different from `p`, `stack` contains a tuple `(node, 1)`.
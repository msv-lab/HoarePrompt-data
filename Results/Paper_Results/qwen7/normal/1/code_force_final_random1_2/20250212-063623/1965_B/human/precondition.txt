d is an integer, processing is a list of integers, da is a dictionary mapping integers to integers, and rank is a list of integers.
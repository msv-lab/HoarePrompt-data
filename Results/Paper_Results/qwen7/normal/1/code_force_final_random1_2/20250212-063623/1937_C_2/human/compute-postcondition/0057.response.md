Output State: **`res` is a string from the input, `i` is `i_end + 1`, `n` is the same as before**
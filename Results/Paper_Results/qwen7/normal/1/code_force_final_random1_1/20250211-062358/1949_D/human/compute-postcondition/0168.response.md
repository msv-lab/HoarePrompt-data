Postcondition: `n` must be between 2 and 24, `xx[i][j - 1] == '?'`, and neither `i` is in `sa[:n // 4]` nor `j` is in `sa[:n // 4]`.
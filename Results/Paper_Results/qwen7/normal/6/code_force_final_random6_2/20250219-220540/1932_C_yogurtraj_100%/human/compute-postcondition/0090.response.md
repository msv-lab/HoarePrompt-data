Postcondition: `i` is either `n - 4` or `n - 5`, `k` is updated as follows: if `t[i] == 'R'`, then `k` is `k * a[q2] % m` and `q2` is incremented by 1; otherwise, `k` is `k * a[q1] % m` and `q1` is decremented by 1.
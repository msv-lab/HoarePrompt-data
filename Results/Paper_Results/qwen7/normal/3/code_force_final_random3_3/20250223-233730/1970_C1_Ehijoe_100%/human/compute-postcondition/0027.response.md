Postcondition: `nodes` must have at least one key, `key` is the next key in `nodes`. If the length of the list associated with `key` is exactly 1, then `ends` now includes the current `key`. Otherwise, `ends` remains unchanged.
d is a dictionary where keys are integers and values are lists of integers; processing is a list of length equal to the maximum key in d, initialized with zeros; da is an integer which is a key in d; rank is a list of integers initialized with zeros.
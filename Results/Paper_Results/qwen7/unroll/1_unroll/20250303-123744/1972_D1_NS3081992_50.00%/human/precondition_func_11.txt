d is a dictionary where keys are integers and values are lists of integers; processing is a list of length max(da) containing only 0s and 1s; da and rank are integers such that 1 <= da <= max(da) and rank is a list of length max(da) initialized with zeros.
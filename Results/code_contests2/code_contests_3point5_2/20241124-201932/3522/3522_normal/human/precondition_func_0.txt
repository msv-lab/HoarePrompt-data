**Precondition**: **q is a positive integer. Each ni is a positive integer.**
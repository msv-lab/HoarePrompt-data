**Precondition**: **q is a positive integer. Each ni is a positive integer such that 1 ≤ ni ≤ 10^9.**
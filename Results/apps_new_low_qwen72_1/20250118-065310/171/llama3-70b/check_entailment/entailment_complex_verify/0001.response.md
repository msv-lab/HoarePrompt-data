Reasoning:

1. **Input Handling**: The program correctly reads the inputs as specified in the problem statement. It first reads `n`, then the number of cards and the cards themselves for the first player, and similarly for the second player. This part is accurate and aligns with the problem description.

2. **Game Simulation**: The program simulates the game using a while loop that continues as long as both players have cards. This is appropriate because the game ends when one player runs out of cards. The loop structure is correct and matches the problem requirements.

3. **State Tracking**: The program uses a set `seen` to keep track of the states (tuples of the current decks) to detect cycles. If a state repeats, it means the game will continue indefinitely, and the program returns `-1`. This approach is effective for detecting cycles and preventing infinite loops.

4. **Card Comparison and Stack Management**: During each turn, the program compares the top cards of both players. The winner of the turn appends the opponent's card followed by their own card to the bottom of their deck. This follows the rules of the game correctly. The order of appending cards (opponent's card first, then the winner's card) is also correct according to the problem description.

5. **Result Calculation**: After the loop, the program checks which player has cards left and returns the number of fights (which is the size of the `seen` set) along with the winning player's number. The calculation of the number of fights as `len(seen)` is correct because it counts the number of unique states encountered during the game.

6. **Edge Cases**: The program handles edge cases such as one player having no cards initially, which would result in an immediate win for the other player. The program correctly identifies the winner in such scenarios.

7. **Cycle Detection**: The program correctly identifies cycles by checking if the current state has been seen before. This ensures that the game does not run indefinitely, which is a critical aspect of the problem.

Given these points, the program appears to correctly implement the game logic and handle all specified cases.

Final: **True**
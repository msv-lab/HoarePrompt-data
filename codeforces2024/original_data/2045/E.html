<div class="problem-statement"><div class="header"><div class="title">E. Narrower Passageway</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>1024 megabytes</div><div class="input-file input-standard"><div class="property-title">input</div>standard input</div><div class="output-file output-standard"><div class="property-title">output</div>standard output</div></div><div><p>You are a strategist of The ICPC Kingdom. You received an intel that there will be monster attacks on a narrow passageway near the kingdom. The narrow passageway can be represented as a grid with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 0.717em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.6em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mn" id="MathJax-Span-3" style="font-family: STIXGeneral-Regular;">2</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-1">2</script> rows (numbered from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.3em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="mn" id="MathJax-Span-6" style="font-family: STIXGeneral-Regular;">1</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-2">1</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7" style="width: 0.717em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.6em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-8"><span class="mn" id="MathJax-Span-9" style="font-family: STIXGeneral-Regular;">2</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-3">2</script>) and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-10" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.78em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-11"><span class="mi" id="MathJax-Span-12" style="font-family: STIXGeneral-Italic;">𝑁<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">N</script> columns (numbered from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-13" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.3em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-14"><span class="mn" id="MathJax-Span-15" style="font-family: STIXGeneral-Regular;">1</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-5">1</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-16" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.78em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-17"><span class="mi" id="MathJax-Span-18" style="font-family: STIXGeneral-Italic;">𝑁<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">N</script>). Denote <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>r</mi><mo>,</mo><mi>c</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-19" style="width: 2.384em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.967em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1001.91em, 2.801em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-20"><span class="mo" id="MathJax-Span-21" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-22" style="font-family: STIXGeneral-Italic;">𝑟</span><span class="mo" id="MathJax-Span-23" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-24" style="font-family: STIXGeneral-Italic; padding-left: 0.182em;">𝑐</span><span class="mo" id="MathJax-Span-25" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>r</mi><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7">(r, c)</script> as the cell in row <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-26" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.848em, 1000.42em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-27"><span class="mi" id="MathJax-Span-28" style="font-family: STIXGeneral-Italic;">𝑟</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.646em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">r</script> and column <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-29" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.848em, 1000.42em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-30"><span class="mi" id="MathJax-Span-31" style="font-family: STIXGeneral-Italic;">𝑐</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">c</script>. A soldier with a power of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>r</mi><mo>,</mo><mi>c</mi></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-32" style="width: 1.729em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.372em, 1001.43em, 2.622em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-33"><span class="msubsup" id="MathJax-Span-34"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-35" style="font-family: STIXGeneral-Italic;">𝑃<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-36"><span class="mrow" id="MathJax-Span-37"><span class="mi" id="MathJax-Span-38" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑟</span><span class="mo" id="MathJax-Span-39" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-40" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑐</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi><mo>,</mo><mi>c</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-10">P_{r, c}</script> is assigned to protect <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>r</mi><mo>,</mo><mi>c</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-41" style="width: 2.384em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.967em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1001.91em, 2.801em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-42"><span class="mo" id="MathJax-Span-43" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-44" style="font-family: STIXGeneral-Italic;">𝑟</span><span class="mo" id="MathJax-Span-45" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-46" style="font-family: STIXGeneral-Italic; padding-left: 0.182em;">𝑐</span><span class="mo" id="MathJax-Span-47" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>r</mi><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-11">(r, c)</script> every single day.</p><p>It is known that the passageway is very foggy. Within a day, each column in the passageway has a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>50</mn><mi mathvariant=&quot;normal&quot;>&amp;#x0025;</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-48" style="width: 2.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.09em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-49"><span class="mn" id="MathJax-Span-50" style="font-family: STIXGeneral-Regular;">50</span><span class="mi" id="MathJax-Span-51" style="font-family: STIXGeneral-Regular;">%</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>50</mn><mi mathvariant="normal">%</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">50\%</script> chance of being covered in fog. If a column is covered in fog, the two soldiers assigned to that column are not deployed that day. Otherwise, the assigned soldiers will be deployed.</p><p>Define a <span class="tex-font-style-underline">connected area</span> <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-52" style="width: 2.682em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1002.15em, 2.801em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-53"><span class="mo" id="MathJax-Span-54" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-55" style="font-family: STIXGeneral-Italic;">𝑢</span><span class="mo" id="MathJax-Span-56" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-57" style="font-family: STIXGeneral-Italic; padding-left: 0.182em;">𝑣</span><span class="mo" id="MathJax-Span-58" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-13">[u, v]</script> (<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>u</mi><mo>&amp;#x2264;</mo><mi>v</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-59" style="width: 2.979em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.443em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em, 1002.44em, 2.741em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-60"><span class="mi" id="MathJax-Span-61" style="font-family: STIXGeneral-Italic;">𝑢</span><span class="mo" id="MathJax-Span-62" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">≤</span><span class="mi" id="MathJax-Span-63" style="font-family: STIXGeneral-Italic; padding-left: 0.301em;">𝑣</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi><mo>≤</mo><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">u \leq v</script>) as a maximal set of consecutive columns from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>u</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-64" style="width: 0.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.848em, 1000.48em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-65"><span class="mi" id="MathJax-Span-66" style="font-family: STIXGeneral-Italic;">𝑢</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">u</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>v</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-67" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.48em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-68"><span class="mi" id="MathJax-Span-69" style="font-family: STIXGeneral-Italic;">𝑣</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">v</script> (inclusive) such that each column in the set is not covered in fog. The following illustration is an example of connected areas. The grayed cells are cells covered in fog. There are <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>4</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-70" style="width: 0.717em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.6em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-71"><span class="mn" id="MathJax-Span-72" style="font-family: STIXGeneral-Regular;">4</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>4</mn></math></span></span><script type="math/tex" id="MathJax-Element-17">4</script> connected areas: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-73" style="width: 2.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1002.09em, 2.801em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-74"><span class="mo" id="MathJax-Span-75" style="font-family: STIXGeneral-Regular;">[</span><span class="mn" id="MathJax-Span-76" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-77" style="font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-78" style="font-family: STIXGeneral-Regular; padding-left: 0.182em;">2</span><span class="mo" id="MathJax-Span-79" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-18">[1, 2]</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>4</mn><mo>,</mo><mn>6</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-80" style="width: 2.801em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.324em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1002.26em, 2.801em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-81"><span class="mo" id="MathJax-Span-82" style="font-family: STIXGeneral-Regular;">[</span><span class="mn" id="MathJax-Span-83" style="font-family: STIXGeneral-Regular;">4</span><span class="mo" id="MathJax-Span-84" style="font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-85" style="font-family: STIXGeneral-Regular; padding-left: 0.182em;">6</span><span class="mo" id="MathJax-Span-86" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>4</mn><mo>,</mo><mn>6</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-19">[4, 6]</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>9</mn><mo>,</mo><mn>9</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-87" style="width: 2.801em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.324em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1002.26em, 2.801em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-88"><span class="mo" id="MathJax-Span-89" style="font-family: STIXGeneral-Regular;">[</span><span class="mn" id="MathJax-Span-90" style="font-family: STIXGeneral-Regular;">9</span><span class="mo" id="MathJax-Span-91" style="font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-92" style="font-family: STIXGeneral-Regular; padding-left: 0.182em;">9</span><span class="mo" id="MathJax-Span-93" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>9</mn><mo>,</mo><mn>9</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-20">[9, 9]</script>, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>11</mn><mo>,</mo><mn>11</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-94" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.741em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1002.68em, 2.801em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-95"><span class="mo" id="MathJax-Span-96" style="font-family: STIXGeneral-Regular;">[</span><span class="mn" id="MathJax-Span-97" style="font-family: STIXGeneral-Regular;">11</span><span class="mo" id="MathJax-Span-98" style="font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-99" style="font-family: STIXGeneral-Regular; padding-left: 0.182em;">11</span><span class="mo" id="MathJax-Span-100" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>11</mn><mo>,</mo><mn>11</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-21">[11, 11]</script>.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/7e25aaaa11db31444c6afdb9062c25b7d2f9cb1a.png" style="max-width: 100.0%;max-height: 100.0%;" width="378px"> </center><p>The <span class="tex-font-style-underline">strength</span> of a connected area <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-101" style="width: 2.682em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1002.15em, 2.801em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-102"><span class="mo" id="MathJax-Span-103" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-104" style="font-family: STIXGeneral-Italic;">𝑢</span><span class="mo" id="MathJax-Span-105" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-106" style="font-family: STIXGeneral-Italic; padding-left: 0.182em;">𝑣</span><span class="mo" id="MathJax-Span-107" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-22">[u, v]</script> can be calculated as follows. Let <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>m</mi><mn>1</mn></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-108" style="width: 1.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1001.13em, 2.562em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-109"><span class="msubsup" id="MathJax-Span-110"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-111" style="font-family: STIXGeneral-Italic;">𝑚</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.717em;"><span class="mn" id="MathJax-Span-112" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-23">m_1</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>m</mi><mn>2</mn></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-113" style="width: 1.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1001.13em, 2.562em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-114"><span class="msubsup" id="MathJax-Span-115"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-116" style="font-family: STIXGeneral-Italic;">𝑚</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.717em;"><span class="mn" id="MathJax-Span-117" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-24">m_2</script> be the maximum power of the soldiers in the first and second rows of the connected area, respectively. Formally, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>m</mi><mi>r</mi></msub><mo>=</mo><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>r</mi><mo>,</mo><mi>u</mi></mrow></msub><mo>,</mo><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>r</mi><mo>,</mo><mi>u</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>r</mi><mo>,</mo><mi>v</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-118" style="width: 15.241em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.682em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1012.62em, 2.86em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-119"><span class="msubsup" id="MathJax-Span-120"><span style="display: inline-block; position: relative; width: 1.074em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-121" style="font-family: STIXGeneral-Italic;">𝑚</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.717em;"><span class="mi" id="MathJax-Span-122" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑟</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-123" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="mo" id="MathJax-Span-124" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">max</span><span class="mo" id="MathJax-Span-125" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-126"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-127" style="font-family: STIXGeneral-Italic;">𝑃<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-128"><span class="mrow" id="MathJax-Span-129"><span class="mi" id="MathJax-Span-130" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑟</span><span class="mo" id="MathJax-Span-131" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-132" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑢</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-133" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-134" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 2.324em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-135" style="font-family: STIXGeneral-Italic;">𝑃<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-136"><span class="mrow" id="MathJax-Span-137"><span class="mi" id="MathJax-Span-138" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑟</span><span class="mo" id="MathJax-Span-139" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-140" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑢</span><span class="mo" id="MathJax-Span-141" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-142" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-143" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-144" style="font-family: STIXGeneral-Regular; padding-left: 0.182em;">…</span><span class="mo" id="MathJax-Span-145" style="font-family: STIXGeneral-Regular; padding-left: 0.182em;">,</span><span class="msubsup" id="MathJax-Span-146" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-147" style="font-family: STIXGeneral-Italic;">𝑃<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-148"><span class="mrow" id="MathJax-Span-149"><span class="mi" id="MathJax-Span-150" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑟</span><span class="mo" id="MathJax-Span-151" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-152" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑣</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-153" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi><mi>r</mi></msub><mo>=</mo><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi><mo>,</mo><mi>u</mi></mrow></msub><mo>,</mo><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi><mo>,</mo><mi>u</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi><mo>,</mo><mi>v</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-25">m_r = \max (P_{r, u}, P_{r, u + 1}, \dots, P_{r, v})</script> for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo>&amp;#x2208;</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-154" style="width: 4.765em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.932em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1003.81em, 2.801em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-155"><span class="mi" id="MathJax-Span-156" style="font-family: STIXGeneral-Italic;">𝑟</span><span class="mo" id="MathJax-Span-157" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">∈</span><span class="mo" id="MathJax-Span-158" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">{</span><span class="mn" id="MathJax-Span-159" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-160" style="font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-161" style="font-family: STIXGeneral-Regular; padding-left: 0.182em;">2</span><span class="mo" id="MathJax-Span-162" style="font-family: STIXGeneral-Regular;">}</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo>∈</mo><mo fence="false" stretchy="false">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-26">r \in \{ 1, 2\}</script>. If <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>m</mi><mn>1</mn></msub><mo>=</mo><msub><mi>m</mi><mn>2</mn></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-163" style="width: 4.17em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.455em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.848em, 1003.46em, 2.801em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-164"><span class="msubsup" id="MathJax-Span-165"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-166" style="font-family: STIXGeneral-Italic;">𝑚</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.717em;"><span class="mn" id="MathJax-Span-167" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-168" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-169" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-170" style="font-family: STIXGeneral-Italic;">𝑚</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.717em;"><span class="mn" id="MathJax-Span-171" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi><mn>1</mn></msub><mo>=</mo><msub><mi>m</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-27">m_1 = m_2</script>, then the strength is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-172" style="width: 0.717em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.6em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-173"><span class="mn" id="MathJax-Span-174" style="font-family: STIXGeneral-Regular;">0</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-28">0</script>. Otherwise, the strength is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>min</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>m</mi><mn>1</mn></msub><mo>,</mo><msub><mi>m</mi><mn>2</mn></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-175" style="width: 6.074em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.063em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1005em, 2.801em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-176"><span class="mo" id="MathJax-Span-177" style="font-family: STIXGeneral-Regular;">min</span><span class="mo" id="MathJax-Span-178" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-179"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-180" style="font-family: STIXGeneral-Italic;">𝑚</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.717em;"><span class="mn" id="MathJax-Span-181" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-182" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-183" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-184" style="font-family: STIXGeneral-Italic;">𝑚</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.717em;"><span class="mn" id="MathJax-Span-185" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-186" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo movablelimits="true" form="prefix">min</mo><mo stretchy="false">(</mo><msub><mi>m</mi><mn>1</mn></msub><mo>,</mo><msub><mi>m</mi><mn>2</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-29">\min (m_1, m_2)</script>.</p><p>The <span class="tex-font-style-underline">total strength</span> of the deployment is the sum of the strengths for all connected areas. Determine the expected total strength of the deployment on any single day.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line consists of an integer <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-187" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.78em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-188"><span class="mi" id="MathJax-Span-189" style="font-family: STIXGeneral-Italic;">𝑁<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">N</script> (<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn><mo>&amp;#x2264;</mo><mi>N</mi><mo>&amp;#x2264;</mo><mn>100</mn><mspace width=&quot;thinmathspace&quot; /><mn>000</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-190" style="width: 9.11em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.562em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1007.56em, 2.741em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-191"><span class="mn" id="MathJax-Span-192" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-193" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">≤</span><span class="mi" id="MathJax-Span-194" style="font-family: STIXGeneral-Italic; padding-left: 0.301em;">𝑁<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-195" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">≤</span><span class="mn" id="MathJax-Span-196" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">100</span><span class="mspace" id="MathJax-Span-197" style="height: 0em; vertical-align: 0em; width: 0.182em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-198" style="font-family: STIXGeneral-Regular;">000</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>≤</mo><mi>N</mi><mo>≤</mo><mn>100</mn><mspace width="thinmathspace"></mspace><mn>000</mn></math></span></span><script type="math/tex" id="MathJax-Element-31">1 \leq N \leq 100\,000</script>).</p><p>Each of the next two lines consists of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-199" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.78em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-200"><span class="mi" id="MathJax-Span-201" style="font-family: STIXGeneral-Italic;">𝑁<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-32">N</script> integers <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>r</mi><mo>,</mo><mi>c</mi></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-202" style="width: 1.729em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.372em, 1001.43em, 2.622em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-203"><span class="msubsup" id="MathJax-Span-204"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-205" style="font-family: STIXGeneral-Italic;">𝑃<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-206"><span class="mrow" id="MathJax-Span-207"><span class="mi" id="MathJax-Span-208" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑟</span><span class="mo" id="MathJax-Span-209" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-210" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑐</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi><mo>,</mo><mi>c</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-33">P_{r, c}</script> (<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn><mo>&amp;#x2264;</mo><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>r</mi><mo>,</mo><mi>c</mi></mrow></msub><mo>&amp;#x2264;</mo><mn>200</mn><mspace width=&quot;thinmathspace&quot; /><mn>000</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-211" style="width: 10.122em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.396em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1008.4em, 2.86em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-212"><span class="mn" id="MathJax-Span-213" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-214" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">≤</span><span class="msubsup" id="MathJax-Span-215" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-216" style="font-family: STIXGeneral-Italic;">𝑃<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-217"><span class="mrow" id="MathJax-Span-218"><span class="mi" id="MathJax-Span-219" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑟</span><span class="mo" id="MathJax-Span-220" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-221" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑐</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-222" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">≤</span><span class="mn" id="MathJax-Span-223" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">200</span><span class="mspace" id="MathJax-Span-224" style="height: 0em; vertical-align: 0em; width: 0.182em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-225" style="font-family: STIXGeneral-Regular;">000</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>≤</mo><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi><mo>,</mo><mi>c</mi></mrow></msub><mo>≤</mo><mn>200</mn><mspace width="thinmathspace"></mspace><mn>000</mn></math></span></span><script type="math/tex" id="MathJax-Element-34">1 \leq P_{r, c} \leq 200\,000</script>).</p></div><div class="output-specification"><div class="section-title">Output</div><p>Let <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi><mo>=</mo><mn>998</mn><mspace width=&quot;thinmathspace&quot; /><mn>244</mn><mspace width=&quot;thinmathspace&quot; /><mn>353</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-226" style="width: 9.527em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.92em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1007.86em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-227"><span class="mi" id="MathJax-Span-228" style="font-family: STIXGeneral-Italic;">𝑀<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-229" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-230" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">998</span><span class="mspace" id="MathJax-Span-231" style="height: 0em; vertical-align: 0em; width: 0.182em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-232" style="font-family: STIXGeneral-Regular;">244</span><span class="mspace" id="MathJax-Span-233" style="height: 0em; vertical-align: 0em; width: 0.182em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-234" style="font-family: STIXGeneral-Regular;">353</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mo>=</mo><mn>998</mn><mspace width="thinmathspace"></mspace><mn>244</mn><mspace width="thinmathspace"></mspace><mn>353</mn></math></span></span><script type="math/tex" id="MathJax-Element-35">M = 998\,244\,353</script>. It can be shown that the expected total strength can be expressed as an irreducible fraction <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mi>x</mi><mi>y</mi></mfrac></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-235" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1000.78em, 2.86em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-236"><span class="mfrac" id="MathJax-Span-237"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.17em, -999.997em); top: -4.402em; left: 50%; margin-left: -0.176em;"><span class="mi" id="MathJax-Span-238" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.289em, -999.997em); top: -3.628em; left: 50%; margin-left: -0.176em;"><span class="mi" id="MathJax-Span-239" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑦</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.54em, 1.253em, -999.997em); top: -1.307em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.539em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mi>x</mi><mi>y</mi></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-36">\frac{x}{y}</script> such that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-240" style="width: 0.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.848em, 1000.48em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-241"><span class="mi" id="MathJax-Span-242" style="font-family: STIXGeneral-Italic;">𝑥</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-37">x</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-243" style="width: 0.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.848em, 1000.54em, 2.801em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-244"><span class="mi" id="MathJax-Span-245" style="font-family: STIXGeneral-Italic;">𝑦</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-38">y</script> are integers and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>&amp;#x2262;</mo><mn>0</mn><mspace width=&quot;0.444em&quot; /><mo stretchy=&quot;false&quot;>(</mo><mi>mod</mi><mspace width=&quot;0.333em&quot; /><mi>M</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-246" style="width: 8.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.146em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1007.09em, 2.801em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-247"><span class="mi" id="MathJax-Span-248" style="font-family: STIXGeneral-Italic;">𝑦</span><span class="mo" id="MathJax-Span-249" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">≢</span><span class="mn" id="MathJax-Span-250" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">0</span><span class="TeXmathchoice" id="MathJax-Span-251"><span class="mspace" id="MathJax-Span-252" style="height: 0em; vertical-align: 0em; width: 0.479em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-253" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-254" style="font-family: STIXGeneral-Regular;">mod</span><span class="mspace" id="MathJax-Span-255" style="height: 0em; vertical-align: 0em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-256" style="font-family: STIXGeneral-Italic; padding-left: 0.182em;">𝑀<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-257" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>≢</mo><mn>0</mn><mspace width="0.444em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mi>M</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-39">y \not\equiv 0 \pmod{M}</script>. Output an integer <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-258" style="width: 0.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.54em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-259"><span class="mi" id="MathJax-Span-260" style="font-family: STIXGeneral-Italic;">𝑘</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-40">k</script> in a single line such that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn><mo>&amp;#x2264;</mo><mi>k</mi><mo>&amp;lt;</mo><mi>M</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-261" style="width: 5.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.646em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1004.65em, 2.741em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-262"><span class="mn" id="MathJax-Span-263" style="font-family: STIXGeneral-Regular;">0</span><span class="mo" id="MathJax-Span-264" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">≤</span><span class="mi" id="MathJax-Span-265" style="font-family: STIXGeneral-Italic; padding-left: 0.301em;">𝑘</span><span class="mo" id="MathJax-Span-266" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">&lt;</span><span class="mi" id="MathJax-Span-267" style="font-family: STIXGeneral-Italic; padding-left: 0.301em;">𝑀<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mo>≤</mo><mi>k</mi><mo>&lt;</mo><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-41">0 \leq k < M</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>&amp;#x22C5;</mo><mi>y</mi><mo>&amp;#x2261;</mo><mi>x</mi><mspace width=&quot;0.444em&quot; /><mo stretchy=&quot;false&quot;>(</mo><mi>mod</mi><mspace width=&quot;0.333em&quot; /><mi>M</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-268" style="width: 10.182em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.455em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1008.4em, 2.801em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-269"><span class="mi" id="MathJax-Span-270" style="font-family: STIXGeneral-Italic;">𝑘</span><span class="mo" id="MathJax-Span-271" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">⋅</span><span class="mi" id="MathJax-Span-272" style="font-family: STIXGeneral-Italic; padding-left: 0.241em;">𝑦</span><span class="mo" id="MathJax-Span-273" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">≡</span><span class="mi" id="MathJax-Span-274" style="font-family: STIXGeneral-Italic; padding-left: 0.301em;">𝑥</span><span class="TeXmathchoice" id="MathJax-Span-275"><span class="mspace" id="MathJax-Span-276" style="height: 0em; vertical-align: 0em; width: 0.479em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-277" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-278" style="font-family: STIXGeneral-Regular;">mod</span><span class="mspace" id="MathJax-Span-279" style="height: 0em; vertical-align: 0em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-280" style="font-family: STIXGeneral-Italic; padding-left: 0.182em;">𝑀<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-281" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>⋅</mo><mi>y</mi><mo>≡</mo><mi>x</mi><mspace width="0.444em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mi>M</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-42">k \cdot y \equiv x \pmod{M}</script>.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input<div title="Copy" data-clipboard-target="#id004702569058531263" id="id002117551457855702" class="input-output-copier">Copy</div></div><pre id="id004702569058531263">3
8 4 5
5 4 8
</pre></div><div class="output"><div class="title">Output<div title="Copy" data-clipboard-target="#id0041620220470083114" id="id008984666740150875" class="input-output-copier">Copy</div></div><pre id="id0041620220470083114">249561092
</pre></div><div class="input"><div class="title">Input<div title="Copy" data-clipboard-target="#id0008864743739113434" id="id005934920792334482" class="input-output-copier">Copy</div></div><pre id="id0008864743739113434">5
10 20 5 8 5
5 20 7 5 8
</pre></div><div class="output"><div class="title">Output<div title="Copy" data-clipboard-target="#id009249021325242925" id="id004552282167725368" class="input-output-copier">Copy</div></div><pre id="id009249021325242925">811073541
</pre></div></div></div><div class="note"><div class="section-title">Note</div><p><span class="tex-font-style-it">Explanation for the sample input/output #1</span></p><p>There are <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>8</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-282" style="width: 0.717em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.54em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-283"><span class="mn" id="MathJax-Span-284" style="font-family: STIXGeneral-Regular;">8</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>8</mn></math></span></span><script type="math/tex" id="MathJax-Element-43">8</script> possible scenarios for the passageway.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/bcafe780331a6af9153433cce793d92ceecae158.png" style="max-width: 100.0%;max-height: 100.0%;" width="567px"> </center><p>Each scenario is equally likely to happen. Therefore, the expected total strength is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo>+</mo><mn>5</mn><mo>+</mo><mn>10</mn><mo>+</mo><mn>5</mn><mo>+</mo><mn>5</mn><mo>+</mo><mn>0</mn><mo>+</mo><mn>5</mn><mo>+</mo><mn>0</mn><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mn>8</mn><mo>=</mo><mfrac><mn>15</mn><mn>4</mn></mfrac></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-285" style="width: 20.241em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.848em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.372em, 1016.85em, 3.039em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-286"><span class="mo" id="MathJax-Span-287" style="font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-288" style="font-family: STIXGeneral-Regular;">0</span><span class="mo" id="MathJax-Span-289" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">+</span><span class="mn" id="MathJax-Span-290" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">5</span><span class="mo" id="MathJax-Span-291" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">+</span><span class="mn" id="MathJax-Span-292" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">10</span><span class="mo" id="MathJax-Span-293" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">+</span><span class="mn" id="MathJax-Span-294" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">5</span><span class="mo" id="MathJax-Span-295" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">+</span><span class="mn" id="MathJax-Span-296" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">5</span><span class="mo" id="MathJax-Span-297" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">+</span><span class="mn" id="MathJax-Span-298" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">0</span><span class="mo" id="MathJax-Span-299" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">+</span><span class="mn" id="MathJax-Span-300" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">5</span><span class="mo" id="MathJax-Span-301" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">+</span><span class="mn" id="MathJax-Span-302" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">0</span><span class="mo" id="MathJax-Span-303" style="font-family: STIXGeneral-Regular;">)</span><span class="texatom" id="MathJax-Span-304"><span class="mrow" id="MathJax-Span-305"><span class="mo" id="MathJax-Span-306" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mn" id="MathJax-Span-307" style="font-family: STIXGeneral-Regular;">8</span><span class="mo" id="MathJax-Span-308" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="mfrac" id="MathJax-Span-309" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.336em, 1000.66em, 4.17em, -999.997em); top: -4.402em; left: 50%; margin-left: -0.354em;"><span class="mn" id="MathJax-Span-310" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">15</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.17em, -999.997em); top: -3.568em; left: 50%; margin-left: -0.176em;"><span class="mn" id="MathJax-Span-311" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.84em, 1.253em, -999.997em); top: -1.307em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.836em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>0</mn><mo>+</mo><mn>5</mn><mo>+</mo><mn>10</mn><mo>+</mo><mn>5</mn><mo>+</mo><mn>5</mn><mo>+</mo><mn>0</mn><mo>+</mo><mn>5</mn><mo>+</mo><mn>0</mn><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>8</mn><mo>=</mo><mfrac><mn>15</mn><mn>4</mn></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-44">(0 + 5 + 10 + 5 + 5 + 0 + 5 + 0) / 8 = \frac{15}{4}</script>. Since <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>249</mn><mspace width=&quot;thinmathspace&quot; /><mn>561</mn><mspace width=&quot;thinmathspace&quot; /><mn>092</mn><mo>&amp;#x22C5;</mo><mn>4</mn><mo>&amp;#x2261;</mo><mn>15</mn><mspace width=&quot;0.444em&quot; /><mo stretchy=&quot;false&quot;>(</mo><mi>mod</mi><mspace width=&quot;0.333em&quot; /><mn>998</mn><mspace width=&quot;thinmathspace&quot; /><mn>244</mn><mspace width=&quot;thinmathspace&quot; /><mn>353</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-312" style="width: 22.682em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.872em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1018.81em, 2.801em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-313"><span class="mn" id="MathJax-Span-314" style="font-family: STIXGeneral-Regular;">249</span><span class="mspace" id="MathJax-Span-315" style="height: 0em; vertical-align: 0em; width: 0.182em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-316" style="font-family: STIXGeneral-Regular;">561</span><span class="mspace" id="MathJax-Span-317" style="height: 0em; vertical-align: 0em; width: 0.182em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-318" style="font-family: STIXGeneral-Regular;">092</span><span class="mo" id="MathJax-Span-319" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">⋅</span><span class="mn" id="MathJax-Span-320" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">4</span><span class="mo" id="MathJax-Span-321" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">≡</span><span class="mn" id="MathJax-Span-322" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">15</span><span class="TeXmathchoice" id="MathJax-Span-323"><span class="mspace" id="MathJax-Span-324" style="height: 0em; vertical-align: 0em; width: 0.479em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-325" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-326" style="font-family: STIXGeneral-Regular;">mod</span><span class="mspace" id="MathJax-Span-327" style="height: 0em; vertical-align: 0em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-328" style="font-family: STIXGeneral-Regular; padding-left: 0.182em;">998</span><span class="mspace" id="MathJax-Span-329" style="height: 0em; vertical-align: 0em; width: 0.182em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-330" style="font-family: STIXGeneral-Regular;">244</span><span class="mspace" id="MathJax-Span-331" style="height: 0em; vertical-align: 0em; width: 0.182em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-332" style="font-family: STIXGeneral-Regular;">353</span><span class="mo" id="MathJax-Span-333" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>249</mn><mspace width="thinmathspace"></mspace><mn>561</mn><mspace width="thinmathspace"></mspace><mn>092</mn><mo>⋅</mo><mn>4</mn><mo>≡</mo><mn>15</mn><mspace width="0.444em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mn>998</mn><mspace width="thinmathspace"></mspace><mn>244</mn><mspace width="thinmathspace"></mspace><mn>353</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-45">249\,561\,092 \cdot 4 \equiv 15 \pmod{998\,244\,353}</script>, the output of this sample is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>249</mn><mspace width=&quot;thinmathspace&quot; /><mn>561</mn><mspace width=&quot;thinmathspace&quot; /><mn>092</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-334" style="width: 6.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.539em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1005.54em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-335"><span class="mn" id="MathJax-Span-336" style="font-family: STIXGeneral-Regular;">249</span><span class="mspace" id="MathJax-Span-337" style="height: 0em; vertical-align: 0em; width: 0.182em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-338" style="font-family: STIXGeneral-Regular;">561</span><span class="mspace" id="MathJax-Span-339" style="height: 0em; vertical-align: 0em; width: 0.182em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-340" style="font-family: STIXGeneral-Regular;">092</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>249</mn><mspace width="thinmathspace"></mspace><mn>561</mn><mspace width="thinmathspace"></mspace><mn>092</mn></math></span></span><script type="math/tex" id="MathJax-Element-46">249\,561\,092</script>.</p><p><span class="tex-font-style-it">Explanation for the sample input/output #2</span></p><p>The expected total strength is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mn>67</mn><mn>16</mn></mfrac></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-341" style="width: 1.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.074em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1001.07em, 2.801em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-342"><span class="mfrac" id="MathJax-Span-343"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.336em, 1000.66em, 4.17em, -999.997em); top: -4.402em; left: 50%; margin-left: -0.354em;"><span class="mn" id="MathJax-Span-344" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">67</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.66em, 4.17em, -999.997em); top: -3.568em; left: 50%; margin-left: -0.354em;"><span class="mn" id="MathJax-Span-345" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">16</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.84em, 1.253em, -999.997em); top: -1.307em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.836em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>67</mn><mn>16</mn></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-47">\frac{67}{16}</script>.</p></div></div>
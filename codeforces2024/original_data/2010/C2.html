<div class="problem-statement"><div class="header"><div class="title">C2. Message Transmission Error (hard version)</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file input-standard"><div class="property-title">input</div>standard input</div><div class="output-file output-standard"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-bf">This is a more difficult version of the problem. It differs from the easy one only by the constraints.</span></p><p>At the Berland State University, the local network between servers does not always operate without errors. When transmitting two <span class="tex-font-style-bf">identical</span> messages consecutively, an error may occur, resulting in the two messages merging into one. In this merging, the end of the first message coincides with the beginning of the second. Of course, the merging can only occur at identical characters. The length of the merging must be a positive number less than the length of the message text.</p><p>For example, when transmitting two messages "<span class="tex-font-style-tt">abrakadabra</span>" consecutively, it is possible that it will be transmitted with the described type of error, resulting in a message like "<span class="tex-font-style-tt">abrakadabrabrakadabra</span>" or "<span class="tex-font-style-tt">abrakadabrakadabra</span>' (in the first case, the merging occurred at one character, and in the second case, at four).</p><p>Given the received message <span class="tex-span"><i>t</i></span>, determine if it is possible that this is the result of an error of the described type in the operation of the local network, and if so, determine a possible value of <span class="tex-span"><i>s</i></span>.</p><p>A situation where two messages completely overlap each other should not be considered an error. For example, if the received message is "<span class="tex-font-style-tt">abcd</span>", it should be considered that there is no error in it. Similarly, simply appending one message after another is not a sign of an error. For instance, if the received message is "<span class="tex-font-style-tt">abcabc</span>", it should also be considered that there is no error in it.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The input consists of a single non-empty string <span class="tex-span"><i>t</i></span>, consisting of lowercase letters of the Latin alphabet. The length of the string <span class="tex-span"><i>t</i></span> does not exceed <span class="tex-span">4·10<sup class="upper-index">5</sup></span> characters.</p></div><div class="output-specification"><div class="section-title">Output</div><p>If the message <span class="tex-span"><i>t</i></span> cannot contain an error, output "<span class="tex-font-style-tt">NO</span>" (without quotes) in a single line of output.</p><p>Otherwise, in the first line, output "<span class="tex-font-style-tt">YES</span>" (without quotes), and in the next line, output the string <span class="tex-span"><i>s</i></span> — a possible message that could have led to the error. If there are multiple possible answers, any of them is acceptable.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input<div title="Copy" data-clipboard-target="#id005724930176025522" id="id005379870209697808" class="input-output-copier">Copy</div></div><pre id="id005724930176025522">abrakadabrabrakadabra<br></pre></div><div class="output"><div class="title">Output<div title="Copy" data-clipboard-target="#id0009907198064984457" id="id00947095320825289" class="input-output-copier">Copy</div></div><pre id="id0009907198064984457">YES<br>abrakadabra<br></pre></div><div class="input"><div class="title">Input<div title="Copy" data-clipboard-target="#id0011590384995307446" id="id0030370827129932465" class="input-output-copier">Copy</div></div><pre id="id0011590384995307446">acacacaca<br></pre></div><div class="output"><div class="title">Output<div title="Copy" data-clipboard-target="#id006690013386970524" id="id0011210095617330795" class="input-output-copier">Copy</div></div><pre id="id006690013386970524">YES<br>acacaca<br></pre></div><div class="input"><div class="title">Input<div title="Copy" data-clipboard-target="#id0004286762933778121" id="id0027623490290105956" class="input-output-copier">Copy</div></div><pre id="id0004286762933778121">abcabc<br></pre></div><div class="output"><div class="title">Output<div title="Copy" data-clipboard-target="#id006151783248396774" id="id00047554712698693935" class="input-output-copier">Copy</div></div><pre id="id006151783248396774">NO<br></pre></div><div class="input"><div class="title">Input<div title="Copy" data-clipboard-target="#id0020738168259850842" id="id008148025170312794" class="input-output-copier">Copy</div></div><pre id="id0020738168259850842">abababab<br></pre></div><div class="output"><div class="title">Output<div title="Copy" data-clipboard-target="#id003216708562565955" id="id005791064605872682" class="input-output-copier">Copy</div></div><pre id="id003216708562565955">YES<br>ababab<br></pre></div><div class="input"><div class="title">Input<div title="Copy" data-clipboard-target="#id007689658416270959" id="id00007342734133537032" class="input-output-copier">Copy</div></div><pre id="id007689658416270959">tatbt<br></pre></div><div class="output"><div class="title">Output<div title="Copy" data-clipboard-target="#id006458086224303157" id="id005192650707255972" class="input-output-copier">Copy</div></div><pre id="id006458086224303157">NO<br></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the second example, a suitable answer could also be the string "<span class="tex-font-style-tt">acacaca</span>".</p></div></div>
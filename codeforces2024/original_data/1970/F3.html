<div class="problem-statement"><div class="header"><div class="title">F3. Playing Quidditch (Hard)</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file input-standard"><div class="property-title">input</div>standard input</div><div class="output-file output-standard"><div class="property-title">output</div>standard output</div></div><div><p>This afternoon, you decided to enjoy the first days of Spring by taking a walk outside. As you come near the Quidditch field, you hear screams. Once again, there is a conflict about the score: the two teams are convinced that they won the game! To prevent this problem from happening one more time, you decide to get involved in the refereeing of the matches.</p><p>Now, you will stay in the stadium to watch the game and count the score. At the end of the game, you will decide the winner.</p><p>Today, two teams are competing: the red Gryffindor (<span class="tex-font-style-tt">R</span>) and the blue Ravenclaw (<span class="tex-font-style-tt">B</span>) team. Each team is composed of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 0.896em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.72em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: STIXGeneral-Italic;">ğ‘ƒ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">P</script> players (<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn><mo>&amp;#x2264;</mo><mi>P</mi><mo>&amp;#x2264;</mo><mn>10</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4" style="width: 5.896em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.884em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1004.88em, 2.741em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="mn" id="MathJax-Span-6" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-7" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">â‰¤</span><span class="mi" id="MathJax-Span-8" style="font-family: STIXGeneral-Italic; padding-left: 0.301em;">ğ‘ƒ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span class="mo" id="MathJax-Span-9" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">â‰¤</span><span class="mn" id="MathJax-Span-10" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">10</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>â‰¤</mo><mi>P</mi><mo>â‰¤</mo><mn>10</mn></math></span></span><script type="math/tex" id="MathJax-Element-2">1 \leq P \leq 10</script>).</p><p>The field is a rectangle of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-11" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.78em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-12"><span class="mi" id="MathJax-Span-13" style="font-family: STIXGeneral-Italic;">ğ‘<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">N</script> lines and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-14" style="width: 1.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.96em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-15"><span class="mi" id="MathJax-Span-16" style="font-family: STIXGeneral-Italic;">ğ‘€<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">M</script> columns (<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>3</mn><mo>&amp;#x2264;</mo><mi>N</mi><mo>,</mo><mi>M</mi><mo>&amp;#x2264;</mo><mn>99</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-17" style="width: 8.098em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.729em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1006.67em, 2.741em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-18"><span class="mn" id="MathJax-Span-19" style="font-family: STIXGeneral-Regular;">3</span><span class="mo" id="MathJax-Span-20" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">â‰¤</span><span class="mi" id="MathJax-Span-21" style="font-family: STIXGeneral-Italic; padding-left: 0.301em;">ğ‘<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-22" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-23" style="font-family: STIXGeneral-Italic; padding-left: 0.182em;">ğ‘€<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-24" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">â‰¤</span><span class="mn" id="MathJax-Span-25" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">99</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>3</mn><mo>â‰¤</mo><mi>N</mi><mo>,</mo><mi>M</mi><mo>â‰¤</mo><mn>99</mn></math></span></span><script type="math/tex" id="MathJax-Element-5">3 \leq N, M \leq 99</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-26" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.78em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-27"><span class="mi" id="MathJax-Span-28" style="font-family: STIXGeneral-Italic;">ğ‘<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">N</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-29" style="width: 1.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.96em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-30"><span class="mi" id="MathJax-Span-31" style="font-family: STIXGeneral-Italic;">ğ‘€<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">M</script> are odd). All the positions are integers, and several entities are allowed to be at the same position in the field. At the beginning of the game, the field contains goals for the two teams (each team can own between one and five goals), the players, and exactly one Quaffle. In this version of the problem, one Bludger <span class="tex-font-style-bf">and a Golden Snitch</span> can be present.</p><p>A game is composed of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-32" style="width: 0.896em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.72em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-33"><span class="mi" id="MathJax-Span-34" style="font-family: STIXGeneral-Italic;">ğ‘‡<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">T</script> steps (<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn><mo>&amp;#x2264;</mo><mi>T</mi><mo>&amp;#x2264;</mo><mn>10000</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-35" style="width: 8.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.908em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1006.91em, 2.741em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-36"><span class="mn" id="MathJax-Span-37" style="font-family: STIXGeneral-Regular;">0</span><span class="mo" id="MathJax-Span-38" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">â‰¤</span><span class="mi" id="MathJax-Span-39" style="font-family: STIXGeneral-Italic; padding-left: 0.301em;">ğ‘‡<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span class="mo" id="MathJax-Span-40" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">â‰¤</span><span class="mn" id="MathJax-Span-41" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">10000</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mo>â‰¤</mo><mi>T</mi><mo>â‰¤</mo><mn>10000</mn></math></span></span><script type="math/tex" id="MathJax-Element-9">0 \leq T \leq 10000</script>). At each step, one entity on the field (a player or a ball) performs one action. All entities can move. A player can also catch a ball or throw the Quaffle that it is carrying. To catch a ball, a player must be located on the same cell as it. The Quaffle does not perform any action while it is being carried; it only follows the movements of the player. If a player carrying the Quaffle decides to throw it, the Quaffle is simply put at the current position of the player. If a player is on the same cell as a Bludger (either after a movement from the player or the Bludger), the player is eliminated. If the player is eliminated while it is carrying the Quaffle, the Quaffle remains on the cell containing both the player and the Bludger after the move. It is guaranteed that this never occurs while the player is in a cell containing a goal.</p><p>To win a point, a player must leave the Quaffle at a goal of the other team. When it does, the team of the player wins one point, and the Quaffle instantly moves to the middle of the field (the cell at the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>M</mi><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mn>2</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-42" style="width: 5.003em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.17em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1004.17em, 2.801em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-43"><span class="mo" id="MathJax-Span-44" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-45" style="font-family: STIXGeneral-Italic;">ğ‘€<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-46" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">+</span><span class="mn" id="MathJax-Span-47" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">1</span><span class="mo" id="MathJax-Span-48" style="font-family: STIXGeneral-Regular;">)</span><span class="texatom" id="MathJax-Span-49"><span class="mrow" id="MathJax-Span-50"><span class="mo" id="MathJax-Span-51" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mn" id="MathJax-Span-52" style="font-family: STIXGeneral-Regular;">2</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>M</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-10">(M+1)/2</script>-th column of the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>N</mi><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mn>2</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-53" style="width: 4.884em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.051em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1004.05em, 2.801em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-54"><span class="mo" id="MathJax-Span-55" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-56" style="font-family: STIXGeneral-Italic;">ğ‘<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-57" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">+</span><span class="mn" id="MathJax-Span-58" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">1</span><span class="mo" id="MathJax-Span-59" style="font-family: STIXGeneral-Regular;">)</span><span class="texatom" id="MathJax-Span-60"><span class="mrow" id="MathJax-Span-61"><span class="mo" id="MathJax-Span-62" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mn" id="MathJax-Span-63" style="font-family: STIXGeneral-Regular;">2</span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>N</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-11">(N+1)/2</script>-th line of the field, starting from 1). There is no goal in the middle of the field. If a player puts the ball in its own goal, the other team wins the point. <span class="tex-font-style-bf">If a player catches the Golden Snitch, their team wins 10 points and the game is over.</span></p></div><div class="input-specification"><div class="section-title">Input</div><p>On the first line, the integers <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-64" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.78em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-65"><span class="mi" id="MathJax-Span-66" style="font-family: STIXGeneral-Italic;">ğ‘<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">N</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-67" style="width: 1.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.96em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-68"><span class="mi" id="MathJax-Span-69" style="font-family: STIXGeneral-Italic;">ğ‘€<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">M</script>.</p><p>The description of the field follows: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-70" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.78em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-71"><span class="mi" id="MathJax-Span-72" style="font-family: STIXGeneral-Italic;">ğ‘<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">N</script> lines of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-73" style="width: 1.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.96em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-74"><span class="mi" id="MathJax-Span-75" style="font-family: STIXGeneral-Italic;">ğ‘€<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">M</script> pairs of characters separated by spaces. Each pair of characters represents a position on the field. It can be either: </p><ul> <li> <span class="tex-font-style-tt">..</span> to represent an empty cell </li><li> <span class="tex-font-style-tt">R0</span>, ..., <span class="tex-font-style-tt">R9</span>, <span class="tex-font-style-tt">B0</span>, ..., <span class="tex-font-style-tt">B9</span> to represent a player. The first character is the team of the player, and the second is the number of the player in the team. Each pair of characters is unique, but it is not guaranteed that all the pairs appear in the grid. </li><li> <span class="tex-font-style-tt">RG</span> or <span class="tex-font-style-tt">BG</span> to represent a goal. The blue team tries to put the ball in a red goal (<span class="tex-font-style-tt">RG</span>) while the red team tries to put the ball in a blue goal (<span class="tex-font-style-tt">BG</span>). </li><li> <span class="tex-font-style-tt">.Q</span> to represent the Quaffle, which is the ball that the players use to score goals. </li><li> <span class="tex-font-style-tt">.B</span> to represent the Bludger. </li><li> <span class="tex-font-style-bf"><span class="tex-font-style-tt">.S</span> to represent the Golden Snitch.</span> </li></ul><p>The next line contains <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-76" style="width: 0.896em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.72em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-77"><span class="mi" id="MathJax-Span-78" style="font-family: STIXGeneral-Italic;">ğ‘‡<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">T</script>, the number of steps that compose the game. <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-79" style="width: 0.896em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.72em, 2.622em, -999.997em); top: -2.438em; left: 0em;"><span class="mrow" id="MathJax-Span-80"><span class="mi" id="MathJax-Span-81" style="font-family: STIXGeneral-Italic;">ğ‘‡<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.443em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-17">T</script> lines follow, each describing one action. It contains several pieces of information separated by a space. First, a pair of characters representing the entity that must perform the action. Second, the description of the action: </p><ul> <li> <span class="tex-font-style-tt">U</span>, <span class="tex-font-style-tt">D</span>, <span class="tex-font-style-tt">L</span>, <span class="tex-font-style-tt">R</span> indicate that the entity moves on the grid. It can move to the top of the grid (<span class="tex-font-style-tt">U</span>), to the bottom (<span class="tex-font-style-tt">D</span>), to the left (<span class="tex-font-style-tt">L</span>), or to the right (<span class="tex-font-style-tt">R</span>). Each entity moves by only one cell at a time. </li><li> <span class="tex-font-style-tt">C</span> indicates that the player catches the ball (only a player can catch a ball). Then, there is a space followed by a pair of characters: the description of the ball caught by the player. This information is needed since several balls can be in the same cell. </li><li> <span class="tex-font-style-tt">T</span> indicates that the player throws the Quaffle that it is carrying. </li></ul><p>All the actions performed by the entities are guaranteed to be valid: the players stay in the field, don't catch a ball if they are not in the same cell, don't release the Quaffle if they are not carrying it, ...</p></div><div class="output-specification"><div class="section-title">Output</div><p>You must output the description of the main events of the game, one event per line. More precisely:</p><ul> <li> Each time a team scores, you must print <span class="tex-font-style-tt">t RED GOAL</span> or <span class="tex-font-style-tt">t BLUE GOAL</span>, depending on the team who scored, where <span class="tex-font-style-tt">t</span> is the current time (the position of the action in the list of actions, starting from 0). In the case where a player scores in the wrong goal (a red player scores in the red goal, or a blue player scores in the blue goal), you must print the name of the team who wins one point, that is, the other team. </li><li> Each time a player is eliminated, you must print <span class="tex-font-style-tt">t p ELIMINATED</span>, where <span class="tex-font-style-tt">t</span> is the current time and <span class="tex-font-style-tt">p</span> is the player who is eliminated. The format to print the player is the same as in the input. </li><li> <span class="tex-font-style-bf">If the Golden Snitch is caught, you must print <span class="tex-font-style-tt">t RED CATCH GOLDEN SNITCH</span> or <span class="tex-font-style-tt">t BLUE CATCH GOLDEN SNITCH</span>, depending on the team who caught the Golden Snitch, where <span class="tex-font-style-tt">t</span> is the current time.</span> </li></ul><p>The events must be printed in ascending order of <span class="tex-font-style-tt">t</span>. If several players are eliminated at the same time, the events must be written is alphabetical order: <span class="tex-font-style-tt">B0</span>, ..., <span class="tex-font-style-tt">B9</span>, <span class="tex-font-style-tt">R0</span>, ... <span class="tex-font-style-tt">R9</span>.</p><p>At the end of the game, you must print the final score as: <span class="tex-font-style-tt">FINAL SCORE: r b</span>, where <span class="tex-font-style-tt">r</span> is the score of the red team and <span class="tex-font-style-tt">b</span> is the score of the blue team.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input<div title="Copy" data-clipboard-target="#id005648173774212899" id="id0004264664046812894" class="input-output-copier">Copy</div></div><pre id="id005648173774212899"><div class="test-example-line test-example-line-even test-example-line-0">3 5</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. R0 .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">RG .. .Q .. BG</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. B0 .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">12</div><div class="test-example-line test-example-line-even test-example-line-0">R0 D</div><div class="test-example-line test-example-line-even test-example-line-0">R0 C .Q</div><div class="test-example-line test-example-line-even test-example-line-0">R0 R</div><div class="test-example-line test-example-line-even test-example-line-0">R0 T</div><div class="test-example-line test-example-line-even test-example-line-0">R0 D</div><div class="test-example-line test-example-line-even test-example-line-0">B0 R</div><div class="test-example-line test-example-line-even test-example-line-0">B0 U</div><div class="test-example-line test-example-line-even test-example-line-0">B0 C .Q</div><div class="test-example-line test-example-line-even test-example-line-0">B0 L</div><div class="test-example-line test-example-line-even test-example-line-0">B0 L</div><div class="test-example-line test-example-line-even test-example-line-0">B0 L</div><div class="test-example-line test-example-line-even test-example-line-0">B0 T</div></pre></div><div class="output"><div class="title">Output<div title="Copy" data-clipboard-target="#id008185408469118258" id="id0042463466144853323" class="input-output-copier">Copy</div></div><pre id="id008185408469118258">11 BLUE GOAL
FINAL SCORE: 0 1
</pre></div><div class="input"><div class="title">Input<div title="Copy" data-clipboard-target="#id003415681022713717" id="id005972884460973236" class="input-output-copier">Copy</div></div><pre id="id003415681022713717"><div class="test-example-line test-example-line-even test-example-line-0">3 5</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. R0 .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">RG .. .Q .. BG</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. B0 .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">5</div><div class="test-example-line test-example-line-even test-example-line-0">R0 D</div><div class="test-example-line test-example-line-even test-example-line-0">R0 C .Q</div><div class="test-example-line test-example-line-even test-example-line-0">R0 L</div><div class="test-example-line test-example-line-even test-example-line-0">R0 L</div><div class="test-example-line test-example-line-even test-example-line-0">R0 T</div></pre></div><div class="output"><div class="title">Output<div title="Copy" data-clipboard-target="#id0050487343159672" id="id006734372031622404" class="input-output-copier">Copy</div></div><pre id="id0050487343159672">4 BLUE GOAL
FINAL SCORE: 0 1
</pre></div><div class="input"><div class="title">Input<div title="Copy" data-clipboard-target="#id004838723347167775" id="id004356549644109111" class="input-output-copier">Copy</div></div><pre id="id004838723347167775"><div class="test-example-line test-example-line-even test-example-line-0">5 5</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. .. .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. .. .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">RG R0 .Q B0 BG</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. .. .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. .B .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">5</div><div class="test-example-line test-example-line-even test-example-line-0">.B L</div><div class="test-example-line test-example-line-even test-example-line-0">.B U</div><div class="test-example-line test-example-line-even test-example-line-0">.B U</div><div class="test-example-line test-example-line-even test-example-line-0">B0 L</div><div class="test-example-line test-example-line-even test-example-line-0">B0 L</div></pre></div><div class="output"><div class="title">Output<div title="Copy" data-clipboard-target="#id00692676740253451" id="id002275818458710197" class="input-output-copier">Copy</div></div><pre id="id00692676740253451">2 R0 ELIMINATED
4 B0 ELIMINATED
FINAL SCORE: 0 0
</pre></div><div class="input"><div class="title">Input<div title="Copy" data-clipboard-target="#id004616082893812672" id="id0043930700240788934" class="input-output-copier">Copy</div></div><pre id="id004616082893812672"><div class="test-example-line test-example-line-even test-example-line-0">5 5</div><div class="test-example-line test-example-line-even test-example-line-0">.. R0 .S B0 ..</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. .. .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">RG .. .Q .. BG</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. .. .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">.. R1 .B B1 ..</div><div class="test-example-line test-example-line-even test-example-line-0">4</div><div class="test-example-line test-example-line-even test-example-line-0">.S D</div><div class="test-example-line test-example-line-even test-example-line-0">R0 D</div><div class="test-example-line test-example-line-even test-example-line-0">R0 R</div><div class="test-example-line test-example-line-even test-example-line-0">R0 C .S</div></pre></div><div class="output"><div class="title">Output<div title="Copy" data-clipboard-target="#id007674021432938871" id="id0004348966438626212" class="input-output-copier">Copy</div></div><pre id="id007674021432938871">3 RED CATCH GOLDEN SNITCH
FINAL SCORE: 10 0
</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first example, the red player takes the Quaffle, move it and throw it. The blue player catches the ball, goes to the red goal and scores.</p><p>In the second example, the red player takes the ball and scores in the goal of their own team: the blue team wins a point.</p><p>In the third example, the Bludger goes at the position of R0: R0 is eliminated. Then, B0 moves to the position of the Bludger: B0 is eliminated too.</p><p>In the fourth example, a red player catches the Golden Snitch. Their team wins 10 points, and the game ends.</p><p><span class="tex-font-style-it">You can find one more example in the easy version of the problem</span></p></div></div>